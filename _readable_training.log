Seed set to 42
Dataset path does not exist: ./competition_support_set/{competition_train,k562_gwps,rpe1,jurkat,k562,hepg2}.h5
./competition_support_set/{competition_train,k562_gwps,rpe1,jurkat,k562,hepg2}.h5
Processing replogle_h1:   0%|          | 0/6 [00:00<?, ?it/s]                                                             Processing replogle_h1:   0%|          | 0/6 [00:00<?, ?it/s]Processing replogle_h1:  17%|█▋        | 1/6 [00:00<00:00,  6.48it/s]No cell barcode information found in competition_support_set/k562_gwps.h5. Generating generic barcodes.
                                                                     Processing replogle_h1:  17%|█▋        | 1/6 [00:00<00:00,  6.48it/s]No cell barcode information found in competition_support_set/rpe1.h5. Generating generic barcodes.
                                                                     Processing replogle_h1:  17%|█▋        | 1/6 [00:00<00:00,  6.48it/s]No cell barcode information found in competition_support_set/jurkat.h5. Generating generic barcodes.
                                                                     Processing replogle_h1:  17%|█▋        | 1/6 [00:00<00:00,  6.48it/s]No cell barcode information found in competition_support_set/k562.h5. Generating generic barcodes.
                                                                     Processing replogle_h1:  17%|█▋        | 1/6 [00:00<00:00,  6.48it/s]No cell barcode information found in competition_support_set/hepg2.h5. Generating generic barcodes.
                                                                     Processing replogle_h1:  17%|█▋        | 1/6 [00:00<00:00,  6.48it/s]Processing replogle_h1: 100%|██████████| 6/6 [00:00<00:00, 23.73it/s]
wandb: Currently logged in as: daniel-mario-buchberger (kreid) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.21.1
wandb: Run data is saved locally in ./wandb/run-20250816_184305-wwsta9z4
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run sm_trainer_test
wandb: ⭐️ View project at https://wandb.ai/daniel-mario-buchberger-berufsschule-f-r-elektro-veranst/state
wandb: 🚀 View run at https://wandb.ai/daniel-mario-buchberger-berufsschule-f-r-elektro-veranst/state/runs/wwsta9z4
INFO:state._cli._tx._train:Cell-eval Callback added
INFO:state._cli._tx._train:Loggers and callbacks set up.
GPU available: False, used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
INFO:state._cli._tx._train:Starting trainer fit.

  | Name                 | Type                    | Params | Mode 
-------------------------------------------------------------------------
0 | loss_fn              | SamplesLoss             | 0      | train
1 | pert_encoder         | Sequential              | 4.8 M  | train
2 | basal_encoder        | Linear                  | 12.2 M | train
3 | transformer_backbone | LlamaBidirectionalModel | 50.4 M | train
4 | project_out          | Sequential              | 13.5 M | train
5 | final_down_then_up   | Sequential              | 81.7 M | train
6 | relu                 | ReLU                    | 0      | train
-------------------------------------------------------------------------
141 M     Trainable params
21.5 M    Non-trainable params
162 M     Total params
650.506   Total estimated model params size (MB)
86        Modules in train mode
0         Modules in eval mode
wandb: WARNING Serializing object of type list that is 153752 bytes
wandb: WARNING Serializing object of type list that is 153752 bytes
Processed competition_train: 221273 train, 0 val, 0 test
Processed k562_gwps: 111605 train, 0 val, 0 test
Processed rpe1: 22317 train, 0 val, 0 test
Processed jurkat: 21412 train, 0 val, 0 test
Processed k562: 18465 train, 0 val, 0 test
Processed hepg2: 0 train, 0 val, 9386 test
num_workers: 1
batch size: None
StateTransitionPerturbationModel(
  (loss_fn): SamplesLoss()
  (pert_encoder): Sequential(
    (0): Linear(in_features=5120, out_features=672, bias=True)
    (1): GELU(approximate='none')
    (2): Dropout(p=0.1, inplace=False)
    (3): Linear(in_features=672, out_features=672, bias=True)
    (4): GELU(approximate='none')
    (5): Dropout(p=0.1, inplace=False)
    (6): Linear(in_features=672, out_features=672, bias=True)
    (7): GELU(approximate='none')
    (8): Dropout(p=0.1, inplace=False)
    (9): Linear(in_features=672, out_features=672, bias=True)
  )
  (basal_encoder): Linear(in_features=18080, out_features=672, bias=True)
  (transformer_backbone): LlamaBidirectionalModel(
    (embed_tokens): Embedding(32000, 672, padding_idx=0)
    (layers): ModuleList(
      (0-3): 4 x LlamaDecoderLayer(
        (self_attn): LlamaAttention(
          (q_proj): Linear(in_features=672, out_features=672, bias=False)
          (k_proj): Linear(in_features=672, out_features=672, bias=False)
          (v_proj): Linear(in_features=672, out_features=672, bias=False)
          (o_proj): Linear(in_features=672, out_features=672, bias=False)
        )
        (mlp): LlamaMLP(
          (gate_proj): Linear(in_features=672, out_features=2688, bias=False)
          (up_proj): Linear(in_features=672, out_features=2688, bias=False)
          (down_proj): Linear(in_features=2688, out_features=672, bias=False)
          (act_fn): SiLU()
        )
        (input_layernorm): LlamaRMSNorm((672,), eps=1e-06)
        (post_attention_layernorm): LlamaRMSNorm((672,), eps=1e-06)
      )
    )
    (norm): LlamaRMSNorm((672,), eps=1e-06)
    (rotary_emb): NoRoPE()
  )
  (project_out): Sequential(
    (0): Linear(in_features=672, out_features=672, bias=True)
    (1): GELU(approximate='none')
    (2): Dropout(p=0.1, inplace=False)
    (3): Linear(in_features=672, out_features=672, bias=True)
    (4): GELU(approximate='none')
    (5): Dropout(p=0.1, inplace=False)
    (6): Linear(in_features=672, out_features=672, bias=True)
    (7): GELU(approximate='none')
    (8): Dropout(p=0.1, inplace=False)
    (9): Linear(in_features=672, out_features=18080, bias=True)
  )
  (final_down_then_up): Sequential(
    (0): Linear(in_features=18080, out_features=2260, bias=True)
    (1): GELU(approximate='none')
    (2): Linear(in_features=2260, out_features=18080, bias=True)
  )
  (relu): ReLU()
)
Model created. Estimated params size: 0.61 GB
Building trainer with kwargs: {'accelerator': 'cpu', 'devices': 1, 'max_steps': 52, 'check_val_every_n_epoch': None, 'val_check_interval': 100, 'logger': [<state.tx.utils.RobustCSVLogger object at 0x79249f425f50>, <lightning.pytorch.loggers.wandb.WandbLogger object at 0x79249f0a3550>], 'plugins': [], 'callbacks': [<lightning.pytorch.callbacks.model_checkpoint.ModelCheckpoint object at 0x792498642fd0>, <lightning.pytorch.callbacks.model_checkpoint.ModelCheckpoint object at 0x79249f756910>, <state.tx.callbacks.cell_eval_callback.CellEvalCallback object at 0x792498849350>], 'gradient_clip_val': 10}
Trainer built successfully
Model device: cpu
CUDA memory allocated: 0.00 GB
CUDA memory reserved: 0.00 GB
About to call trainer.fit() with checkpoint_path=None
Sanity Checking: |          | 0/? [00:00<?, ?it/s]INFO:cell_load.data_modules.samplers:Creating perturbation batch sampler with metadata caching (using codes)...
INFO:cell_load.data_modules.samplers:Total # cells 9386. Cell set size mean / std before resampling: 78.22 / 47.32.
INFO:cell_load.data_modules.samplers:Creating meta-batches with cell_sentence_len=128...
INFO:cell_load.data_modules.samplers:Of all batches, 51 were full and 69 were partial.
INFO:cell_load.data_modules.samplers:Sampler created with 8 batches in 0.01 seconds.
INFO:cell_load.data_modules.samplers:Of all batches, 51 were full and 69 were partial.
Sanity Checking:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0:  50%|█████     | 1/2 [00:02<00:02,  0.47it/s]Sanity Checking DataLoader 0: 100%|██████████| 2/2 [00:04<00:00,  0.42it/s]                                                                           INFO:cell_load.data_modules.samplers:Creating perturbation batch sampler with metadata caching (using codes)...
INFO:cell_load.data_modules.samplers:Total # cells 395072. Cell set size mean / std before resampling: 117.72 / 27.93.
INFO:cell_load.data_modules.samplers:Creating meta-batches with cell_sentence_len=128...
INFO:cell_load.data_modules.samplers:Of all batches, 2831 were full and 525 were partial.
INFO:cell_load.data_modules.samplers:Sampler created with 210 batches in 0.37 seconds.
INFO:cell_load.data_modules.samplers:Of all batches, 2831 were full and 525 were partial.
Training: |          | 0/? [00:00<?, ?it/s]Training:   0%|          | 0/52 [00:00<?, ?it/s]Epoch 0:   0%|          | 0/52 [00:00<?, ?it/s] INFO:state.tx.callbacks.cell_eval_callback:Running dynamic evaluation at step 1
INFO:state._cli._tx._predict:Loaded config from competition/sm_trainer_test/config.yaml
INFO:cell_load.data_modules.perturbation_dataloader:Loaded data module configuration from competition/sm_trainer_test/data_module.torch
WARNING:cell_load.config:Dataset path does not exist: ./competition_support_set/{competition_train,k562_gwps,rpe1,jurkat,k562,hepg2}.h5
INFO:cell_load.config:Configuration validation passed
INFO:cell_load.data_modules.perturbation_dataloader:Initializing DataModule: batch_size=16, workers=1, random_seed=42
INFO:cell_load.data_modules.perturbation_dataloader:Set 2 missing perturbations to zero vectors.
INFO:cell_load.data_modules.perturbation_dataloader:Loaded custom perturbation featurizations for 19792 perturbations.
INFO:cell_load.data_modules.perturbation_dataloader:Processing dataset replogle_h1:
INFO:cell_load.data_modules.perturbation_dataloader:  - Training dataset: True
INFO:cell_load.data_modules.perturbation_dataloader:  - Zeroshot cell types: ['hepg2']
INFO:cell_load.data_modules.perturbation_dataloader:  - Fewshot cell types: []
./competition_support_set/{competition_train,k562_gwps,rpe1,jurkat,k562,hepg2}.h5

Processing replogle_h1:   0%|          | 0/6 [00:00<?, ?it/s][A                                               
                                                             [AProcessed competition_train: 221273 train, 0 val, 0 test
Epoch 0:   0%|          | 0/52 [00:20<?, ?it/s]
Processing replogle_h1:   0%|          | 0/6 [00:00<?, ?it/s][A
Processing replogle_h1:  17%|█▋        | 1/6 [00:00<00:00,  5.91it/s][AWARNING:cell_load.dataset._perturbation:No cell barcode information found in competition_support_set/k562_gwps.h5. Generating generic barcodes.
                                               
                                                                     [AProcessed k562_gwps: 111605 train, 0 val, 0 test
Epoch 0:   0%|          | 0/52 [00:20<?, ?it/s]
Processing replogle_h1:  17%|█▋        | 1/6 [00:00<00:00,  5.91it/s][AWARNING:cell_load.dataset._perturbation:No cell barcode information found in competition_support_set/rpe1.h5. Generating generic barcodes.
                                               
                                                                     [AProcessed rpe1: 22317 train, 0 val, 0 test
Epoch 0:   0%|          | 0/52 [00:20<?, ?it/s]
Processing replogle_h1:  17%|█▋        | 1/6 [00:00<00:00,  5.91it/s][AWARNING:cell_load.dataset._perturbation:No cell barcode information found in competition_support_set/jurkat.h5. Generating generic barcodes.
                                               
                                                                     [AProcessed jurkat: 21412 train, 0 val, 0 test
Epoch 0:   0%|          | 0/52 [00:20<?, ?it/s]
Processing replogle_h1:  17%|█▋        | 1/6 [00:00<00:00,  5.91it/s][AWARNING:cell_load.dataset._perturbation:No cell barcode information found in competition_support_set/k562.h5. Generating generic barcodes.
                                               
                                                                     [AProcessed k562: 18465 train, 0 val, 0 test
Epoch 0:   0%|          | 0/52 [00:20<?, ?it/s]
Processing replogle_h1:  17%|█▋        | 1/6 [00:00<00:00,  5.91it/s][AWARNING:cell_load.dataset._perturbation:No cell barcode information found in competition_support_set/hepg2.h5. Generating generic barcodes.
                                               
                                                                     [AProcessed hepg2: 0 train, 0 val, 9386 test
Epoch 0:   0%|          | 0/52 [00:20<?, ?it/s]
Processing replogle_h1:  17%|█▋        | 1/6 [00:00<00:00,  5.91it/s][AProcessing replogle_h1: 100%|██████████| 6/6 [00:00<00:00, 23.16it/s]
INFO:cell_load.data_modules.perturbation_dataloader:

INFO:cell_load.data_modules.perturbation_dataloader:Done! Train / Val / Test splits: 5 / 0 / 1
INFO:state._cli._tx._predict:Loaded data module from competition/sm_trainer_test/data_module.torch
Seed set to 42
INFO:state._cli._tx._predict:Loading model from competition/sm_trainer_test/checkpoints/temp_eval_checkpoint.ckpt
INFO:state._cli._tx._predict:Model loaded successfully.
INFO:cell_load.data_modules.samplers:Creating perturbation batch sampler with metadata caching (using codes)...
INFO:cell_load.data_modules.samplers:Total # cells 9386. Cell set size mean / std before resampling: 78.22 / 47.32.
INFO:cell_load.data_modules.samplers:Creating meta-batches with cell_sentence_len=128...
INFO:cell_load.data_modules.samplers:Of all batches, 120 were full and 0 were partial.
INFO:cell_load.data_modules.samplers:Sampler created with 120 batches in 0.01 seconds.
INFO:state._cli._tx._predict:Generating predictions on test set using manual loop...
StateTransitionPerturbationModel(
  (loss_fn): SamplesLoss()
  (pert_encoder): Sequential(
    (0): Linear(in_features=5120, out_features=672, bias=True)
    (1): GELU(approximate='none')
    (2): Dropout(p=0.1, inplace=False)
    (3): Linear(in_features=672, out_features=672, bias=True)
    (4): GELU(approximate='none')
    (5): Dropout(p=0.1, inplace=False)
    (6): Linear(in_features=672, out_features=672, bias=True)
    (7): GELU(approximate='none')
    (8): Dropout(p=0.1, inplace=False)
    (9): Linear(in_features=672, out_features=672, bias=True)
  )
  (basal_encoder): Linear(in_features=18080, out_features=672, bias=True)
  (transformer_backbone): LlamaBidirectionalModel(
    (embed_tokens): Embedding(32000, 672, padding_idx=0)
    (layers): ModuleList(
      (0-3): 4 x LlamaDecoderLayer(
        (self_attn): LlamaAttention(
          (q_proj): Linear(in_features=672, out_features=672, bias=False)
          (k_proj): Linear(in_features=672, out_features=672, bias=False)
          (v_proj): Linear(in_features=672, out_features=672, bias=False)
          (o_proj): Linear(in_features=672, out_features=672, bias=False)
        )
        (mlp): LlamaMLP(
          (gate_proj): Linear(in_features=672, out_features=2688, bias=False)
          (up_proj): Linear(in_features=672, out_features=2688, bias=False)
          (down_proj): Linear(in_features=2688, out_features=672, bias=False)
          (act_fn): SiLU()
        )
        (input_layernorm): LlamaRMSNorm((672,), eps=1e-06)
        (post_attention_layernorm): LlamaRMSNorm((672,), eps=1e-06)
      )
    )
    (norm): LlamaRMSNorm((672,), eps=1e-06)
    (rotary_emb): NoRoPE()
  )
  (project_out): Sequential(
    (0): Linear(in_features=672, out_features=672, bias=True)
    (1): GELU(approximate='none')
    (2): Dropout(p=0.1, inplace=False)
    (3): Linear(in_features=672, out_features=672, bias=True)
    (4): GELU(approximate='none')
    (5): Dropout(p=0.1, inplace=False)
    (6): Linear(in_features=672, out_features=672, bias=True)
    (7): GELU(approximate='none')
    (8): Dropout(p=0.1, inplace=False)
    (9): Linear(in_features=672, out_features=18080, bias=True)
  )
  (final_down_then_up): Sequential(
    (0): Linear(in_features=18080, out_features=2260, bias=True)
    (1): GELU(approximate='none')
    (2): Linear(in_features=2260, out_features=18080, bias=True)
  )
  (relu): ReLU()
)

Predicting:   0%|          | 0/120 [00:00<?, ?batch/s][AINFO:cell_load.data_modules.samplers:Of all batches, 120 were full and 0 were partial.

Predicting:   1%|          | 1/120 [00:00<01:53,  1.04batch/s][A
Predicting:   2%|▏         | 2/120 [00:01<00:54,  2.15batch/s][A
Predicting:   3%|▎         | 4/120 [00:01<00:36,  3.15batch/s][A
Predicting:   4%|▍         | 5/120 [00:02<00:43,  2.64batch/s][A
Predicting:   5%|▌         | 6/120 [00:02<00:33,  3.38batch/s][A
Predicting:   6%|▌         | 7/120 [00:02<00:45,  2.49batch/s][A
Predicting:   8%|▊         | 9/120 [00:03<00:32,  3.47batch/s][A
Predicting:   8%|▊         | 10/120 [00:03<00:27,  4.01batch/s][A
Predicting:   9%|▉         | 11/120 [00:03<00:29,  3.70batch/s][A
Predicting:  10%|█         | 12/120 [00:03<00:31,  3.46batch/s][A
Predicting:  11%|█         | 13/120 [00:04<00:32,  3.32batch/s][A
Predicting:  12%|█▏        | 14/120 [00:04<00:33,  3.21batch/s][A
Predicting:  12%|█▎        | 15/120 [00:04<00:28,  3.65batch/s][A
Predicting:  13%|█▎        | 16/120 [00:05<00:29,  3.49batch/s][A
Predicting:  14%|█▍        | 17/120 [00:05<00:28,  3.63batch/s][A
Predicting:  15%|█▌        | 18/120 [00:05<00:29,  3.49batch/s][A
Predicting:  16%|█▌        | 19/120 [00:05<00:30,  3.35batch/s][A
Predicting:  17%|█▋        | 20/120 [00:06<00:30,  3.23batch/s][A
Predicting:  18%|█▊        | 21/120 [00:06<00:26,  3.68batch/s][A
Predicting:  18%|█▊        | 22/120 [00:06<00:28,  3.49batch/s][A
Predicting:  20%|██        | 24/120 [00:07<00:19,  4.83batch/s][A
Predicting:  22%|██▏       | 26/120 [00:07<00:15,  6.00batch/s][A
Predicting:  22%|██▎       | 27/120 [00:07<00:14,  6.32batch/s][A
Predicting:  23%|██▎       | 28/120 [00:07<00:15,  5.77batch/s][A
Predicting:  24%|██▍       | 29/120 [00:07<00:18,  4.87batch/s][A
Predicting:  25%|██▌       | 30/120 [00:08<00:16,  5.38batch/s][A
Predicting:  26%|██▌       | 31/120 [00:08<00:17,  4.95batch/s][A
Predicting:  28%|██▊       | 33/120 [00:08<00:17,  5.05batch/s][A
Predicting:  28%|██▊       | 34/120 [00:08<00:16,  5.33batch/s][A
Predicting:  29%|██▉       | 35/120 [00:09<00:18,  4.55batch/s][A
Predicting:  30%|███       | 36/120 [00:09<00:20,  4.12batch/s][A
Predicting:  31%|███       | 37/120 [00:09<00:20,  3.97batch/s][A
Predicting:  32%|███▏      | 38/120 [00:10<00:26,  3.08batch/s][A
Predicting:  32%|███▎      | 39/120 [00:10<00:21,  3.75batch/s][A
Predicting:  33%|███▎      | 40/120 [00:10<00:18,  4.44batch/s][A
Predicting:  34%|███▍      | 41/120 [00:10<00:19,  3.97batch/s][A
Predicting:  35%|███▌      | 42/120 [00:11<00:21,  3.65batch/s][A
Predicting:  36%|███▌      | 43/120 [00:11<00:19,  3.93batch/s][A
Predicting:  37%|███▋      | 44/120 [00:11<00:20,  3.72batch/s][A
Predicting:  38%|███▊      | 45/120 [00:11<00:21,  3.56batch/s][A
Predicting:  38%|███▊      | 46/120 [00:12<00:17,  4.21batch/s][A
Predicting:  40%|████      | 48/120 [00:12<00:12,  5.92batch/s][A
Predicting:  41%|████      | 49/120 [00:12<00:11,  6.02batch/s][A
Predicting:  42%|████▏     | 50/120 [00:12<00:11,  6.34batch/s][A
Predicting:  42%|████▎     | 51/120 [00:12<00:10,  6.69batch/s][A
Predicting:  43%|████▎     | 52/120 [00:12<00:13,  5.19batch/s][A
Predicting:  44%|████▍     | 53/120 [00:13<00:12,  5.20batch/s][A
Predicting:  45%|████▌     | 54/120 [00:13<00:15,  4.38batch/s][A
Predicting:  46%|████▌     | 55/120 [00:13<00:13,  4.65batch/s][A
Predicting:  47%|████▋     | 56/120 [00:13<00:15,  4.13batch/s][A
Predicting:  48%|████▊     | 57/120 [00:14<00:16,  3.81batch/s][A
Predicting:  48%|████▊     | 58/120 [00:14<00:17,  3.63batch/s][A
Predicting:  49%|████▉     | 59/120 [00:14<00:14,  4.26batch/s][A
Predicting:  50%|█████     | 60/120 [00:14<00:12,  4.79batch/s][A
Predicting:  51%|█████     | 61/120 [00:15<00:10,  5.41batch/s][A
Predicting:  52%|█████▏    | 62/120 [00:15<00:12,  4.56batch/s][A
Predicting:  52%|█████▎    | 63/120 [00:15<00:10,  5.26batch/s][A
Predicting:  53%|█████▎    | 64/120 [00:15<00:09,  5.80batch/s][A
Predicting:  54%|█████▍    | 65/120 [00:15<00:11,  4.73batch/s][A
Predicting:  55%|█████▌    | 66/120 [00:16<00:13,  4.13batch/s][A
Predicting:  56%|█████▌    | 67/120 [00:16<00:13,  3.82batch/s][A
Predicting:  57%|█████▋    | 68/120 [00:16<00:11,  4.52batch/s][A
Predicting:  57%|█████▊    | 69/120 [00:16<00:12,  3.97batch/s][A
Predicting:  58%|█████▊    | 70/120 [00:17<00:10,  4.77batch/s][A
Predicting:  59%|█████▉    | 71/120 [00:17<00:10,  4.84batch/s][A
Predicting:  61%|██████    | 73/120 [00:17<00:09,  5.18batch/s][A
Predicting:  62%|██████▏   | 74/120 [00:18<00:12,  3.64batch/s][A
Predicting:  62%|██████▎   | 75/120 [00:18<00:12,  3.47batch/s][A
Predicting:  63%|██████▎   | 76/120 [00:18<00:11,  3.99batch/s][A
Predicting:  64%|██████▍   | 77/120 [00:18<00:11,  3.75batch/s][A
Predicting:  65%|██████▌   | 78/120 [00:19<00:11,  3.56batch/s][A
Predicting:  66%|██████▌   | 79/120 [00:19<00:11,  3.46batch/s][A
Predicting:  68%|██████▊   | 81/120 [00:19<00:08,  4.71batch/s][A
Predicting:  68%|██████▊   | 82/120 [00:19<00:07,  5.20batch/s][A
Predicting:  69%|██████▉   | 83/120 [00:20<00:08,  4.51batch/s][A
Predicting:  70%|███████   | 84/120 [00:20<00:08,  4.12batch/s][A
Predicting:  71%|███████   | 85/120 [00:20<00:07,  4.75batch/s][A
Predicting:  72%|███████▏  | 86/120 [00:20<00:06,  5.04batch/s][A
Predicting:  72%|███████▎  | 87/120 [00:21<00:07,  4.37batch/s][A
Predicting:  73%|███████▎  | 88/120 [00:21<00:06,  4.80batch/s][A
Predicting:  74%|███████▍  | 89/120 [00:21<00:05,  5.57batch/s][A
Predicting:  75%|███████▌  | 90/120 [00:21<00:06,  4.58batch/s][A
Predicting:  76%|███████▌  | 91/120 [00:21<00:05,  5.33batch/s][A
Predicting:  77%|███████▋  | 92/120 [00:22<00:06,  4.51batch/s][A
Predicting:  78%|███████▊  | 93/120 [00:22<00:05,  4.76batch/s][A
Predicting:  79%|███████▉  | 95/120 [00:22<00:04,  5.14batch/s][A
Predicting:  80%|████████  | 96/120 [00:22<00:05,  4.45batch/s][A
Predicting:  81%|████████  | 97/120 [00:23<00:05,  4.03batch/s][A
Predicting:  82%|████████▏ | 98/120 [00:23<00:05,  3.73batch/s][A
Predicting:  82%|████████▎ | 99/120 [00:23<00:05,  3.54batch/s][A
Predicting:  83%|████████▎ | 100/120 [00:24<00:05,  3.57batch/s][A
Predicting:  84%|████████▍ | 101/120 [00:24<00:05,  3.49batch/s][A
Predicting:  85%|████████▌ | 102/120 [00:24<00:05,  3.36batch/s][A
Predicting:  86%|████████▌ | 103/120 [00:24<00:04,  3.91batch/s][A
Predicting:  87%|████████▋ | 104/120 [00:25<00:04,  3.42batch/s][A
Predicting:  88%|████████▊ | 105/120 [00:25<00:04,  3.36batch/s][A
Predicting:  88%|████████▊ | 106/120 [00:25<00:03,  3.85batch/s][A
Predicting:  89%|████████▉ | 107/120 [00:26<00:03,  4.04batch/s][A
Predicting:  90%|█████████ | 108/120 [00:26<00:02,  4.22batch/s][A
Predicting:  91%|█████████ | 109/120 [00:26<00:02,  3.76batch/s][A
Predicting:  92%|█████████▏| 110/120 [00:26<00:02,  3.55batch/s][A
Predicting:  92%|█████████▎| 111/120 [00:27<00:02,  3.99batch/s][A
Predicting:  93%|█████████▎| 112/120 [00:27<00:01,  4.59batch/s][A
Predicting:  94%|█████████▍| 113/120 [00:27<00:01,  4.65batch/s][A
Predicting:  95%|█████████▌| 114/120 [00:27<00:01,  5.01batch/s][A
Predicting:  96%|█████████▌| 115/120 [00:27<00:00,  5.46batch/s][A
Predicting:  97%|█████████▋| 116/120 [00:27<00:00,  5.90batch/s][A
Predicting:  98%|█████████▊| 118/120 [00:28<00:00,  7.40batch/s][A
Predicting:  99%|█████████▉| 119/120 [00:28<00:00,  7.85batch/s][A
Predicting: 100%|██████████| 120/120 [00:28<00:00,  6.03batch/s][APredicting: 100%|██████████| 120/120 [00:28<00:00,  4.20batch/s]
INFO:state._cli._tx._predict:Creating anndatas from predictions from manual loop...
... storing 'target_gene' as categorical
... storing 'cell_type' as categorical
... storing 'batch_var' as categorical
... storing 'ctrl_cell_barcode' as categorical
... storing 'target_gene' as categorical
... storing 'cell_type' as categorical
... storing 'batch_var' as categorical
... storing 'ctrl_cell_barcode' as categorical
INFO:state._cli._tx._predict:Saved adata_pred to competition/sm_trainer_test/eval_temp_eval_checkpoint.ckpt/adata_pred.h5ad
INFO:state._cli._tx._predict:Saved adata_real to competition/sm_trainer_test/eval_temp_eval_checkpoint.ckpt/adata_real.h5ad
INFO:state._cli._tx._predict:Computing metrics using cell-eval...
WARNING:cell_eval._evaluator:Output directory competition/sm_trainer_test/eval_temp_eval_checkpoint.ckpt already exists, potential overwrite occurring
INFO:cell_eval._evaluator:Input is found to be log-normalized already - skipping transformation.
INFO:cell_eval._evaluator:Input is found to be log-normalized already - skipping transformation.
INFO:cell_eval._evaluator:Computing DE for real data
INFO:pdex._single_cell:Precomputing masks for each target gene

Identifying target masks:   0%|          | 0/69 [00:00<?, ?it/s][AIdentifying target masks: 100%|██████████| 69/69 [00:00<00:00, 33311.12it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature

Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s][AIdentifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 6625285.37it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=1247520
INFO:pdex._single_cell:Creating generator of all batches: N=610
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches

Processing batches:   0%|          | 0/610 [00:00<?, ?it/s][A
Processing batches:   1%|▏         | 9/610 [00:00<00:30, 19.67it/s][A
Processing batches:   2%|▏         | 11/610 [00:02<02:45,  3.62it/s][A
Processing batches:   3%|▎         | 21/610 [00:02<01:18,  7.47it/s][A
Processing batches:   4%|▍         | 23/610 [00:04<02:26,  4.01it/s][A
Processing batches:   4%|▍         | 25/610 [00:04<02:06,  4.61it/s][A
Processing batches:   5%|▌         | 33/610 [00:05<01:20,  7.15it/s][A
Processing batches:   6%|▌         | 35/610 [00:07<02:24,  3.98it/s][A
Processing batches:   7%|▋         | 42/610 [00:07<01:25,  6.66it/s][A
Processing batches:   7%|▋         | 45/610 [00:07<01:26,  6.54it/s][A
Processing batches:   8%|▊         | 47/610 [00:09<02:32,  3.70it/s][A
Processing batches:   8%|▊         | 51/610 [00:09<01:47,  5.19it/s][A
Processing batches:   9%|▉         | 55/610 [00:09<01:17,  7.15it/s][A
Processing batches:  10%|▉         | 58/610 [00:11<02:34,  3.57it/s][A
Processing batches:  10%|█         | 62/610 [00:11<01:50,  4.98it/s][A
Processing batches:  11%|█         | 66/610 [00:12<01:42,  5.29it/s][A
Processing batches:  11%|█▏        | 70/610 [00:14<02:13,  4.05it/s][A
Processing batches:  12%|█▏        | 72/610 [00:14<01:54,  4.72it/s][A
Processing batches:  13%|█▎        | 77/610 [00:14<01:15,  7.08it/s][A
Processing batches:  13%|█▎        | 79/610 [00:14<01:29,  5.96it/s][A
Processing batches:  13%|█▎        | 81/610 [00:14<01:16,  6.94it/s][A
Processing batches:  14%|█▎        | 83/610 [00:16<02:27,  3.57it/s][A
Processing batches:  14%|█▍        | 86/610 [00:16<01:44,  5.00it/s][A
Processing batches:  15%|█▍        | 90/610 [00:16<01:16,  6.81it/s][A
Processing batches:  15%|█▌        | 92/610 [00:17<01:23,  6.20it/s][A
Processing batches:  15%|█▌        | 94/610 [00:18<02:37,  3.29it/s][A
Processing batches:  16%|█▌        | 98/610 [00:19<01:51,  4.59it/s][A
Processing batches:  16%|█▌        | 99/610 [00:19<01:44,  4.88it/s][A
Processing batches:  17%|█▋        | 102/610 [00:19<01:15,  6.69it/s][A
Processing batches:  17%|█▋        | 104/610 [00:19<01:27,  5.76it/s][A
Processing batches:  17%|█▋        | 106/610 [00:21<02:44,  3.07it/s][A
Processing batches:  18%|█▊        | 111/610 [00:21<01:32,  5.38it/s][A
Processing batches:  19%|█▊        | 113/610 [00:21<01:18,  6.31it/s][A
Processing batches:  19%|█▉        | 115/610 [00:22<01:22,  5.98it/s][A
Processing batches:  19%|█▉        | 117/610 [00:22<01:43,  4.76it/s][A
Processing batches:  19%|█▉        | 118/610 [00:23<02:26,  3.35it/s][A
Processing batches:  20%|█▉        | 121/610 [00:24<02:40,  3.04it/s][A
Processing batches:  20%|██        | 124/610 [00:24<01:54,  4.26it/s][A
Processing batches:  21%|██        | 129/610 [00:25<01:36,  4.97it/s][A
Processing batches:  21%|██▏       | 130/610 [00:25<01:40,  4.77it/s][A
Processing batches:  22%|██▏       | 133/610 [00:26<01:18,  6.04it/s][A
Processing batches:  22%|██▏       | 134/610 [00:26<01:16,  6.21it/s][A
Processing batches:  22%|██▏       | 136/610 [00:26<01:24,  5.63it/s][A
Processing batches:  22%|██▏       | 137/610 [00:26<01:24,  5.60it/s][A
Processing batches:  23%|██▎       | 138/610 [00:27<01:17,  6.06it/s][A
Processing batches:  23%|██▎       | 139/610 [00:27<01:22,  5.68it/s][A
Processing batches:  23%|██▎       | 141/610 [00:28<02:00,  3.90it/s][A
Processing batches:  23%|██▎       | 142/610 [00:28<01:55,  4.05it/s][A
Processing batches:  23%|██▎       | 143/610 [00:28<01:44,  4.45it/s][A
Processing batches:  24%|██▍       | 145/610 [00:28<01:14,  6.28it/s][A
Processing batches:  24%|██▍       | 146/610 [00:28<01:12,  6.43it/s][A
Processing batches:  24%|██▍       | 148/610 [00:29<01:26,  5.36it/s][A
Processing batches:  24%|██▍       | 149/610 [00:29<01:35,  4.85it/s][A
Processing batches:  25%|██▍       | 151/610 [00:29<01:25,  5.36it/s][A
Processing batches:  25%|██▌       | 153/610 [00:30<01:48,  4.21it/s][A
Processing batches:  25%|██▌       | 154/610 [00:30<01:45,  4.32it/s][A
Processing batches:  25%|██▌       | 155/610 [00:30<01:37,  4.66it/s][A
Processing batches:  26%|██▌       | 156/610 [00:30<01:27,  5.22it/s][A
Processing batches:  26%|██▌       | 158/610 [00:31<01:10,  6.43it/s][A
Processing batches:  26%|██▌       | 160/610 [00:31<01:20,  5.61it/s][A
Processing batches:  26%|██▋       | 161/610 [00:31<01:32,  4.84it/s][A
Processing batches:  27%|██▋       | 163/610 [00:32<01:18,  5.71it/s][A
Processing batches:  27%|██▋       | 164/610 [00:32<01:14,  5.96it/s][A
Processing batches:  27%|██▋       | 165/610 [00:32<01:53,  3.93it/s][A
Processing batches:  27%|██▋       | 166/610 [00:32<01:49,  4.06it/s][A
Processing batches:  27%|██▋       | 167/610 [00:33<02:20,  3.15it/s][A
Processing batches:  28%|██▊       | 172/610 [00:33<01:10,  6.19it/s][A
Processing batches:  28%|██▊       | 173/610 [00:34<01:23,  5.25it/s][A
Processing batches:  29%|██▊       | 175/610 [00:34<01:15,  5.77it/s][A
Processing batches:  29%|██▉       | 177/610 [00:35<01:30,  4.79it/s][A
Processing batches:  29%|██▉       | 178/610 [00:35<01:33,  4.63it/s][A
Processing batches:  29%|██▉       | 179/610 [00:35<01:28,  4.87it/s][A
Processing batches:  30%|██▉       | 180/610 [00:35<01:41,  4.22it/s][A
Processing batches:  30%|███       | 183/610 [00:35<00:58,  7.30it/s][A
Processing batches:  30%|███       | 185/610 [00:36<01:23,  5.06it/s][A
Processing batches:  31%|███       | 187/610 [00:36<01:15,  5.59it/s][A
Processing batches:  31%|███       | 188/610 [00:36<01:10,  5.98it/s][A
Processing batches:  31%|███       | 189/610 [00:37<01:35,  4.40it/s][A
Processing batches:  31%|███       | 190/610 [00:37<01:33,  4.48it/s][A
Processing batches:  31%|███▏      | 191/610 [00:37<01:31,  4.57it/s][A
Processing batches:  31%|███▏      | 192/610 [00:38<01:45,  3.94it/s][A
Processing batches:  32%|███▏      | 196/610 [00:38<01:08,  6.01it/s][A
Processing batches:  32%|███▏      | 197/610 [00:38<01:19,  5.20it/s][A
Processing batches:  32%|███▏      | 198/610 [00:39<01:14,  5.55it/s][A
Processing batches:  33%|███▎      | 199/610 [00:39<01:11,  5.72it/s][A
Processing batches:  33%|███▎      | 200/610 [00:39<01:09,  5.94it/s][A
Processing batches:  33%|███▎      | 201/610 [00:39<01:37,  4.20it/s][A
Processing batches:  33%|███▎      | 202/610 [00:40<01:34,  4.31it/s][A
Processing batches:  33%|███▎      | 203/610 [00:40<01:23,  4.90it/s][A
Processing batches:  33%|███▎      | 204/610 [00:40<01:45,  3.83it/s][A
Processing batches:  34%|███▍      | 208/610 [00:40<01:04,  6.24it/s][A
Processing batches:  34%|███▍      | 209/610 [00:41<01:21,  4.91it/s][A
Processing batches:  34%|███▍      | 210/610 [00:41<01:16,  5.20it/s][A
Processing batches:  35%|███▍      | 211/610 [00:41<01:09,  5.74it/s][A
Processing batches:  35%|███▍      | 212/610 [00:41<01:05,  6.03it/s][A
Processing batches:  35%|███▍      | 213/610 [00:42<01:30,  4.38it/s][A
Processing batches:  35%|███▌      | 214/610 [00:42<01:27,  4.55it/s][A
Processing batches:  35%|███▌      | 215/610 [00:42<01:20,  4.90it/s][A
Processing batches:  35%|███▌      | 216/610 [00:42<01:45,  3.74it/s][A
Processing batches:  36%|███▌      | 220/610 [00:43<01:01,  6.34it/s][A
Processing batches:  36%|███▌      | 221/610 [00:43<01:21,  4.78it/s][A
Processing batches:  36%|███▋      | 222/610 [00:43<01:15,  5.11it/s][A
Processing batches:  37%|███▋      | 224/610 [00:44<01:03,  6.05it/s][A
Processing batches:  37%|███▋      | 225/610 [00:44<01:21,  4.70it/s][A
Processing batches:  37%|███▋      | 226/610 [00:44<01:19,  4.83it/s][A
Processing batches:  37%|███▋      | 227/610 [00:44<01:16,  4.99it/s][A
Processing batches:  37%|███▋      | 228/610 [00:45<01:38,  3.88it/s][A
Processing batches:  38%|███▊      | 231/610 [00:45<00:52,  7.16it/s][A
Processing batches:  38%|███▊      | 233/610 [00:46<01:21,  4.61it/s][A
Processing batches:  38%|███▊      | 234/610 [00:46<01:16,  4.89it/s][A
Processing batches:  39%|███▊      | 236/610 [00:46<01:06,  5.62it/s][A
Processing batches:  39%|███▉      | 237/610 [00:46<01:15,  4.91it/s][A
Processing batches:  39%|███▉      | 238/610 [00:47<01:12,  5.10it/s][A
Processing batches:  39%|███▉      | 239/610 [00:47<01:09,  5.36it/s][A
Processing batches:  39%|███▉      | 240/610 [00:47<01:37,  3.78it/s][A
Processing batches:  40%|████      | 244/610 [00:47<00:53,  6.81it/s][A
Processing batches:  40%|████      | 245/610 [00:48<01:24,  4.31it/s][A
Processing batches:  40%|████      | 246/610 [00:48<01:15,  4.80it/s][A
Processing batches:  41%|████      | 248/610 [00:48<01:04,  5.60it/s][A
Processing batches:  41%|████      | 249/610 [00:49<01:14,  4.87it/s][A
Processing batches:  41%|████      | 250/610 [00:49<01:08,  5.25it/s][A
Processing batches:  41%|████      | 251/610 [00:49<01:06,  5.41it/s][A
Processing batches:  41%|████▏     | 252/610 [00:50<01:29,  4.01it/s][A
Processing batches:  41%|████▏     | 253/610 [00:50<01:15,  4.75it/s][A
Processing batches:  42%|████▏     | 256/610 [00:50<00:45,  7.83it/s][A
Processing batches:  42%|████▏     | 257/610 [00:50<01:24,  4.18it/s][A
Processing batches:  42%|████▏     | 258/610 [00:51<01:19,  4.40it/s][A
Processing batches:  43%|████▎     | 260/610 [00:51<01:01,  5.69it/s][A
Processing batches:  43%|████▎     | 261/610 [00:51<01:08,  5.07it/s][A
Processing batches:  43%|████▎     | 262/610 [00:51<01:09,  5.01it/s][A
Processing batches:  43%|████▎     | 263/610 [00:51<01:04,  5.35it/s][A
Processing batches:  43%|████▎     | 264/610 [00:52<01:24,  4.10it/s][A
Processing batches:  43%|████▎     | 265/610 [00:52<01:12,  4.74it/s][A
Processing batches:  44%|████▎     | 266/610 [00:52<01:31,  3.75it/s][A
Processing batches:  44%|████▍     | 269/610 [00:53<01:38,  3.45it/s][A
Processing batches:  44%|████▍     | 270/610 [00:54<01:34,  3.59it/s][A
Processing batches:  45%|████▍     | 272/610 [00:54<01:22,  4.09it/s][A
Processing batches:  45%|████▌     | 276/610 [00:54<00:50,  6.62it/s][A
Processing batches:  45%|████▌     | 277/610 [00:54<00:51,  6.43it/s][A
Processing batches:  46%|████▌     | 279/610 [00:55<00:55,  6.00it/s][A
Processing batches:  46%|████▌     | 281/610 [00:56<01:43,  3.19it/s][A
Processing batches:  47%|████▋     | 284/610 [00:56<01:10,  4.59it/s][A
Processing batches:  47%|████▋     | 287/610 [00:56<00:52,  6.10it/s][A
Processing batches:  47%|████▋     | 289/610 [00:57<00:50,  6.36it/s][A
Processing batches:  48%|████▊     | 291/610 [00:57<00:51,  6.14it/s][A
Processing batches:  48%|████▊     | 293/610 [00:58<01:30,  3.51it/s][A
Processing batches:  48%|████▊     | 295/610 [00:58<01:10,  4.48it/s][A
Processing batches:  49%|████▊     | 297/610 [00:59<00:55,  5.60it/s][A
Processing batches:  49%|████▉     | 299/610 [00:59<00:53,  5.79it/s][A
Processing batches:  49%|████▉     | 301/610 [00:59<00:48,  6.40it/s][A
Processing batches:  50%|████▉     | 303/610 [00:59<00:47,  6.43it/s][A
Processing batches:  50%|█████     | 305/610 [01:01<01:29,  3.40it/s][A
Processing batches:  50%|█████     | 307/610 [01:01<01:12,  4.19it/s][A
Processing batches:  51%|█████     | 310/610 [01:01<00:49,  6.09it/s][A
Processing batches:  51%|█████     | 312/610 [01:01<00:46,  6.47it/s][A
Processing batches:  51%|█████▏    | 314/610 [01:02<00:43,  6.78it/s][A
Processing batches:  52%|█████▏    | 315/610 [01:02<00:49,  5.95it/s][A
Processing batches:  52%|█████▏    | 317/610 [01:03<01:30,  3.23it/s][A
Processing batches:  52%|█████▏    | 319/610 [01:03<01:10,  4.15it/s][A
Processing batches:  53%|█████▎    | 322/610 [01:03<00:49,  5.85it/s][A
Processing batches:  53%|█████▎    | 324/610 [01:04<00:46,  6.16it/s][A
Processing batches:  53%|█████▎    | 325/610 [01:04<00:45,  6.29it/s][A
Processing batches:  54%|█████▎    | 327/610 [01:04<00:44,  6.40it/s][A
Processing batches:  54%|█████▍    | 329/610 [01:05<01:27,  3.21it/s][A
Processing batches:  54%|█████▍    | 331/610 [01:06<01:05,  4.28it/s][A
Processing batches:  55%|█████▍    | 333/610 [01:06<00:52,  5.28it/s][A
Processing batches:  55%|█████▍    | 334/610 [01:06<00:48,  5.70it/s][A
Processing batches:  55%|█████▌    | 336/610 [01:06<00:42,  6.49it/s][A
Processing batches:  55%|█████▌    | 337/610 [01:06<00:39,  6.88it/s][A
Processing batches:  56%|█████▌    | 339/610 [01:07<00:40,  6.76it/s][A
Processing batches:  56%|█████▌    | 341/610 [01:08<01:22,  3.25it/s][A
Processing batches:  56%|█████▌    | 342/610 [01:08<01:13,  3.64it/s][A
Processing batches:  57%|█████▋    | 345/610 [01:08<00:50,  5.24it/s][A
Processing batches:  57%|█████▋    | 346/610 [01:08<00:48,  5.41it/s][A
Processing batches:  57%|█████▋    | 348/610 [01:09<00:40,  6.42it/s][A
Processing batches:  57%|█████▋    | 350/610 [01:09<00:32,  8.06it/s][A
Processing batches:  58%|█████▊    | 352/610 [01:09<00:38,  6.76it/s][A
Processing batches:  58%|█████▊    | 353/610 [01:10<01:24,  3.05it/s][A
Processing batches:  58%|█████▊    | 354/610 [01:10<01:16,  3.34it/s][A
Processing batches:  59%|█████▊    | 357/610 [01:11<00:49,  5.12it/s][A
Processing batches:  59%|█████▉    | 359/610 [01:11<00:40,  6.27it/s][A
Processing batches:  59%|█████▉    | 360/610 [01:11<00:44,  5.65it/s][A
Processing batches:  60%|█████▉    | 363/610 [01:12<00:52,  4.74it/s][A
Processing batches:  60%|█████▉    | 365/610 [01:12<01:02,  3.95it/s][A
Processing batches:  60%|██████    | 366/610 [01:13<01:02,  3.92it/s][A
Processing batches:  60%|██████    | 369/610 [01:13<00:45,  5.31it/s][A
Processing batches:  61%|██████    | 371/610 [01:13<00:36,  6.63it/s][A
Processing batches:  61%|██████    | 372/610 [01:13<00:38,  6.17it/s][A
Processing batches:  61%|██████▏   | 375/610 [01:14<00:34,  6.90it/s][A
Processing batches:  62%|██████▏   | 376/610 [01:14<00:42,  5.50it/s][A
Processing batches:  62%|██████▏   | 377/610 [01:15<01:06,  3.49it/s][A
Processing batches:  62%|██████▏   | 378/610 [01:15<01:06,  3.49it/s][A
Processing batches:  62%|██████▏   | 381/610 [01:15<00:42,  5.40it/s][A
Processing batches:  63%|██████▎   | 383/610 [01:16<00:37,  6.09it/s][A
Processing batches:  63%|██████▎   | 384/610 [01:16<00:36,  6.11it/s][A
Processing batches:  63%|██████▎   | 387/610 [01:16<00:34,  6.54it/s][A
Processing batches:  64%|██████▎   | 388/610 [01:16<00:38,  5.79it/s][A
Processing batches:  64%|██████▍   | 389/610 [01:17<01:03,  3.48it/s][A
Processing batches:  64%|██████▍   | 390/610 [01:17<01:03,  3.46it/s][A
Processing batches:  64%|██████▍   | 393/610 [01:18<00:39,  5.44it/s][A
Processing batches:  65%|██████▍   | 394/610 [01:18<00:36,  5.86it/s][A
Processing batches:  65%|██████▍   | 395/610 [01:18<00:35,  5.97it/s][A
Processing batches:  65%|██████▍   | 396/610 [01:18<00:35,  6.04it/s][A
Processing batches:  65%|██████▌   | 398/610 [01:18<00:25,  8.34it/s][A
Processing batches:  66%|██████▌   | 400/610 [01:19<00:36,  5.76it/s][A
Processing batches:  66%|██████▌   | 401/610 [01:20<01:03,  3.27it/s][A
Processing batches:  66%|██████▌   | 402/610 [01:20<01:00,  3.41it/s][A
Processing batches:  66%|██████▋   | 405/610 [01:20<00:39,  5.14it/s][A
Processing batches:  67%|██████▋   | 406/610 [01:20<00:36,  5.54it/s][A
Processing batches:  67%|██████▋   | 407/610 [01:20<00:36,  5.59it/s][A
Processing batches:  67%|██████▋   | 408/610 [01:21<00:32,  6.13it/s][A
Processing batches:  67%|██████▋   | 410/610 [01:21<00:24,  8.26it/s][A
Processing batches:  68%|██████▊   | 412/610 [01:21<00:33,  5.88it/s][A
Processing batches:  68%|██████▊   | 413/610 [01:22<00:59,  3.29it/s][A
Processing batches:  68%|██████▊   | 414/610 [01:22<00:57,  3.44it/s][A
Processing batches:  68%|██████▊   | 415/610 [01:23<01:09,  2.80it/s][A
Processing batches:  69%|██████▊   | 418/610 [01:23<00:48,  3.93it/s][A
Processing batches:  69%|██████▊   | 419/610 [01:23<00:45,  4.18it/s][A
Processing batches:  69%|██████▉   | 422/610 [01:24<00:33,  5.58it/s][A
Processing batches:  70%|██████▉   | 425/610 [01:24<00:34,  5.38it/s][A
Processing batches:  70%|██████▉   | 426/610 [01:25<00:37,  4.90it/s][A
Processing batches:  70%|███████   | 428/610 [01:25<00:31,  5.80it/s][A
Processing batches:  70%|███████   | 429/610 [01:25<00:47,  3.83it/s][A
Processing batches:  71%|███████   | 432/610 [01:26<00:35,  5.02it/s][A
Processing batches:  71%|███████   | 434/610 [01:26<00:28,  6.16it/s][A
Processing batches:  71%|███████▏  | 436/610 [01:26<00:26,  6.51it/s][A
Processing batches:  72%|███████▏  | 437/610 [01:27<00:34,  5.03it/s][A
Processing batches:  72%|███████▏  | 438/610 [01:27<00:36,  4.71it/s][A
Processing batches:  72%|███████▏  | 439/610 [01:27<00:33,  5.09it/s][A
Processing batches:  72%|███████▏  | 440/610 [01:27<00:31,  5.32it/s][A
Processing batches:  72%|███████▏  | 441/610 [01:28<00:39,  4.27it/s][A
Processing batches:  73%|███████▎  | 443/610 [01:28<00:32,  5.08it/s][A
Processing batches:  73%|███████▎  | 444/610 [01:28<00:30,  5.44it/s][A
Processing batches:  73%|███████▎  | 445/610 [01:28<00:28,  5.79it/s][A
Processing batches:  73%|███████▎  | 447/610 [01:28<00:22,  7.22it/s][A
Processing batches:  73%|███████▎  | 448/610 [01:29<00:29,  5.49it/s][A
Processing batches:  74%|███████▎  | 449/610 [01:29<00:38,  4.21it/s][A
Processing batches:  74%|███████▍  | 450/610 [01:29<00:35,  4.48it/s][A
Processing batches:  74%|███████▍  | 451/610 [01:29<00:32,  4.84it/s][A
Processing batches:  74%|███████▍  | 452/610 [01:30<00:31,  4.94it/s][A
Processing batches:  74%|███████▍  | 453/610 [01:30<00:36,  4.30it/s][A
Processing batches:  74%|███████▍  | 454/610 [01:30<00:32,  4.79it/s][A
Processing batches:  75%|███████▍  | 455/610 [01:30<00:32,  4.79it/s][A
Processing batches:  75%|███████▍  | 457/610 [01:31<00:26,  5.81it/s][A
Processing batches:  75%|███████▌  | 459/610 [01:31<00:19,  7.64it/s][A
Processing batches:  75%|███████▌  | 460/610 [01:31<00:27,  5.38it/s][A
Processing batches:  76%|███████▌  | 461/610 [01:32<00:36,  4.08it/s][A
Processing batches:  76%|███████▌  | 462/610 [01:32<00:48,  3.05it/s][A
Processing batches:  76%|███████▌  | 465/610 [01:32<00:28,  5.06it/s][A
Processing batches:  76%|███████▋  | 466/610 [01:33<00:29,  4.95it/s][A
Processing batches:  77%|███████▋  | 467/610 [01:33<00:28,  5.05it/s][A
Processing batches:  77%|███████▋  | 469/610 [01:33<00:23,  6.01it/s][A
Processing batches:  77%|███████▋  | 471/610 [01:33<00:19,  7.28it/s][A
Processing batches:  77%|███████▋  | 472/610 [01:33<00:24,  5.54it/s][A
Processing batches:  78%|███████▊  | 473/610 [01:34<00:32,  4.22it/s][A
Processing batches:  78%|███████▊  | 474/610 [01:34<00:30,  4.45it/s][A
Processing batches:  78%|███████▊  | 475/610 [01:34<00:36,  3.68it/s][A
Processing batches:  78%|███████▊  | 477/610 [01:35<00:25,  5.21it/s][A
Processing batches:  78%|███████▊  | 478/610 [01:35<00:27,  4.79it/s][A
Processing batches:  79%|███████▊  | 479/610 [01:35<00:26,  4.87it/s][A
Processing batches:  79%|███████▉  | 481/610 [01:35<00:19,  6.55it/s][A
Processing batches:  79%|███████▉  | 483/610 [01:36<00:18,  6.85it/s][A
Processing batches:  79%|███████▉  | 484/610 [01:36<00:24,  5.09it/s][A
Processing batches:  80%|███████▉  | 485/610 [01:36<00:27,  4.58it/s][A
Processing batches:  80%|███████▉  | 486/610 [01:36<00:26,  4.77it/s][A
Processing batches:  80%|███████▉  | 487/610 [01:37<00:33,  3.72it/s][A
Processing batches:  80%|████████  | 489/610 [01:37<00:23,  5.18it/s][A
Processing batches:  80%|████████  | 490/610 [01:37<00:24,  4.83it/s][A
Processing batches:  80%|████████  | 491/610 [01:37<00:24,  4.92it/s][A
Processing batches:  81%|████████  | 492/610 [01:38<00:20,  5.66it/s][A
Processing batches:  81%|████████  | 493/610 [01:38<00:19,  5.86it/s][A
Processing batches:  81%|████████  | 495/610 [01:38<00:15,  7.44it/s][A
Processing batches:  81%|████████▏ | 496/610 [01:38<00:22,  5.11it/s][A
Processing batches:  81%|████████▏ | 497/610 [01:39<00:23,  4.76it/s][A
Processing batches:  82%|████████▏ | 498/610 [01:39<00:23,  4.70it/s][A
Processing batches:  82%|████████▏ | 499/610 [01:39<00:29,  3.72it/s][A
Processing batches:  82%|████████▏ | 501/610 [01:39<00:22,  4.86it/s][A
Processing batches:  82%|████████▏ | 502/610 [01:40<00:24,  4.40it/s][A
Processing batches:  83%|████████▎ | 504/610 [01:40<00:18,  5.59it/s][A
Processing batches:  83%|████████▎ | 505/610 [01:40<00:18,  5.80it/s][A
Processing batches:  83%|████████▎ | 507/610 [01:40<00:14,  6.95it/s][A
Processing batches:  83%|████████▎ | 508/610 [01:41<00:19,  5.26it/s][A
Processing batches:  83%|████████▎ | 509/610 [01:41<00:21,  4.66it/s][A
Processing batches:  84%|████████▎ | 510/610 [01:41<00:21,  4.68it/s][A
Processing batches:  84%|████████▍ | 511/610 [01:42<00:26,  3.76it/s][A
Processing batches:  84%|████████▍ | 513/610 [01:42<00:20,  4.78it/s][A
Processing batches:  84%|████████▍ | 514/610 [01:42<00:21,  4.37it/s][A
Processing batches:  85%|████████▍ | 516/610 [01:42<00:16,  5.58it/s][A
Processing batches:  85%|████████▍ | 517/610 [01:42<00:16,  5.80it/s][A
Processing batches:  85%|████████▌ | 519/610 [01:43<00:13,  6.86it/s][A
Processing batches:  85%|████████▌ | 520/610 [01:43<00:16,  5.40it/s][A
Processing batches:  85%|████████▌ | 521/610 [01:43<00:17,  4.97it/s][A
Processing batches:  86%|████████▌ | 522/610 [01:44<00:18,  4.77it/s][A
Processing batches:  86%|████████▌ | 523/610 [01:44<00:22,  3.90it/s][A
Processing batches:  86%|████████▌ | 525/610 [01:44<00:17,  4.87it/s][A
Processing batches:  86%|████████▌ | 526/610 [01:44<00:19,  4.38it/s][A
Processing batches:  87%|████████▋ | 528/610 [01:45<00:16,  5.06it/s][A
Processing batches:  87%|████████▋ | 530/610 [01:45<00:12,  6.44it/s][A
Processing batches:  87%|████████▋ | 531/610 [01:45<00:12,  6.50it/s][A
Processing batches:  87%|████████▋ | 532/610 [01:45<00:14,  5.26it/s][A
Processing batches:  87%|████████▋ | 533/610 [01:46<00:15,  4.99it/s][A
Processing batches:  88%|████████▊ | 534/610 [01:46<00:15,  4.85it/s][A
Processing batches:  88%|████████▊ | 535/610 [01:46<00:18,  4.08it/s][A
Processing batches:  88%|████████▊ | 537/610 [01:47<00:15,  4.64it/s][A
Processing batches:  88%|████████▊ | 538/610 [01:47<00:16,  4.37it/s][A
Processing batches:  89%|████████▊ | 540/610 [01:47<00:14,  4.68it/s][A
Processing batches:  89%|████████▉ | 542/610 [01:47<00:10,  6.19it/s][A
Processing batches:  89%|████████▉ | 543/610 [01:47<00:10,  6.43it/s][A
Processing batches:  89%|████████▉ | 544/610 [01:48<00:12,  5.30it/s][A
Processing batches:  89%|████████▉ | 545/610 [01:48<00:13,  4.80it/s][A
Processing batches:  90%|████████▉ | 546/610 [01:48<00:12,  5.07it/s][A
Processing batches:  90%|████████▉ | 547/610 [01:49<00:14,  4.24it/s][A
Processing batches:  90%|█████████ | 549/610 [01:49<00:12,  4.76it/s][A
Processing batches:  90%|█████████ | 550/610 [01:49<00:13,  4.53it/s][A
Processing batches:  90%|█████████ | 552/610 [01:50<00:12,  4.66it/s][A
Processing batches:  91%|█████████ | 554/610 [01:50<00:09,  5.88it/s][A
Processing batches:  91%|█████████ | 555/610 [01:50<00:09,  6.10it/s][A
Processing batches:  91%|█████████ | 556/610 [01:50<00:09,  5.55it/s][A
Processing batches:  91%|█████████▏| 557/610 [01:50<00:10,  5.03it/s][A
Processing batches:  91%|█████████▏| 558/610 [01:51<00:10,  4.99it/s][A
Processing batches:  92%|█████████▏| 559/610 [01:51<00:17,  2.91it/s][A
Processing batches:  92%|█████████▏| 562/610 [01:52<00:09,  5.11it/s][A
Processing batches:  92%|█████████▏| 563/610 [01:52<00:08,  5.67it/s][A
Processing batches:  92%|█████████▏| 564/610 [01:52<00:12,  3.62it/s][A
Processing batches:  93%|█████████▎| 566/610 [01:53<00:09,  4.56it/s][A
Processing batches:  93%|█████████▎| 567/610 [01:53<00:09,  4.52it/s][A
Processing batches:  93%|█████████▎| 568/610 [01:53<00:09,  4.27it/s][A
Processing batches:  94%|█████████▎| 571/610 [01:53<00:06,  6.17it/s][A
Processing batches:  94%|█████████▍| 572/610 [01:54<00:08,  4.70it/s][A
Processing batches:  94%|█████████▍| 574/610 [01:54<00:06,  5.98it/s][A
Processing batches:  94%|█████████▍| 576/610 [01:54<00:06,  5.62it/s][A
Processing batches:  95%|█████████▍| 577/610 [01:55<00:10,  3.25it/s][A
Processing batches:  95%|█████████▍| 578/610 [01:55<00:08,  3.62it/s][A
Processing batches:  95%|█████████▌| 580/610 [01:56<00:06,  4.37it/s][A
Processing batches:  96%|█████████▌| 584/610 [01:56<00:04,  5.85it/s][A
Processing batches:  96%|█████████▌| 586/610 [01:56<00:03,  6.83it/s][A
Processing batches:  96%|█████████▌| 587/610 [01:56<00:03,  7.14it/s][A
Processing batches:  96%|█████████▋| 588/610 [01:57<00:03,  6.01it/s][A
Processing batches:  97%|█████████▋| 589/610 [01:57<00:06,  3.23it/s][A
Processing batches:  97%|█████████▋| 591/610 [01:58<00:04,  4.48it/s][A
Processing batches:  97%|█████████▋| 593/610 [01:58<00:03,  4.74it/s][A
Processing batches:  98%|█████████▊| 596/610 [01:58<00:02,  5.42it/s][A
Processing batches:  98%|█████████▊| 598/610 [01:59<00:01,  6.54it/s][A
Processing batches:  98%|█████████▊| 599/610 [01:59<00:01,  6.78it/s][A
Processing batches:  98%|█████████▊| 600/610 [01:59<00:01,  5.60it/s][A
Processing batches:  99%|█████████▊| 601/610 [02:00<00:02,  3.70it/s][A
Processing batches:  99%|█████████▊| 602/610 [02:00<00:01,  4.00it/s][A
Processing batches:  99%|█████████▉| 603/610 [02:00<00:01,  3.59it/s][A
Processing batches:  99%|█████████▉| 606/610 [02:00<00:00,  5.41it/s][A
Processing batches: 100%|█████████▉| 608/610 [02:01<00:00,  6.57it/s][AProcessing batches: 100%|██████████| 610/610 [02:01<00:00,  5.04it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:cell_eval._evaluator:Writing real DE results to: hepg2_real_de.csv
INFO:cell_eval._evaluator:Computing DE for pred data
INFO:pdex._single_cell:Precomputing masks for each target gene

Identifying target masks:   0%|          | 0/69 [00:00<?, ?it/s][AIdentifying target masks: 100%|██████████| 69/69 [00:00<00:00, 27421.54it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature

Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s][AIdentifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 6192472.34it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=1247520
INFO:pdex._single_cell:Creating generator of all batches: N=610
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches

Processing batches:   0%|          | 0/610 [00:00<?, ?it/s][A
Processing batches:   1%|▏         | 9/610 [00:00<00:33, 17.86it/s][A
Processing batches:   2%|▏         | 11/610 [00:02<03:19,  3.00it/s][A
Processing batches:   2%|▏         | 15/610 [00:03<02:06,  4.70it/s][A
Processing batches:   3%|▎         | 21/610 [00:03<01:30,  6.54it/s][A
Processing batches:   4%|▍         | 23/610 [00:05<03:07,  3.13it/s][A
Processing batches:   4%|▍         | 26/610 [00:05<02:24,  4.05it/s][A
Processing batches:   5%|▌         | 31/610 [00:06<01:32,  6.25it/s][A
Processing batches:   5%|▌         | 33/610 [00:06<01:32,  6.22it/s][A
Processing batches:   6%|▌         | 35/610 [00:08<03:17,  2.91it/s][A
Processing batches:   6%|▌         | 37/610 [00:08<02:39,  3.59it/s][A
Processing batches:   7%|▋         | 41/610 [00:08<01:46,  5.35it/s][A
Processing batches:   7%|▋         | 45/610 [00:09<01:29,  6.32it/s][A
Processing batches:   8%|▊         | 47/610 [00:11<03:01,  3.10it/s][A
Processing batches:   8%|▊         | 49/610 [00:11<02:28,  3.77it/s][A
Processing batches:   9%|▊         | 53/610 [00:11<01:35,  5.83it/s][A
Processing batches:   9%|▉         | 56/610 [00:11<01:15,  7.31it/s][A
Processing batches:  10%|▉         | 58/610 [00:13<03:13,  2.85it/s][A
Processing batches:  10%|▉         | 60/610 [00:13<02:37,  3.50it/s][A
Processing batches:  10%|█         | 62/610 [00:14<02:41,  3.40it/s][A
Processing batches:  11%|█▏        | 70/610 [00:16<02:14,  4.01it/s][A
Processing batches:  12%|█▏        | 72/610 [00:16<01:57,  4.56it/s][A
Processing batches:  12%|█▏        | 74/610 [00:16<01:39,  5.38it/s][A
Processing batches:  12%|█▏        | 76/610 [00:17<02:24,  3.69it/s][A
Processing batches:  13%|█▎        | 80/610 [00:17<01:34,  5.60it/s][A
Processing batches:  13%|█▎        | 82/610 [00:19<03:10,  2.77it/s][A
Processing batches:  15%|█▍        | 90/610 [00:19<01:28,  5.90it/s][A
Processing batches:  15%|█▌        | 93/610 [00:20<01:44,  4.94it/s][A
Processing batches:  16%|█▌        | 96/610 [00:21<01:56,  4.43it/s][A
Processing batches:  16%|█▌        | 98/610 [00:22<02:24,  3.53it/s][A
Processing batches:  17%|█▋        | 101/610 [00:22<01:48,  4.71it/s][A
Processing batches:  17%|█▋        | 103/610 [00:23<02:07,  3.98it/s][A
Processing batches:  17%|█▋        | 105/610 [00:23<01:47,  4.71it/s][A
Processing batches:  18%|█▊        | 107/610 [00:24<02:00,  4.18it/s][A
Processing batches:  18%|█▊        | 110/610 [00:25<02:13,  3.74it/s][A
Processing batches:  19%|█▊        | 113/610 [00:25<01:38,  5.04it/s][A
Processing batches:  19%|█▉        | 115/610 [00:26<01:59,  4.14it/s][A
Processing batches:  19%|█▉        | 117/610 [00:26<01:41,  4.84it/s][A
Processing batches:  19%|█▉        | 118/610 [00:27<02:02,  4.01it/s][A
Processing batches:  20%|██        | 122/610 [00:28<02:05,  3.88it/s][A
Processing batches:  21%|██        | 126/610 [00:28<01:26,  5.63it/s][A
Processing batches:  21%|██        | 127/610 [00:29<01:58,  4.06it/s][A
Processing batches:  21%|██        | 129/610 [00:29<01:41,  4.73it/s][A
Processing batches:  21%|██▏       | 130/610 [00:29<01:56,  4.13it/s][A
Processing batches:  22%|██▏       | 134/610 [00:30<02:01,  3.92it/s][A
Processing batches:  23%|██▎       | 138/610 [00:31<01:25,  5.54it/s][A
Processing batches:  23%|██▎       | 139/610 [00:31<01:56,  4.06it/s][A
Processing batches:  23%|██▎       | 141/610 [00:32<01:40,  4.67it/s][A
Processing batches:  23%|██▎       | 142/610 [00:32<01:49,  4.29it/s][A
Processing batches:  24%|██▍       | 146/610 [00:33<01:57,  3.96it/s][A
Processing batches:  25%|██▍       | 150/610 [00:33<01:26,  5.35it/s][A
Processing batches:  25%|██▍       | 151/610 [00:34<01:56,  3.93it/s][A
Processing batches:  25%|██▌       | 153/610 [00:34<01:39,  4.57it/s][A
Processing batches:  25%|██▌       | 154/610 [00:35<02:06,  3.59it/s][A
Processing batches:  26%|██▌       | 158/610 [00:36<01:45,  4.30it/s][A
Processing batches:  26%|██▋       | 161/610 [00:36<01:16,  5.89it/s][A
Processing batches:  27%|██▋       | 162/610 [00:36<01:22,  5.43it/s][A
Processing batches:  27%|██▋       | 163/610 [00:37<01:58,  3.78it/s][A
Processing batches:  27%|██▋       | 165/610 [00:37<01:38,  4.53it/s][A
Processing batches:  27%|██▋       | 166/610 [00:37<01:40,  4.41it/s][A
Processing batches:  27%|██▋       | 167/610 [00:38<01:50,  4.02it/s][A
Processing batches:  28%|██▊       | 169/610 [00:38<01:21,  5.40it/s][A
Processing batches:  28%|██▊       | 170/610 [00:38<02:02,  3.59it/s][A
Processing batches:  28%|██▊       | 173/610 [00:39<01:15,  5.80it/s][A
Processing batches:  29%|██▊       | 174/610 [00:39<01:24,  5.14it/s][A
Processing batches:  29%|██▊       | 175/610 [00:40<02:07,  3.41it/s][A
Processing batches:  29%|██▉       | 177/610 [00:40<01:37,  4.45it/s][A
Processing batches:  29%|██▉       | 178/610 [00:40<01:31,  4.70it/s][A
Processing batches:  29%|██▉       | 179/610 [00:40<01:45,  4.10it/s][A
Processing batches:  30%|██▉       | 181/610 [00:41<01:25,  5.02it/s][A
Processing batches:  30%|██▉       | 182/610 [00:41<01:57,  3.65it/s][A
Processing batches:  30%|███       | 185/610 [00:41<01:11,  5.91it/s][A
Processing batches:  30%|███       | 186/610 [00:42<01:27,  4.86it/s][A
Processing batches:  31%|███       | 187/610 [00:42<02:06,  3.34it/s][A
Processing batches:  31%|███       | 189/610 [00:42<01:30,  4.66it/s][A
Processing batches:  31%|███       | 190/610 [00:43<01:26,  4.86it/s][A
Processing batches:  31%|███▏      | 191/610 [00:43<01:40,  4.17it/s][A
Processing batches:  32%|███▏      | 193/610 [00:43<01:25,  4.87it/s][A
Processing batches:  32%|███▏      | 194/610 [00:44<01:49,  3.81it/s][A
Processing batches:  32%|███▏      | 196/610 [00:44<01:15,  5.48it/s][A
Processing batches:  32%|███▏      | 197/610 [00:44<01:13,  5.61it/s][A
Processing batches:  32%|███▏      | 198/610 [00:44<01:26,  4.76it/s][A
Processing batches:  33%|███▎      | 199/610 [00:45<02:11,  3.14it/s][A
Processing batches:  33%|███▎      | 201/610 [00:45<01:32,  4.42it/s][A
Processing batches:  33%|███▎      | 202/610 [00:45<01:26,  4.70it/s][A
Processing batches:  33%|███▎      | 203/610 [00:46<01:32,  4.41it/s][A
Processing batches:  33%|███▎      | 204/610 [00:46<01:20,  5.03it/s][A
Processing batches:  34%|███▎      | 205/610 [00:46<01:47,  3.76it/s][A
Processing batches:  34%|███▍      | 206/610 [00:46<01:46,  3.79it/s][A
Processing batches:  34%|███▍      | 209/610 [00:47<01:47,  3.74it/s][A
Processing batches:  34%|███▍      | 210/610 [00:48<02:03,  3.24it/s][A
Processing batches:  35%|███▍      | 212/610 [00:49<02:24,  2.75it/s][A
Processing batches:  36%|███▌      | 217/610 [00:50<01:47,  3.66it/s][A
Processing batches:  36%|███▌      | 221/610 [00:50<01:30,  4.31it/s][A
Processing batches:  37%|███▋      | 223/610 [00:51<01:23,  4.62it/s][A
Processing batches:  37%|███▋      | 226/610 [00:51<01:07,  5.72it/s][A
Processing batches:  37%|███▋      | 228/610 [00:51<01:10,  5.39it/s][A
Processing batches:  38%|███▊      | 229/610 [00:52<01:20,  4.71it/s][A
Processing batches:  38%|███▊      | 232/610 [00:52<01:20,  4.68it/s][A
Processing batches:  38%|███▊      | 233/610 [00:53<01:44,  3.60it/s][A
Processing batches:  39%|███▊      | 235/610 [00:53<01:25,  4.40it/s][A
Processing batches:  39%|███▊      | 236/610 [00:53<01:18,  4.77it/s][A
Processing batches:  39%|███▉      | 238/610 [00:53<01:02,  5.96it/s][A
Processing batches:  39%|███▉      | 240/610 [00:54<01:12,  5.09it/s][A
Processing batches:  40%|███▉      | 241/610 [00:54<01:22,  4.45it/s][A
Processing batches:  40%|████      | 244/610 [00:55<01:22,  4.46it/s][A
Processing batches:  40%|████      | 245/610 [00:56<01:47,  3.38it/s][A
Processing batches:  40%|████      | 247/610 [00:56<01:24,  4.32it/s][A
Processing batches:  41%|████      | 248/610 [00:56<01:41,  3.57it/s][A
Processing batches:  41%|████▏     | 252/610 [00:57<01:04,  5.58it/s][A
Processing batches:  41%|████▏     | 253/610 [00:57<01:14,  4.79it/s][A
Processing batches:  42%|████▏     | 256/610 [00:58<01:17,  4.54it/s][A
Processing batches:  42%|████▏     | 257/610 [00:58<01:33,  3.76it/s][A
Processing batches:  42%|████▏     | 259/610 [00:58<01:17,  4.54it/s][A
Processing batches:  43%|████▎     | 260/610 [00:59<01:12,  4.86it/s][A
Processing batches:  43%|████▎     | 261/610 [00:59<01:22,  4.23it/s][A
Processing batches:  43%|████▎     | 264/610 [00:59<01:03,  5.49it/s][A
Processing batches:  43%|████▎     | 265/610 [01:00<01:08,  5.06it/s][A
Processing batches:  44%|████▍     | 268/610 [01:01<01:22,  4.16it/s][A
Processing batches:  44%|████▍     | 269/610 [01:01<01:31,  3.74it/s][A
Processing batches:  44%|████▍     | 270/610 [01:01<01:19,  4.27it/s][A
Processing batches:  44%|████▍     | 271/610 [01:01<01:10,  4.78it/s][A
Processing batches:  45%|████▍     | 272/610 [01:01<01:12,  4.68it/s][A
Processing batches:  45%|████▍     | 273/610 [01:02<01:15,  4.44it/s][A
Processing batches:  45%|████▌     | 276/610 [01:02<01:01,  5.45it/s][A
Processing batches:  45%|████▌     | 277/610 [01:02<01:03,  5.22it/s][A
Processing batches:  46%|████▌     | 280/610 [01:03<01:20,  4.08it/s][A
Processing batches:  46%|████▌     | 281/610 [01:04<01:27,  3.75it/s][A
Processing batches:  46%|████▌     | 282/610 [01:04<01:18,  4.20it/s][A
Processing batches:  47%|████▋     | 284/610 [01:04<01:11,  4.55it/s][A
Processing batches:  47%|████▋     | 285/610 [01:04<01:12,  4.50it/s][A
Processing batches:  47%|████▋     | 288/610 [01:05<00:58,  5.48it/s][A
Processing batches:  47%|████▋     | 289/610 [01:05<01:01,  5.24it/s][A
Processing batches:  48%|████▊     | 292/610 [01:06<01:20,  3.97it/s][A
Processing batches:  48%|████▊     | 293/610 [01:06<01:23,  3.78it/s][A
Processing batches:  48%|████▊     | 294/610 [01:06<01:15,  4.17it/s][A
Processing batches:  49%|████▊     | 296/610 [01:07<01:09,  4.52it/s][A
Processing batches:  49%|████▊     | 297/610 [01:07<01:08,  4.60it/s][A
Processing batches:  49%|████▉     | 300/610 [01:07<00:56,  5.45it/s][A
Processing batches:  49%|████▉     | 301/610 [01:08<00:55,  5.58it/s][A
Processing batches:  50%|████▉     | 302/610 [01:08<00:50,  6.06it/s][A
Processing batches:  50%|████▉     | 304/610 [01:09<01:26,  3.56it/s][A
Processing batches:  50%|█████     | 305/610 [01:09<01:28,  3.43it/s][A
Processing batches:  50%|█████     | 307/610 [01:09<01:05,  4.64it/s][A
Processing batches:  50%|█████     | 308/610 [01:09<01:12,  4.19it/s][A
Processing batches:  51%|█████     | 309/610 [01:10<01:02,  4.78it/s][A
Processing batches:  51%|█████     | 312/610 [01:10<00:56,  5.30it/s][A
Processing batches:  51%|█████▏    | 313/610 [01:10<00:52,  5.64it/s][A
Processing batches:  51%|█████▏    | 314/610 [01:10<00:49,  6.00it/s][A
Processing batches:  52%|█████▏    | 316/610 [01:11<01:30,  3.24it/s][A
Processing batches:  52%|█████▏    | 317/610 [01:12<01:23,  3.49it/s][A
Processing batches:  52%|█████▏    | 318/610 [01:12<01:11,  4.06it/s][A
Processing batches:  52%|█████▏    | 320/610 [01:12<01:08,  4.21it/s][A
Processing batches:  53%|█████▎    | 324/610 [01:13<00:52,  5.43it/s][A
Processing batches:  53%|█████▎    | 325/610 [01:13<00:50,  5.62it/s][A
Processing batches:  54%|█████▎    | 327/610 [01:13<00:39,  7.09it/s][A
Processing batches:  54%|█████▍    | 328/610 [01:14<01:29,  3.14it/s][A
Processing batches:  54%|█████▍    | 329/610 [01:14<01:21,  3.43it/s][A
Processing batches:  54%|█████▍    | 330/610 [01:14<01:10,  4.00it/s][A
Processing batches:  54%|█████▍    | 332/610 [01:15<01:06,  4.15it/s][A
Processing batches:  55%|█████▌    | 336/610 [01:15<00:52,  5.18it/s][A
Processing batches:  55%|█████▌    | 338/610 [01:16<00:44,  6.12it/s][A
Processing batches:  56%|█████▌    | 339/610 [01:16<00:44,  6.11it/s][A
Processing batches:  56%|█████▌    | 340/610 [01:17<01:28,  3.05it/s][A
Processing batches:  56%|█████▌    | 341/610 [01:18<02:06,  2.12it/s][A
Processing batches:  57%|█████▋    | 345/610 [01:18<01:05,  4.03it/s][A
Processing batches:  57%|█████▋    | 348/610 [01:19<01:02,  4.19it/s][A
Processing batches:  58%|█████▊    | 352/610 [01:20<01:05,  3.96it/s][A
Processing batches:  58%|█████▊    | 355/610 [01:20<00:57,  4.45it/s][A
Processing batches:  58%|█████▊    | 356/610 [01:21<00:55,  4.56it/s][A
Processing batches:  59%|█████▊    | 357/610 [01:21<00:54,  4.65it/s][A
Processing batches:  59%|█████▉    | 360/610 [01:21<00:39,  6.27it/s][A
Processing batches:  59%|█████▉    | 362/610 [01:21<00:44,  5.62it/s][A
Processing batches:  60%|█████▉    | 364/610 [01:22<01:07,  3.64it/s][A
Processing batches:  60%|█████▉    | 365/610 [01:23<01:01,  4.00it/s][A
Processing batches:  60%|██████    | 367/610 [01:23<01:01,  3.94it/s][A
Processing batches:  60%|██████    | 369/610 [01:23<00:49,  4.84it/s][A
Processing batches:  61%|██████    | 370/610 [01:23<00:49,  4.89it/s][A
Processing batches:  61%|██████    | 373/610 [01:24<00:32,  7.40it/s][A
Processing batches:  61%|██████▏   | 375/610 [01:24<00:43,  5.43it/s][A
Processing batches:  62%|██████▏   | 376/610 [01:25<01:11,  3.27it/s][A
Processing batches:  62%|██████▏   | 377/610 [01:25<01:02,  3.70it/s][A
Processing batches:  62%|██████▏   | 378/610 [01:25<00:56,  4.12it/s][A
Processing batches:  62%|██████▏   | 379/610 [01:26<01:04,  3.59it/s][A
Processing batches:  62%|██████▏   | 381/610 [01:26<00:48,  4.71it/s][A
Processing batches:  63%|██████▎   | 383/610 [01:26<00:37,  6.03it/s][A
Processing batches:  63%|██████▎   | 385/610 [01:26<00:28,  7.80it/s][A
Processing batches:  63%|██████▎   | 387/610 [01:27<00:43,  5.13it/s][A
Processing batches:  64%|██████▎   | 388/610 [01:28<01:08,  3.22it/s][A
Processing batches:  64%|██████▍   | 389/610 [01:28<01:00,  3.63it/s][A
Processing batches:  64%|██████▍   | 390/610 [01:28<00:55,  3.95it/s][A
Processing batches:  64%|██████▍   | 391/610 [01:28<01:01,  3.57it/s][A
Processing batches:  64%|██████▍   | 393/610 [01:29<00:45,  4.78it/s][A
Processing batches:  65%|██████▍   | 395/610 [01:29<00:38,  5.64it/s][A
Processing batches:  65%|██████▌   | 398/610 [01:29<00:36,  5.82it/s][A
Processing batches:  65%|██████▌   | 399/610 [01:30<00:39,  5.36it/s][A
Processing batches:  66%|██████▌   | 400/610 [01:30<01:03,  3.32it/s][A
Processing batches:  66%|██████▌   | 401/610 [01:31<00:55,  3.74it/s][A
Processing batches:  66%|██████▌   | 402/610 [01:31<00:52,  3.95it/s][A
Processing batches:  66%|██████▌   | 403/610 [01:31<00:59,  3.48it/s][A
Processing batches:  66%|██████▋   | 405/610 [01:31<00:39,  5.15it/s][A
Processing batches:  67%|██████▋   | 407/610 [01:32<00:33,  6.12it/s][A
Processing batches:  67%|██████▋   | 409/610 [01:32<00:25,  8.02it/s][A
Processing batches:  67%|██████▋   | 411/610 [01:32<00:41,  4.84it/s][A
Processing batches:  68%|██████▊   | 412/610 [01:33<01:01,  3.22it/s][A
Processing batches:  68%|██████▊   | 413/610 [01:33<00:55,  3.55it/s][A
Processing batches:  68%|██████▊   | 414/610 [01:33<00:50,  3.85it/s][A
Processing batches:  68%|██████▊   | 415/610 [01:34<00:51,  3.82it/s][A
Processing batches:  68%|██████▊   | 416/610 [01:34<00:43,  4.50it/s][A
Processing batches:  69%|██████▊   | 418/610 [01:34<00:32,  5.87it/s][A
Processing batches:  69%|██████▊   | 419/610 [01:34<00:29,  6.49it/s][A
Processing batches:  69%|██████▉   | 421/610 [01:34<00:22,  8.31it/s][A
Processing batches:  69%|██████▉   | 422/610 [01:35<00:37,  5.03it/s][A
Processing batches:  69%|██████▉   | 423/610 [01:35<00:40,  4.60it/s][A
Processing batches:  70%|██████▉   | 424/610 [01:36<01:04,  2.89it/s][A
Processing batches:  70%|██████▉   | 425/610 [01:36<00:59,  3.13it/s][A
Processing batches:  70%|██████▉   | 426/610 [01:36<00:52,  3.52it/s][A
Processing batches:  70%|███████   | 427/610 [01:36<00:49,  3.72it/s][A
Processing batches:  70%|███████   | 429/610 [01:37<00:33,  5.37it/s][A
Processing batches:  70%|███████   | 430/610 [01:37<00:31,  5.63it/s][A
Processing batches:  71%|███████   | 433/610 [01:38<00:37,  4.73it/s][A
Processing batches:  71%|███████▏  | 435/610 [01:38<00:32,  5.39it/s][A
Processing batches:  71%|███████▏  | 436/610 [01:38<00:48,  3.57it/s][A
Processing batches:  72%|███████▏  | 437/610 [01:39<00:46,  3.70it/s][A
Processing batches:  72%|███████▏  | 438/610 [01:39<00:46,  3.73it/s][A
Processing batches:  72%|███████▏  | 439/610 [01:39<00:41,  4.16it/s][A
Processing batches:  72%|███████▏  | 440/610 [01:39<00:40,  4.15it/s][A
Processing batches:  72%|███████▏  | 442/610 [01:40<00:29,  5.73it/s][A
Processing batches:  73%|███████▎  | 445/610 [01:40<00:22,  7.37it/s][A
Processing batches:  73%|███████▎  | 446/610 [01:40<00:30,  5.31it/s][A
Processing batches:  73%|███████▎  | 447/610 [01:40<00:32,  5.05it/s][A
Processing batches:  73%|███████▎  | 448/610 [01:41<00:49,  3.24it/s][A
Processing batches:  74%|███████▎  | 449/610 [01:41<00:47,  3.42it/s][A
Processing batches:  74%|███████▍  | 450/610 [01:42<00:47,  3.35it/s][A
Processing batches:  74%|███████▍  | 452/610 [01:42<00:33,  4.71it/s][A
Processing batches:  74%|███████▍  | 453/610 [01:42<00:31,  4.96it/s][A
Processing batches:  74%|███████▍  | 454/610 [01:42<00:29,  5.37it/s][A
Processing batches:  75%|███████▍  | 457/610 [01:42<00:20,  7.55it/s][A
Processing batches:  75%|███████▌  | 458/610 [01:43<00:30,  5.01it/s][A
Processing batches:  75%|███████▌  | 459/610 [01:43<00:31,  4.83it/s][A
Processing batches:  75%|███████▌  | 460/610 [01:44<00:46,  3.24it/s][A
Processing batches:  76%|███████▌  | 461/610 [01:44<00:46,  3.20it/s][A
Processing batches:  76%|███████▌  | 462/610 [01:44<00:47,  3.09it/s][A
Processing batches:  76%|███████▌  | 464/610 [01:45<00:31,  4.63it/s][A
Processing batches:  76%|███████▌  | 465/610 [01:45<00:28,  5.18it/s][A
Processing batches:  76%|███████▋  | 466/610 [01:45<00:27,  5.21it/s][A
Processing batches:  77%|███████▋  | 469/610 [01:45<00:18,  7.77it/s][A
Processing batches:  77%|███████▋  | 470/610 [01:46<00:29,  4.79it/s][A
Processing batches:  77%|███████▋  | 471/610 [01:46<00:41,  3.32it/s][A
Processing batches:  77%|███████▋  | 472/610 [01:46<00:37,  3.71it/s][A
Processing batches:  78%|███████▊  | 473/610 [01:47<00:40,  3.42it/s][A
Processing batches:  78%|███████▊  | 474/610 [01:48<01:15,  1.80it/s][A
Processing batches:  78%|███████▊  | 477/610 [01:48<00:40,  3.25it/s][A
Processing batches:  79%|███████▊  | 480/610 [01:49<00:26,  4.96it/s][A
Processing batches:  79%|███████▉  | 483/610 [01:50<00:33,  3.80it/s][A
Processing batches:  80%|███████▉  | 486/610 [01:50<00:24,  5.09it/s][A
Processing batches:  80%|████████  | 488/610 [01:50<00:24,  5.06it/s][A
Processing batches:  80%|████████  | 490/610 [01:50<00:20,  5.86it/s][A
Processing batches:  80%|████████  | 491/610 [01:51<00:27,  4.36it/s][A
Processing batches:  81%|████████  | 492/610 [01:51<00:26,  4.43it/s][A
Processing batches:  81%|████████  | 494/610 [01:51<00:19,  6.00it/s][A
Processing batches:  81%|████████  | 495/610 [01:52<00:26,  4.32it/s][A
Processing batches:  81%|████████▏ | 496/610 [01:52<00:30,  3.70it/s][A
Processing batches:  81%|████████▏ | 497/610 [01:52<00:26,  4.29it/s][A
Processing batches:  82%|████████▏ | 498/610 [01:53<00:24,  4.52it/s][A
Processing batches:  82%|████████▏ | 500/610 [01:53<00:23,  4.70it/s][A
Processing batches:  82%|████████▏ | 502/610 [01:53<00:18,  5.85it/s][A
Processing batches:  82%|████████▏ | 503/610 [01:54<00:26,  3.99it/s][A
Processing batches:  83%|████████▎ | 505/610 [01:54<00:21,  4.89it/s][A
Processing batches:  83%|████████▎ | 507/610 [01:54<00:23,  4.45it/s][A
Processing batches:  83%|████████▎ | 508/610 [01:55<00:27,  3.71it/s][A
Processing batches:  83%|████████▎ | 509/610 [01:55<00:24,  4.15it/s][A
Processing batches:  84%|████████▎ | 510/610 [01:55<00:23,  4.27it/s][A
Processing batches:  84%|████████▍ | 512/610 [01:56<00:20,  4.80it/s][A
Processing batches:  84%|████████▍ | 514/610 [01:56<00:16,  5.99it/s][A
Processing batches:  84%|████████▍ | 515/610 [01:56<00:25,  3.79it/s][A
Processing batches:  85%|████████▍ | 517/610 [01:57<00:19,  4.74it/s][A
Processing batches:  85%|████████▌ | 519/610 [01:58<00:28,  3.21it/s][A
Processing batches:  86%|████████▌ | 522/610 [01:58<00:18,  4.68it/s][A
Processing batches:  86%|████████▌ | 523/610 [01:58<00:18,  4.77it/s][A
Processing batches:  86%|████████▌ | 524/610 [01:58<00:17,  4.95it/s][A
Processing batches:  86%|████████▌ | 526/610 [01:58<00:13,  6.01it/s][A
Processing batches:  86%|████████▋ | 527/610 [01:59<00:22,  3.74it/s][A
Processing batches:  87%|████████▋ | 529/610 [01:59<00:16,  4.86it/s][A
Processing batches:  87%|████████▋ | 531/610 [02:00<00:19,  4.03it/s][A
Processing batches:  87%|████████▋ | 532/610 [02:00<00:20,  3.75it/s][A
Processing batches:  88%|████████▊ | 534/610 [02:01<00:15,  4.82it/s][A
Processing batches:  88%|████████▊ | 535/610 [02:01<00:15,  4.84it/s][A
Processing batches:  88%|████████▊ | 536/610 [02:01<00:15,  4.85it/s][A
Processing batches:  88%|████████▊ | 538/610 [02:01<00:11,  6.39it/s][A
Processing batches:  88%|████████▊ | 539/610 [02:02<00:19,  3.66it/s][A
Processing batches:  89%|████████▊ | 541/610 [02:02<00:15,  4.55it/s][A
Processing batches:  89%|████████▉ | 543/610 [02:03<00:16,  4.09it/s][A
Processing batches:  89%|████████▉ | 544/610 [02:03<00:18,  3.66it/s][A
Processing batches:  89%|████████▉ | 545/610 [02:03<00:16,  3.88it/s][A
Processing batches:  90%|████████▉ | 547/610 [02:03<00:12,  5.09it/s][A
Processing batches:  90%|████████▉ | 548/610 [02:04<00:13,  4.70it/s][A
Processing batches:  90%|█████████ | 550/610 [02:04<00:09,  6.36it/s][A
Processing batches:  90%|█████████ | 551/610 [02:05<00:17,  3.31it/s][A
Processing batches:  91%|█████████ | 553/610 [02:05<00:12,  4.47it/s][A
Processing batches:  91%|█████████ | 555/610 [02:05<00:12,  4.35it/s][A
Processing batches:  91%|█████████ | 556/610 [02:06<00:13,  3.92it/s][A
Processing batches:  91%|█████████▏| 557/610 [02:06<00:13,  3.92it/s][A
Processing batches:  92%|█████████▏| 559/610 [02:06<00:09,  5.10it/s][A
Processing batches:  92%|█████████▏| 560/610 [02:06<00:09,  5.24it/s][A
Processing batches:  92%|█████████▏| 562/610 [02:06<00:07,  6.85it/s][A
Processing batches:  92%|█████████▏| 563/610 [02:07<00:12,  3.73it/s][A
Processing batches:  92%|█████████▏| 564/610 [02:07<00:11,  4.15it/s][A
Processing batches:  93%|█████████▎| 565/610 [02:08<00:09,  4.53it/s][A
Processing batches:  93%|█████████▎| 567/610 [02:08<00:09,  4.34it/s][A
Processing batches:  93%|█████████▎| 568/610 [02:08<00:11,  3.66it/s][A
Processing batches:  93%|█████████▎| 569/610 [02:09<00:10,  3.84it/s][A
Processing batches:  94%|█████████▎| 571/610 [02:09<00:12,  3.14it/s][A
Processing batches:  94%|█████████▍| 572/610 [02:10<00:12,  3.13it/s][A
Processing batches:  94%|█████████▍| 575/610 [02:10<00:06,  5.36it/s][A
Processing batches:  94%|█████████▍| 576/610 [02:10<00:08,  3.93it/s][A
Processing batches:  95%|█████████▍| 577/610 [02:11<00:08,  3.90it/s][A
Processing batches:  95%|█████████▍| 578/610 [02:11<00:08,  3.60it/s][A
Processing batches:  95%|█████████▍| 579/610 [02:12<00:10,  2.87it/s][A
Processing batches:  95%|█████████▌| 582/610 [02:12<00:06,  4.12it/s][A
Processing batches:  96%|█████████▌| 584/610 [02:12<00:05,  4.70it/s][A
Processing batches:  96%|█████████▌| 586/610 [02:12<00:03,  6.18it/s][A
Processing batches:  96%|█████████▌| 587/610 [02:13<00:06,  3.29it/s][A
Processing batches:  96%|█████████▋| 588/610 [02:14<00:08,  2.53it/s][A
Processing batches:  97%|█████████▋| 591/610 [02:15<00:05,  3.62it/s][A
Processing batches:  97%|█████████▋| 594/610 [02:15<00:03,  5.19it/s][A
Processing batches:  98%|█████████▊| 596/610 [02:15<00:02,  5.63it/s][A
Processing batches:  98%|█████████▊| 597/610 [02:15<00:02,  4.85it/s][A
Processing batches:  98%|█████████▊| 599/610 [02:16<00:03,  3.56it/s][A
Processing batches:  99%|█████████▊| 601/610 [02:17<00:02,  4.21it/s][A
Processing batches:  99%|█████████▊| 602/610 [02:17<00:01,  4.26it/s][A
Processing batches:  99%|█████████▉| 603/610 [02:17<00:01,  4.52it/s][A
Processing batches:  99%|█████████▉| 605/610 [02:17<00:00,  5.41it/s][A
Processing batches: 100%|█████████▉| 608/610 [02:17<00:00,  7.00it/s][AProcessing batches: 100%|██████████| 610/610 [02:17<00:00,  4.42it/s]
[rank: 0] Received SIGTERM: 15
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:cell_eval._evaluator:Writing pred DE results to: hepg2_pred_de.csv
INFO:cell_eval._pipeline._runner:Computing metric 'overlap_at_N'
INFO:cell_eval._pipeline._runner:Computing metric 'mae'
INFO:cell_eval._types._anndata:Building pseudobulk embeddings for real anndata on: .X
INFO:cell_eval._types._anndata:Building pseudobulk embeddings for predicted anndata on: .X

Iterating over perturbations...:   0%|          | 0/68 [00:00<?, ?it/s][AIterating over perturbations...: 100%|██████████| 68/68 [00:00<00:00, 3030.60it/s]
INFO:cell_eval._pipeline._runner:Computing metric 'discrimination_score_l1'

Iterating over perturbations...:   0%|          | 0/68 [00:00<?, ?it/s][AIterating over perturbations...: 100%|██████████| 68/68 [00:00<00:00, 16770.31it/s]

Iterating over perturbations...:   0%|          | 0/68 [00:00<?, ?it/s][AIterating over perturbations...: 100%|██████████| 68/68 [00:00<00:00, 16149.29it/s]
INFO:cell_eval._evaluator:Writing perturbation level metrics to competition/sm_trainer_test/eval_temp_eval_checkpoint.ckpt/hepg2_results.csv
INFO:cell_eval._evaluator:Writing aggregate metrics to competition/sm_trainer_test/eval_temp_eval_checkpoint.ckpt/hepg2_agg_results.csv
INFO:state.tx.callbacks.cell_eval_callback:Collected evaluation results for step 1 (eval #1)
INFO:state.tx.callbacks.cell_eval_callback:Creating evaluation plots (eval #1)
INFO:state.tx.callbacks.cell_eval_callback:Need at least 2 evaluations for meaningful plots
Buchi after run_tx_predict in _call_run_tx_predict
Buchi results: <class 'polars.dataframe.frame.DataFrame'>
Buchi results_with_step:    perturbation  overlap_at_N       mae  discrimination_score_l1
0         ARPC2      0.000000  0.270885                 0.941176
1       ATP6V0B      0.000000  0.260555                 0.235294
2       ATP6V0C      0.002232  0.256109                 0.161765
3         C1QBP      0.000000  0.267044                 0.294118
4          CAST      0.000000  0.280679                 0.544118
..          ...           ...       ...                      ...
63        UBE3C      0.000000  0.265507                 0.485294
64        UQCRB      0.000000  0.265177                 0.279412
65        UQCRQ      0.000000  0.264661                 0.205882
66         USF2      0.000000  0.271330                 0.794118
67          WAC      0.000000  0.273068                 0.735294

[68 rows x 4 columns]
Buchi agg_results: <class 'polars.dataframe.frame.DataFrame'>
Epoch 0:   2%|▏         | 1/52 [05:26<4:37:09,  0.00it/s]Epoch 0:   2%|▏         | 1/52 [05:26<4:37:09,  0.00it/s, v_num=a9z4]INFO:state.tx.callbacks.cell_eval_callback:Running dynamic evaluation at step 2
INFO:state._cli._tx._predict:Loaded config from competition/sm_trainer_test/config.yaml
INFO:cell_load.data_modules.perturbation_dataloader:Loaded data module configuration from competition/sm_trainer_test/data_module.torch
WARNING:cell_load.config:Dataset path does not exist: ./competition_support_set/{competition_train,k562_gwps,rpe1,jurkat,k562,hepg2}.h5
INFO:cell_load.config:Configuration validation passed
INFO:cell_load.data_modules.perturbation_dataloader:Initializing DataModule: batch_size=16, workers=1, random_seed=42
INFO:cell_load.data_modules.perturbation_dataloader:Set 2 missing perturbations to zero vectors.
INFO:cell_load.data_modules.perturbation_dataloader:Loaded custom perturbation featurizations for 19792 perturbations.
INFO:cell_load.data_modules.perturbation_dataloader:Processing dataset replogle_h1:
INFO:cell_load.data_modules.perturbation_dataloader:  - Training dataset: True
INFO:cell_load.data_modules.perturbation_dataloader:  - Zeroshot cell types: ['hepg2']
INFO:cell_load.data_modules.perturbation_dataloader:  - Fewshot cell types: []
./competition_support_set/{competition_train,k562_gwps,rpe1,jurkat,k562,hepg2}.h5

Processing replogle_h1:   0%|          | 0/6 [00:00<?, ?it/s][A                                                                     
                                                             [AProcessed competition_train: 221273 train, 0 val, 0 test
Epoch 0:   2%|▏         | 1/52 [05:43<4:52:01,  0.00it/s, v_num=a9z4]
Processing replogle_h1:   0%|          | 0/6 [00:00<?, ?it/s][A
Processing replogle_h1:  17%|█▋        | 1/6 [00:00<00:00,  7.58it/s][AWARNING:cell_load.dataset._perturbation:No cell barcode information found in competition_support_set/k562_gwps.h5. Generating generic barcodes.
                                                                     
                                                                     [AProcessed k562_gwps: 111605 train, 0 val, 0 test
Epoch 0:   2%|▏         | 1/52 [05:43<4:52:03,  0.00it/s, v_num=a9z4]
Processing replogle_h1:  17%|█▋        | 1/6 [00:00<00:00,  7.58it/s][AWARNING:cell_load.dataset._perturbation:No cell barcode information found in competition_support_set/rpe1.h5. Generating generic barcodes.
                                                                     
                                                                     [AProcessed rpe1: 22317 train, 0 val, 0 test
Epoch 0:   2%|▏         | 1/52 [05:43<4:52:04,  0.00it/s, v_num=a9z4]
Processing replogle_h1:  17%|█▋        | 1/6 [00:00<00:00,  7.58it/s][AWARNING:cell_load.dataset._perturbation:No cell barcode information found in competition_support_set/jurkat.h5. Generating generic barcodes.
                                                                     
                                                                     [AProcessed jurkat: 21412 train, 0 val, 0 test
Epoch 0:   2%|▏         | 1/52 [05:43<4:52:04,  0.00it/s, v_num=a9z4]
Processing replogle_h1:  17%|█▋        | 1/6 [00:00<00:00,  7.58it/s][AWARNING:cell_load.dataset._perturbation:No cell barcode information found in competition_support_set/k562.h5. Generating generic barcodes.
                                                                     
                                                                     [AProcessed k562: 18465 train, 0 val, 0 test
Epoch 0:   2%|▏         | 1/52 [05:43<4:52:04,  0.00it/s, v_num=a9z4]
Processing replogle_h1:  17%|█▋        | 1/6 [00:00<00:00,  7.58it/s][AWARNING:cell_load.dataset._perturbation:No cell barcode information found in competition_support_set/hepg2.h5. Generating generic barcodes.
                                                                     
                                                                     [AProcessed hepg2: 0 train, 0 val, 9386 test
Epoch 0:   2%|▏         | 1/52 [05:43<4:52:05,  0.00it/s, v_num=a9z4]
Processing replogle_h1:  17%|█▋        | 1/6 [00:00<00:00,  7.58it/s][AProcessing replogle_h1: 100%|██████████| 6/6 [00:00<00:00, 28.60it/s]
INFO:cell_load.data_modules.perturbation_dataloader:

INFO:cell_load.data_modules.perturbation_dataloader:Done! Train / Val / Test splits: 5 / 0 / 1
INFO:state._cli._tx._predict:Loaded data module from competition/sm_trainer_test/data_module.torch
Seed set to 42
INFO:state._cli._tx._predict:Loading model from competition/sm_trainer_test/checkpoints/temp_eval_checkpoint.ckpt
INFO:state._cli._tx._predict:Model loaded successfully.
INFO:cell_load.data_modules.samplers:Creating perturbation batch sampler with metadata caching (using codes)...
INFO:cell_load.data_modules.samplers:Total # cells 9386. Cell set size mean / std before resampling: 78.22 / 47.32.
INFO:cell_load.data_modules.samplers:Creating meta-batches with cell_sentence_len=128...
INFO:cell_load.data_modules.samplers:Of all batches, 120 were full and 0 were partial.
INFO:cell_load.data_modules.samplers:Sampler created with 120 batches in 0.01 seconds.
INFO:state._cli._tx._predict:Generating predictions on test set using manual loop...
StateTransitionPerturbationModel(
  (loss_fn): SamplesLoss()
  (pert_encoder): Sequential(
    (0): Linear(in_features=5120, out_features=672, bias=True)
    (1): GELU(approximate='none')
    (2): Dropout(p=0.1, inplace=False)
    (3): Linear(in_features=672, out_features=672, bias=True)
    (4): GELU(approximate='none')
    (5): Dropout(p=0.1, inplace=False)
    (6): Linear(in_features=672, out_features=672, bias=True)
    (7): GELU(approximate='none')
    (8): Dropout(p=0.1, inplace=False)
    (9): Linear(in_features=672, out_features=672, bias=True)
  )
  (basal_encoder): Linear(in_features=18080, out_features=672, bias=True)
  (transformer_backbone): LlamaBidirectionalModel(
    (embed_tokens): Embedding(32000, 672, padding_idx=0)
    (layers): ModuleList(
      (0-3): 4 x LlamaDecoderLayer(
        (self_attn): LlamaAttention(
          (q_proj): Linear(in_features=672, out_features=672, bias=False)
          (k_proj): Linear(in_features=672, out_features=672, bias=False)
          (v_proj): Linear(in_features=672, out_features=672, bias=False)
          (o_proj): Linear(in_features=672, out_features=672, bias=False)
        )
        (mlp): LlamaMLP(
          (gate_proj): Linear(in_features=672, out_features=2688, bias=False)
          (up_proj): Linear(in_features=672, out_features=2688, bias=False)
          (down_proj): Linear(in_features=2688, out_features=672, bias=False)
          (act_fn): SiLU()
        )
        (input_layernorm): LlamaRMSNorm((672,), eps=1e-06)
        (post_attention_layernorm): LlamaRMSNorm((672,), eps=1e-06)
      )
    )
    (norm): LlamaRMSNorm((672,), eps=1e-06)
    (rotary_emb): NoRoPE()
  )
  (project_out): Sequential(
    (0): Linear(in_features=672, out_features=672, bias=True)
    (1): GELU(approximate='none')
    (2): Dropout(p=0.1, inplace=False)
    (3): Linear(in_features=672, out_features=672, bias=True)
    (4): GELU(approximate='none')
    (5): Dropout(p=0.1, inplace=False)
    (6): Linear(in_features=672, out_features=672, bias=True)
    (7): GELU(approximate='none')
    (8): Dropout(p=0.1, inplace=False)
    (9): Linear(in_features=672, out_features=18080, bias=True)
  )
  (final_down_then_up): Sequential(
    (0): Linear(in_features=18080, out_features=2260, bias=True)
    (1): GELU(approximate='none')
    (2): Linear(in_features=2260, out_features=18080, bias=True)
  )
  (relu): ReLU()
)

Predicting:   0%|          | 0/120 [00:00<?, ?batch/s][AINFO:cell_load.data_modules.samplers:Of all batches, 120 were full and 0 were partial.

Predicting:   1%|          | 1/120 [00:00<01:13,  1.61batch/s][A
Predicting:   2%|▏         | 2/120 [00:00<00:38,  3.10batch/s][A
Predicting:   3%|▎         | 4/120 [00:01<00:29,  3.92batch/s][A
Predicting:   4%|▍         | 5/120 [00:01<00:31,  3.70batch/s][A
Predicting:   5%|▌         | 6/120 [00:01<00:25,  4.56batch/s][A
Predicting:   6%|▌         | 7/120 [00:01<00:24,  4.55batch/s][A
Predicting:   8%|▊         | 9/120 [00:02<00:20,  5.31batch/s][A
Predicting:   8%|▊         | 10/120 [00:02<00:19,  5.74batch/s][A
Predicting:   9%|▉         | 11/120 [00:02<00:23,  4.73batch/s][A
Predicting:  10%|█         | 12/120 [00:02<00:25,  4.19batch/s][A
Predicting:  11%|█         | 13/120 [00:03<00:28,  3.80batch/s][A
Predicting:  12%|█▏        | 14/120 [00:03<00:40,  2.62batch/s][A
Predicting:  12%|█▎        | 15/120 [00:04<00:34,  3.09batch/s][A
Predicting:  13%|█▎        | 16/120 [00:04<00:33,  3.12batch/s][A
Predicting:  14%|█▍        | 17/120 [00:04<00:30,  3.41batch/s][A
Predicting:  15%|█▌        | 18/120 [00:04<00:30,  3.30batch/s][A
Predicting:  16%|█▌        | 19/120 [00:05<00:30,  3.30batch/s][A
Predicting:  17%|█▋        | 20/120 [00:05<00:30,  3.30batch/s][A
Predicting:  18%|█▊        | 21/120 [00:05<00:25,  3.83batch/s][A
Predicting:  18%|█▊        | 22/120 [00:06<00:27,  3.52batch/s][A
Predicting:  20%|██        | 24/120 [00:06<00:19,  4.88batch/s][A
Predicting:  22%|██▏       | 26/120 [00:06<00:15,  6.07batch/s][A
Predicting:  22%|██▎       | 27/120 [00:06<00:14,  6.38batch/s][A
Predicting:  23%|██▎       | 28/120 [00:06<00:15,  5.85batch/s][A
Predicting:  24%|██▍       | 29/120 [00:07<00:18,  4.97batch/s][A
Predicting:  25%|██▌       | 30/120 [00:07<00:16,  5.49batch/s][A
Predicting:  26%|██▌       | 31/120 [00:07<00:17,  5.17batch/s][A
Predicting:  28%|██▊       | 33/120 [00:07<00:17,  5.06batch/s][A
Predicting:  28%|██▊       | 34/120 [00:08<00:16,  5.30batch/s][A
Predicting:  29%|██▉       | 35/120 [00:08<00:18,  4.60batch/s][A
Predicting:  30%|███       | 36/120 [00:08<00:20,  4.09batch/s][A
Predicting:  31%|███       | 37/120 [00:08<00:21,  3.95batch/s][A
Predicting:  32%|███▏      | 38/120 [00:09<00:21,  3.76batch/s][A
Predicting:  32%|███▎      | 39/120 [00:09<00:18,  4.47batch/s][A
Predicting:  33%|███▎      | 40/120 [00:09<00:15,  5.14batch/s][A
Predicting:  34%|███▍      | 41/120 [00:09<00:18,  4.33batch/s][A
Predicting:  35%|███▌      | 42/120 [00:10<00:20,  3.87batch/s][A
Predicting:  36%|███▌      | 43/120 [00:10<00:18,  4.12batch/s][A
Predicting:  37%|███▋      | 44/120 [00:10<00:20,  3.78batch/s][A
Predicting:  38%|███▊      | 45/120 [00:10<00:20,  3.64batch/s][A
Predicting:  38%|███▊      | 46/120 [00:11<00:21,  3.41batch/s][A
Predicting:  40%|████      | 48/120 [00:11<00:14,  4.98batch/s][A
Predicting:  41%|████      | 49/120 [00:11<00:13,  5.27batch/s][A
Predicting:  42%|████▏     | 50/120 [00:11<00:12,  5.72batch/s][A
Predicting:  42%|████▎     | 51/120 [00:11<00:11,  6.08batch/s][A
Predicting:  43%|████▎     | 52/120 [00:12<00:13,  4.94batch/s][A
Predicting:  44%|████▍     | 53/120 [00:12<00:13,  5.02batch/s][A
Predicting:  45%|████▌     | 54/120 [00:12<00:15,  4.23batch/s][A
Predicting:  46%|████▌     | 55/120 [00:12<00:14,  4.52batch/s][A
Predicting:  47%|████▋     | 56/120 [00:13<00:15,  4.15batch/s][A
Predicting:  48%|████▊     | 57/120 [00:13<00:16,  3.85batch/s][A
Predicting:  48%|████▊     | 58/120 [00:13<00:16,  3.65batch/s][A
Predicting:  49%|████▉     | 59/120 [00:13<00:14,  4.29batch/s][A
Predicting:  50%|█████     | 60/120 [00:14<00:12,  4.81batch/s][A
Predicting:  51%|█████     | 61/120 [00:14<00:10,  5.43batch/s][A
Predicting:  52%|█████▏    | 62/120 [00:14<00:12,  4.55batch/s][A
Predicting:  52%|█████▎    | 63/120 [00:14<00:10,  5.29batch/s][A
Predicting:  53%|█████▎    | 64/120 [00:14<00:09,  5.94batch/s][A
Predicting:  54%|█████▍    | 65/120 [00:15<00:11,  4.69batch/s][A
Predicting:  55%|█████▌    | 66/120 [00:15<00:13,  4.12batch/s][A
Predicting:  56%|█████▌    | 67/120 [00:15<00:14,  3.76batch/s][A
Predicting:  57%|█████▋    | 68/120 [00:15<00:11,  4.49batch/s][A
Predicting:  57%|█████▊    | 69/120 [00:16<00:12,  4.03batch/s][A
Predicting:  58%|█████▊    | 70/120 [00:16<00:10,  4.80batch/s][A
Predicting:  59%|█████▉    | 71/120 [00:16<00:10,  4.89batch/s][A
Predicting:  61%|██████    | 73/120 [00:16<00:09,  5.05batch/s][A
Predicting:  62%|██████▏   | 74/120 [00:17<00:10,  4.38batch/s][A
Predicting:  62%|██████▎   | 75/120 [00:17<00:11,  3.97batch/s][A
Predicting:  63%|██████▎   | 76/120 [00:17<00:09,  4.46batch/s][A
Predicting:  64%|██████▍   | 77/120 [00:17<00:10,  3.94batch/s][A
Predicting:  65%|██████▌   | 78/120 [00:18<00:11,  3.69batch/s][A
Predicting:  66%|██████▌   | 79/120 [00:18<00:11,  3.56batch/s][A
Predicting:  67%|██████▋   | 80/120 [00:18<00:11,  3.46batch/s][A
Predicting:  68%|██████▊   | 81/120 [00:18<00:09,  4.06batch/s][A
Predicting:  68%|██████▊   | 82/120 [00:19<00:08,  4.75batch/s][A
Predicting:  69%|██████▉   | 83/120 [00:19<00:08,  4.21batch/s][A
Predicting:  70%|███████   | 84/120 [00:19<00:09,  3.89batch/s][A
Predicting:  71%|███████   | 85/120 [00:19<00:07,  4.60batch/s][A
Predicting:  72%|███████▏  | 86/120 [00:19<00:06,  5.02batch/s][A
Predicting:  72%|███████▎  | 87/120 [00:20<00:07,  4.33batch/s][A
Predicting:  73%|███████▎  | 88/120 [00:20<00:06,  4.69batch/s][A
Predicting:  74%|███████▍  | 89/120 [00:20<00:05,  5.48batch/s][A
Predicting:  75%|███████▌  | 90/120 [00:20<00:06,  4.48batch/s][A
Predicting:  76%|███████▌  | 91/120 [00:20<00:05,  5.28batch/s][A
Predicting:  77%|███████▋  | 92/120 [00:21<00:06,  4.35batch/s][A
Predicting:  78%|███████▊  | 93/120 [00:21<00:05,  4.61batch/s][A
Predicting:  79%|███████▉  | 95/120 [00:21<00:04,  5.05batch/s][A
Predicting:  80%|████████  | 96/120 [00:22<00:05,  4.39batch/s][A
Predicting:  81%|████████  | 97/120 [00:22<00:05,  3.94batch/s][A
Predicting:  82%|████████▏ | 98/120 [00:22<00:05,  3.74batch/s][A
Predicting:  82%|████████▎ | 99/120 [00:23<00:05,  3.51batch/s][A
Predicting:  83%|████████▎ | 100/120 [00:23<00:05,  3.60batch/s][A
Predicting:  84%|████████▍ | 101/120 [00:23<00:05,  3.52batch/s][A
Predicting:  85%|████████▌ | 102/120 [00:24<00:05,  3.39batch/s][A
Predicting:  86%|████████▌ | 103/120 [00:24<00:04,  3.97batch/s][A
Predicting:  87%|████████▋ | 104/120 [00:24<00:03,  4.33batch/s][A
Predicting:  88%|████████▊ | 105/120 [00:24<00:03,  3.97batch/s][A
Predicting:  88%|████████▊ | 106/120 [00:24<00:03,  4.36batch/s][A
Predicting:  89%|████████▉ | 107/120 [00:25<00:02,  4.58batch/s][A
Predicting:  90%|█████████ | 108/120 [00:25<00:02,  4.58batch/s][A
Predicting:  91%|█████████ | 109/120 [00:25<00:02,  4.06batch/s][A
Predicting:  92%|█████████▏| 110/120 [00:25<00:02,  3.80batch/s][A
Predicting:  92%|█████████▎| 111/120 [00:26<00:02,  4.15batch/s][A
Predicting:  93%|█████████▎| 112/120 [00:26<00:02,  3.67batch/s][A
Predicting:  94%|█████████▍| 113/120 [00:26<00:01,  3.93batch/s][A
Predicting:  95%|█████████▌| 114/120 [00:26<00:01,  4.35batch/s][A
Predicting:  96%|█████████▌| 115/120 [00:26<00:01,  4.89batch/s][A
Predicting:  97%|█████████▋| 116/120 [00:27<00:00,  5.38batch/s][A
Predicting:  98%|█████████▊| 118/120 [00:27<00:00,  6.94batch/s][A
Predicting:  99%|█████████▉| 119/120 [00:27<00:00,  7.38batch/s][A
Predicting: 100%|██████████| 120/120 [00:27<00:00,  5.80batch/s][APredicting: 100%|██████████| 120/120 [00:27<00:00,  4.31batch/s]
INFO:state._cli._tx._predict:Creating anndatas from predictions from manual loop...
... storing 'target_gene' as categorical
... storing 'cell_type' as categorical
... storing 'batch_var' as categorical
... storing 'ctrl_cell_barcode' as categorical
... storing 'target_gene' as categorical
... storing 'cell_type' as categorical
... storing 'batch_var' as categorical
... storing 'ctrl_cell_barcode' as categorical
INFO:state._cli._tx._predict:Saved adata_pred to competition/sm_trainer_test/eval_temp_eval_checkpoint.ckpt/adata_pred.h5ad
INFO:state._cli._tx._predict:Saved adata_real to competition/sm_trainer_test/eval_temp_eval_checkpoint.ckpt/adata_real.h5ad
INFO:state._cli._tx._predict:Computing metrics using cell-eval...
WARNING:cell_eval._evaluator:Output directory competition/sm_trainer_test/eval_temp_eval_checkpoint.ckpt already exists, potential overwrite occurring
INFO:cell_eval._evaluator:Input is found to be log-normalized already - skipping transformation.
INFO:cell_eval._evaluator:Input is found to be log-normalized already - skipping transformation.
INFO:cell_eval._evaluator:Computing DE for real data
INFO:pdex._single_cell:Precomputing masks for each target gene

Identifying target masks:   0%|          | 0/69 [00:00<?, ?it/s][AIdentifying target masks: 100%|██████████| 69/69 [00:00<00:00, 27248.56it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature

Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s][AIdentifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 6772619.12it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=1247520
INFO:pdex._single_cell:Creating generator of all batches: N=610
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches

Processing batches:   0%|          | 0/610 [00:00<?, ?it/s][A
Processing batches:   1%|▏         | 9/610 [00:00<00:34, 17.35it/s][A
Processing batches:   2%|▏         | 11/610 [00:02<02:52,  3.47it/s][A
Processing batches:   2%|▏         | 13/610 [00:03<02:46,  3.59it/s][A
Processing batches:   3%|▎         | 17/610 [00:03<01:41,  5.83it/s][A
Processing batches:   4%|▎         | 22/610 [00:04<02:24,  4.07it/s][A
Processing batches:   5%|▍         | 28/610 [00:05<01:29,  6.53it/s][A
Processing batches:   5%|▌         | 31/610 [00:05<01:33,  6.20it/s][A
Processing batches:   6%|▌         | 34/610 [00:07<02:29,  3.86it/s][A
Processing batches:   7%|▋         | 40/610 [00:07<01:30,  6.31it/s][A
Processing batches:   7%|▋         | 43/610 [00:07<01:36,  5.88it/s][A
Processing batches:   8%|▊         | 46/610 [00:09<02:28,  3.81it/s][A
Processing batches:   8%|▊         | 51/610 [00:09<01:37,  5.75it/s][A
Processing batches:   9%|▉         | 54/610 [00:10<01:40,  5.56it/s][A
Processing batches:   9%|▉         | 57/610 [00:10<01:19,  6.92it/s][A
Processing batches:  10%|▉         | 59/610 [00:11<02:26,  3.76it/s][A
Processing batches:  10%|█         | 63/610 [00:12<01:39,  5.47it/s][A
Processing batches:  11%|█         | 65/610 [00:12<01:38,  5.55it/s][A
Processing batches:  11%|█         | 67/610 [00:12<01:35,  5.70it/s][A
Processing batches:  11%|█▏        | 69/610 [00:12<01:18,  6.89it/s][A
Processing batches:  12%|█▏        | 71/610 [00:14<02:39,  3.37it/s][A
Processing batches:  12%|█▏        | 75/610 [00:14<01:38,  5.44it/s][A
Processing batches:  13%|█▎        | 77/610 [00:14<01:40,  5.31it/s][A
Processing batches:  13%|█▎        | 79/610 [00:15<01:35,  5.58it/s][A
Processing batches:  13%|█▎        | 81/610 [00:15<01:19,  6.64it/s][A
Processing batches:  14%|█▎        | 83/610 [00:16<02:39,  3.31it/s][A
Processing batches:  14%|█▍        | 87/610 [00:16<01:36,  5.44it/s][A
Processing batches:  15%|█▍        | 89/610 [00:17<01:38,  5.30it/s][A
Processing batches:  15%|█▍        | 91/610 [00:18<02:14,  3.85it/s][A
Processing batches:  15%|█▌        | 94/610 [00:18<02:11,  3.92it/s][A
Processing batches:  16%|█▌        | 95/610 [00:19<02:09,  3.97it/s][A
Processing batches:  16%|█▌        | 98/610 [00:19<01:29,  5.69it/s][A
Processing batches:  17%|█▋        | 101/610 [00:19<01:29,  5.68it/s][A
Processing batches:  17%|█▋        | 102/610 [00:20<01:41,  5.02it/s][A
Processing batches:  17%|█▋        | 104/610 [00:20<02:03,  4.10it/s][A
Processing batches:  17%|█▋        | 106/610 [00:21<02:11,  3.84it/s][A
Processing batches:  18%|█▊        | 110/610 [00:21<01:21,  6.14it/s][A
Processing batches:  18%|█▊        | 111/610 [00:21<01:17,  6.42it/s][A
Processing batches:  19%|█▊        | 113/610 [00:22<01:31,  5.40it/s][A
Processing batches:  19%|█▊        | 114/610 [00:22<01:37,  5.06it/s][A
Processing batches:  19%|█▉        | 116/610 [00:23<01:59,  4.12it/s][A
Processing batches:  19%|█▉        | 118/610 [00:24<02:23,  3.43it/s][A
Processing batches:  20%|██        | 122/610 [00:24<01:20,  6.07it/s][A
Processing batches:  20%|██        | 125/610 [00:24<01:26,  5.60it/s][A
Processing batches:  21%|██        | 127/610 [00:25<01:29,  5.37it/s][A
Processing batches:  21%|██        | 128/610 [00:25<02:02,  3.93it/s][A
Processing batches:  21%|██▏       | 130/610 [00:26<02:01,  3.95it/s][A
Processing batches:  22%|██▏       | 134/610 [00:26<01:14,  6.41it/s][A
Processing batches:  22%|██▏       | 136/610 [00:26<01:01,  7.66it/s][A
Processing batches:  23%|██▎       | 138/610 [00:27<01:38,  4.80it/s][A
Processing batches:  23%|██▎       | 140/610 [00:28<02:01,  3.87it/s][A
Processing batches:  23%|██▎       | 142/610 [00:28<01:56,  4.03it/s][A
Processing batches:  24%|██▍       | 146/610 [00:28<01:12,  6.42it/s][A
Processing batches:  24%|██▍       | 148/610 [00:29<01:03,  7.32it/s][A
Processing batches:  25%|██▍       | 150/610 [00:29<01:33,  4.92it/s][A
Processing batches:  25%|██▍       | 151/610 [00:30<01:54,  4.00it/s][A
Processing batches:  25%|██▍       | 152/610 [00:31<02:53,  2.64it/s][A
Processing batches:  25%|██▌       | 155/610 [00:31<02:17,  3.30it/s][A
Processing batches:  27%|██▋       | 162/610 [00:32<01:07,  6.68it/s][A
Processing batches:  27%|██▋       | 164/610 [00:33<01:41,  4.41it/s][A
Processing batches:  27%|██▋       | 165/610 [00:33<01:38,  4.53it/s][A
Processing batches:  27%|██▋       | 166/610 [00:33<01:32,  4.82it/s][A
Processing batches:  28%|██▊       | 168/610 [00:33<01:27,  5.06it/s][A
Processing batches:  28%|██▊       | 171/610 [00:34<01:24,  5.21it/s][A
Processing batches:  29%|██▊       | 174/610 [00:34<01:02,  7.03it/s][A
Processing batches:  29%|██▉       | 176/610 [00:35<01:43,  4.19it/s][A
Processing batches:  29%|██▉       | 177/610 [00:35<01:37,  4.45it/s][A
Processing batches:  30%|██▉       | 180/610 [00:36<01:13,  5.86it/s][A
Processing batches:  30%|██▉       | 182/610 [00:36<01:07,  6.37it/s][A
Processing batches:  30%|███       | 183/610 [00:36<01:21,  5.25it/s][A
Processing batches:  30%|███       | 184/610 [00:36<01:22,  5.18it/s][A
Processing batches:  30%|███       | 186/610 [00:37<01:00,  6.97it/s][A
Processing batches:  31%|███       | 188/610 [00:38<02:20,  3.00it/s][A
Processing batches:  32%|███▏      | 193/610 [00:38<01:09,  6.00it/s][A
Processing batches:  32%|███▏      | 195/610 [00:39<01:15,  5.47it/s][A
Processing batches:  32%|███▏      | 197/610 [00:39<01:09,  5.92it/s][A
Processing batches:  33%|███▎      | 199/610 [00:40<01:42,  4.01it/s][A
Processing batches:  33%|███▎      | 200/610 [00:40<01:45,  3.87it/s][A
Processing batches:  33%|███▎      | 201/610 [00:40<01:52,  3.65it/s][A
Processing batches:  34%|███▍      | 206/610 [00:41<00:56,  7.18it/s][A
Processing batches:  34%|███▍      | 208/610 [00:41<01:09,  5.79it/s][A
Processing batches:  34%|███▍      | 210/610 [00:41<00:57,  6.91it/s][A
Processing batches:  35%|███▍      | 212/610 [00:42<01:45,  3.77it/s][A
Processing batches:  35%|███▍      | 213/610 [00:43<01:43,  3.83it/s][A
Processing batches:  35%|███▌      | 214/610 [00:43<01:33,  4.25it/s][A
Processing batches:  36%|███▌      | 218/610 [00:43<00:53,  7.28it/s][A
Processing batches:  36%|███▌      | 220/610 [00:44<01:06,  5.91it/s][A
Processing batches:  36%|███▋      | 222/610 [00:44<00:56,  6.89it/s][A
Processing batches:  37%|███▋      | 224/610 [00:45<01:43,  3.72it/s][A
Processing batches:  37%|███▋      | 225/610 [00:45<01:39,  3.88it/s][A
Processing batches:  37%|███▋      | 226/610 [00:45<01:28,  4.36it/s][A
Processing batches:  37%|███▋      | 228/610 [00:45<01:05,  5.80it/s][A
Processing batches:  38%|███▊      | 231/610 [00:46<01:02,  6.05it/s][A
Processing batches:  38%|███▊      | 232/610 [00:46<01:00,  6.24it/s][A
Processing batches:  38%|███▊      | 234/610 [00:46<00:49,  7.65it/s][A
Processing batches:  39%|███▊      | 236/610 [00:47<01:47,  3.48it/s][A
Processing batches:  39%|███▉      | 237/610 [00:47<01:41,  3.69it/s][A
Processing batches:  39%|███▉      | 240/610 [00:48<01:03,  5.80it/s][A
Processing batches:  40%|███▉      | 242/610 [00:48<00:50,  7.28it/s][A
Processing batches:  40%|████      | 244/610 [00:48<01:05,  5.55it/s][A
Processing batches:  40%|████      | 246/610 [00:48<00:54,  6.62it/s][A
Processing batches:  41%|████      | 248/610 [00:50<01:42,  3.53it/s][A
Processing batches:  41%|████      | 249/610 [00:50<01:37,  3.68it/s][A
Processing batches:  41%|████▏     | 252/610 [00:50<01:02,  5.73it/s][A
Processing batches:  42%|████▏     | 254/610 [00:50<00:54,  6.59it/s][A
Processing batches:  42%|████▏     | 256/610 [00:51<01:03,  5.58it/s][A
Processing batches:  42%|████▏     | 258/610 [00:51<00:55,  6.32it/s][A
Processing batches:  42%|████▏     | 259/610 [00:52<01:27,  4.00it/s][A
Processing batches:  43%|████▎     | 260/610 [00:52<01:39,  3.53it/s][A
Processing batches:  43%|████▎     | 261/610 [00:52<01:34,  3.69it/s][A
Processing batches:  43%|████▎     | 263/610 [00:52<01:07,  5.17it/s][A
Processing batches:  43%|████▎     | 265/610 [00:53<00:52,  6.55it/s][A
Processing batches:  44%|████▍     | 267/610 [00:53<00:58,  5.90it/s][A
Processing batches:  44%|████▍     | 268/610 [00:53<00:55,  6.12it/s][A
Processing batches:  44%|████▍     | 270/610 [00:53<00:48,  7.01it/s][A
Processing batches:  44%|████▍     | 271/610 [00:54<01:25,  3.94it/s][A
Processing batches:  45%|████▍     | 272/610 [00:54<01:40,  3.36it/s][A
Processing batches:  45%|████▍     | 273/610 [00:55<01:30,  3.73it/s][A
Processing batches:  45%|████▌     | 275/610 [00:55<01:06,  5.07it/s][A
Processing batches:  45%|████▌     | 277/610 [00:55<00:51,  6.49it/s][A
Processing batches:  46%|████▌     | 279/610 [00:55<00:53,  6.24it/s][A
Processing batches:  46%|████▌     | 280/610 [00:56<00:57,  5.76it/s][A
Processing batches:  46%|████▌     | 282/610 [00:56<00:44,  7.35it/s][A
Processing batches:  46%|████▋     | 283/610 [00:56<01:20,  4.07it/s][A
Processing batches:  47%|████▋     | 284/610 [00:57<01:35,  3.42it/s][A
Processing batches:  47%|████▋     | 285/610 [00:57<01:25,  3.79it/s][A
Processing batches:  47%|████▋     | 287/610 [00:58<01:30,  3.56it/s][A
Processing batches:  48%|████▊     | 292/610 [00:58<00:45,  6.97it/s][A
Processing batches:  48%|████▊     | 293/610 [00:58<00:46,  6.80it/s][A
Processing batches:  48%|████▊     | 295/610 [00:59<01:05,  4.83it/s][A
Processing batches:  49%|████▊     | 296/610 [00:59<01:18,  4.02it/s][A
Processing batches:  49%|████▊     | 297/610 [00:59<01:12,  4.32it/s][A
Processing batches:  49%|████▉     | 298/610 [00:59<01:04,  4.87it/s][A
Processing batches:  49%|████▉     | 299/610 [01:00<01:19,  3.93it/s][A
Processing batches:  49%|████▉     | 300/610 [01:00<01:42,  3.03it/s][A
Processing batches:  49%|████▉     | 301/610 [01:00<01:23,  3.70it/s][A
Processing batches:  50%|█████     | 307/610 [01:01<00:45,  6.63it/s][A
Processing batches:  50%|█████     | 308/610 [01:01<00:57,  5.27it/s][A
Processing batches:  51%|█████     | 309/610 [01:02<00:55,  5.42it/s][A
Processing batches:  51%|█████     | 310/610 [01:02<00:52,  5.68it/s][A
Processing batches:  51%|█████     | 311/610 [01:03<01:51,  2.67it/s][A
Processing batches:  52%|█████▏    | 315/610 [01:03<01:03,  4.64it/s][A
Processing batches:  52%|█████▏    | 319/610 [01:03<00:41,  7.05it/s][A
Processing batches:  53%|█████▎    | 321/610 [01:04<00:52,  5.53it/s][A
Processing batches:  53%|█████▎    | 322/610 [01:04<00:49,  5.84it/s][A
Processing batches:  53%|█████▎    | 323/610 [01:05<01:08,  4.18it/s][A
Processing batches:  53%|█████▎    | 324/610 [01:05<01:05,  4.35it/s][A
Processing batches:  53%|█████▎    | 325/610 [01:05<01:05,  4.37it/s][A
Processing batches:  54%|█████▎    | 327/610 [01:05<00:51,  5.51it/s][A
Processing batches:  54%|█████▍    | 328/610 [01:06<01:02,  4.52it/s][A
Processing batches:  54%|█████▍    | 332/610 [01:06<00:43,  6.42it/s][A
Processing batches:  55%|█████▍    | 333/610 [01:06<00:50,  5.45it/s][A
Processing batches:  55%|█████▍    | 334/610 [01:07<00:47,  5.85it/s][A
Processing batches:  55%|█████▍    | 335/610 [01:07<01:07,  4.06it/s][A
Processing batches:  55%|█████▌    | 336/610 [01:07<01:02,  4.39it/s][A
Processing batches:  55%|█████▌    | 337/610 [01:08<01:07,  4.07it/s][A
Processing batches:  56%|█████▌    | 339/610 [01:08<00:49,  5.46it/s][A
Processing batches:  56%|█████▌    | 340/610 [01:08<01:02,  4.32it/s][A
Processing batches:  56%|█████▌    | 343/610 [01:08<00:37,  7.10it/s][A
Processing batches:  56%|█████▋    | 344/610 [01:08<00:38,  6.99it/s][A
Processing batches:  57%|█████▋    | 345/610 [01:09<00:51,  5.15it/s][A
Processing batches:  57%|█████▋    | 346/610 [01:09<00:50,  5.26it/s][A
Processing batches:  57%|█████▋    | 347/610 [01:09<01:05,  4.04it/s][A
Processing batches:  57%|█████▋    | 348/610 [01:10<01:03,  4.09it/s][A
Processing batches:  57%|█████▋    | 349/610 [01:10<01:08,  3.83it/s][A
Processing batches:  58%|█████▊    | 351/610 [01:10<00:51,  5.03it/s][A
Processing batches:  58%|█████▊    | 352/610 [01:11<01:00,  4.29it/s][A
Processing batches:  58%|█████▊    | 355/610 [01:11<00:37,  6.73it/s][A
Processing batches:  59%|█████▊    | 357/610 [01:11<00:43,  5.87it/s][A
Processing batches:  59%|█████▊    | 358/610 [01:11<00:43,  5.75it/s][A
Processing batches:  59%|█████▉    | 359/610 [01:12<00:58,  4.30it/s][A
Processing batches:  59%|█████▉    | 360/610 [01:12<00:58,  4.28it/s][A
Processing batches:  59%|█████▉    | 361/610 [01:12<01:01,  4.05it/s][A
Processing batches:  60%|█████▉    | 363/610 [01:13<00:50,  4.92it/s][A
Processing batches:  60%|█████▉    | 364/610 [01:13<00:55,  4.44it/s][A
Processing batches:  60%|██████    | 367/610 [01:13<00:36,  6.62it/s][A
Processing batches:  60%|██████    | 369/610 [01:14<00:41,  5.82it/s][A
Processing batches:  61%|██████    | 370/610 [01:14<00:41,  5.73it/s][A
Processing batches:  61%|██████    | 371/610 [01:14<00:52,  4.53it/s][A
Processing batches:  61%|██████    | 372/610 [01:14<00:53,  4.41it/s][A
Processing batches:  61%|██████    | 373/610 [01:15<00:56,  4.16it/s][A
Processing batches:  61%|██████▏   | 375/610 [01:15<00:48,  4.86it/s][A
Processing batches:  62%|██████▏   | 376/610 [01:15<00:49,  4.70it/s][A
Processing batches:  62%|██████▏   | 377/610 [01:15<00:46,  5.01it/s][A
Processing batches:  62%|██████▏   | 379/610 [01:16<00:33,  6.80it/s][A
Processing batches:  62%|██████▏   | 381/610 [01:16<00:37,  6.05it/s][A
Processing batches:  63%|██████▎   | 382/610 [01:16<00:37,  6.10it/s][A
Processing batches:  63%|██████▎   | 383/610 [01:17<00:51,  4.44it/s][A
Processing batches:  63%|██████▎   | 384/610 [01:17<01:19,  2.84it/s][A
Processing batches:  63%|██████▎   | 387/610 [01:17<00:44,  5.00it/s][A
Processing batches:  64%|██████▎   | 388/610 [01:18<00:41,  5.40it/s][A
Processing batches:  64%|██████▍   | 389/610 [01:18<00:41,  5.35it/s][A
Processing batches:  64%|██████▍   | 392/610 [01:18<00:27,  7.87it/s][A
Processing batches:  64%|██████▍   | 393/610 [01:18<00:40,  5.35it/s][A
Processing batches:  65%|██████▍   | 395/610 [01:19<00:46,  4.64it/s][A
Processing batches:  65%|██████▍   | 396/610 [01:19<00:52,  4.07it/s][A
Processing batches:  65%|██████▌   | 397/610 [01:20<00:59,  3.56it/s][A
Processing batches:  65%|██████▌   | 399/610 [01:20<00:43,  4.84it/s][A
Processing batches:  66%|██████▌   | 401/610 [01:20<00:37,  5.50it/s][A
Processing batches:  66%|██████▌   | 403/610 [01:20<00:28,  7.26it/s][A
Processing batches:  66%|██████▋   | 405/610 [01:21<00:37,  5.51it/s][A
Processing batches:  67%|██████▋   | 407/610 [01:21<00:41,  4.92it/s][A
Processing batches:  67%|██████▋   | 408/610 [01:22<00:47,  4.22it/s][A
Processing batches:  67%|██████▋   | 409/610 [01:22<00:51,  3.92it/s][A
Processing batches:  67%|██████▋   | 411/610 [01:22<00:42,  4.74it/s][A
Processing batches:  68%|██████▊   | 413/610 [01:23<00:37,  5.22it/s][A
Processing batches:  68%|██████▊   | 416/610 [01:23<00:27,  6.94it/s][A
Processing batches:  68%|██████▊   | 417/610 [01:23<00:34,  5.56it/s][A
Processing batches:  69%|██████▊   | 419/610 [01:24<00:38,  4.96it/s][A
Processing batches:  69%|██████▉   | 420/610 [01:24<00:45,  4.22it/s][A
Processing batches:  69%|██████▉   | 421/610 [01:24<00:49,  3.83it/s][A
Processing batches:  69%|██████▉   | 422/610 [01:25<00:42,  4.44it/s][A
Processing batches:  69%|██████▉   | 423/610 [01:25<00:38,  4.86it/s][A
Processing batches:  70%|██████▉   | 425/610 [01:25<00:34,  5.38it/s][A
Processing batches:  70%|███████   | 427/610 [01:25<00:25,  7.32it/s][A
Processing batches:  70%|███████   | 428/610 [01:25<00:28,  6.32it/s][A
Processing batches:  70%|███████   | 429/610 [01:26<00:31,  5.76it/s][A
Processing batches:  71%|███████   | 431/610 [01:26<00:39,  4.53it/s][A
Processing batches:  71%|███████   | 432/610 [01:26<00:43,  4.12it/s][A
Processing batches:  71%|███████   | 433/610 [01:27<00:47,  3.73it/s][A
Processing batches:  71%|███████   | 434/610 [01:27<00:40,  4.31it/s][A
Processing batches:  71%|███████▏  | 435/610 [01:27<00:35,  4.89it/s][A
Processing batches:  71%|███████▏  | 436/610 [01:27<00:31,  5.59it/s][A
Processing batches:  72%|███████▏  | 437/610 [01:27<00:30,  5.69it/s][A
Processing batches:  72%|███████▏  | 439/610 [01:28<00:23,  7.23it/s][A
Processing batches:  72%|███████▏  | 440/610 [01:28<00:29,  5.79it/s][A
Processing batches:  72%|███████▏  | 441/610 [01:28<00:27,  6.24it/s][A
Processing batches:  73%|███████▎  | 443/610 [01:29<00:37,  4.44it/s][A
Processing batches:  73%|███████▎  | 444/610 [01:29<00:40,  4.11it/s][A
Processing batches:  73%|███████▎  | 445/610 [01:29<00:43,  3.79it/s][A
Processing batches:  73%|███████▎  | 446/610 [01:29<00:40,  4.05it/s][A
Processing batches:  73%|███████▎  | 448/610 [01:30<00:40,  3.96it/s][A
Processing batches:  74%|███████▍  | 450/610 [01:30<00:33,  4.82it/s][A
Processing batches:  74%|███████▍  | 451/610 [01:30<00:30,  5.23it/s][A
Processing batches:  74%|███████▍  | 452/610 [01:31<00:41,  3.83it/s][A
Processing batches:  75%|███████▍  | 455/610 [01:31<00:24,  6.33it/s][A
Processing batches:  75%|███████▍  | 456/610 [01:31<00:28,  5.36it/s][A
Processing batches:  75%|███████▍  | 457/610 [01:32<00:50,  3.06it/s][A
Processing batches:  76%|███████▌  | 461/610 [01:33<00:40,  3.70it/s][A
Processing batches:  76%|███████▌  | 462/610 [01:33<00:37,  3.96it/s][A
Processing batches:  76%|███████▋  | 466/610 [01:34<00:26,  5.50it/s][A
Processing batches:  77%|███████▋  | 469/610 [01:34<00:26,  5.38it/s][A
Processing batches:  77%|███████▋  | 471/610 [01:35<00:25,  5.37it/s][A
Processing batches:  78%|███████▊  | 473/610 [01:35<00:28,  4.84it/s][A
Processing batches:  78%|███████▊  | 475/610 [01:35<00:22,  5.88it/s][A
Processing batches:  78%|███████▊  | 476/610 [01:35<00:23,  5.72it/s][A
Processing batches:  78%|███████▊  | 477/610 [01:36<00:22,  5.83it/s][A
Processing batches:  78%|███████▊  | 478/610 [01:36<00:22,  5.76it/s][A
Processing batches:  79%|███████▊  | 479/610 [01:36<00:24,  5.32it/s][A
Processing batches:  79%|███████▉  | 481/610 [01:37<00:28,  4.57it/s][A
Processing batches:  79%|███████▉  | 483/610 [01:37<00:26,  4.87it/s][A
Processing batches:  79%|███████▉  | 484/610 [01:37<00:23,  5.25it/s][A
Processing batches:  80%|███████▉  | 485/610 [01:37<00:31,  3.99it/s][A
Processing batches:  80%|███████▉  | 487/610 [01:38<00:32,  3.80it/s][A
Processing batches:  80%|████████  | 490/610 [01:38<00:19,  6.28it/s][A
Processing batches:  81%|████████  | 492/610 [01:38<00:18,  6.55it/s][A
Processing batches:  81%|████████  | 494/610 [01:39<00:21,  5.44it/s][A
Processing batches:  81%|████████  | 495/610 [01:39<00:23,  4.82it/s][A
Processing batches:  81%|████████▏ | 496/610 [01:39<00:23,  4.82it/s][A
Processing batches:  81%|████████▏ | 497/610 [01:40<00:26,  4.23it/s][A
Processing batches:  82%|████████▏ | 499/610 [01:40<00:23,  4.80it/s][A
Processing batches:  82%|████████▏ | 500/610 [01:40<00:26,  4.12it/s][A
Processing batches:  82%|████████▏ | 503/610 [01:41<00:17,  6.03it/s][A
Processing batches:  83%|████████▎ | 505/610 [01:41<00:21,  4.87it/s][A
Processing batches:  83%|████████▎ | 507/610 [01:42<00:19,  5.40it/s][A
Processing batches:  83%|████████▎ | 508/610 [01:42<00:20,  5.09it/s][A
Processing batches:  83%|████████▎ | 509/610 [01:42<00:22,  4.42it/s][A
Processing batches:  84%|████████▍ | 511/610 [01:43<00:20,  4.86it/s][A
Processing batches:  84%|████████▍ | 512/610 [01:43<00:21,  4.46it/s][A
Processing batches:  84%|████████▍ | 513/610 [01:43<00:19,  4.93it/s][A
Processing batches:  84%|████████▍ | 515/610 [01:43<00:15,  6.26it/s][A
Processing batches:  85%|████████▍ | 517/610 [01:44<00:18,  5.11it/s][A
Processing batches:  85%|████████▌ | 519/610 [01:44<00:17,  5.25it/s][A
Processing batches:  85%|████████▌ | 520/610 [01:44<00:17,  5.08it/s][A
Processing batches:  85%|████████▌ | 521/610 [01:45<00:20,  4.41it/s][A
Processing batches:  86%|████████▌ | 523/610 [01:45<00:18,  4.79it/s][A
Processing batches:  86%|████████▌ | 524/610 [01:45<00:19,  4.52it/s][A
Processing batches:  86%|████████▌ | 525/610 [01:45<00:18,  4.63it/s][A
Processing batches:  86%|████████▋ | 527/610 [01:46<00:12,  6.65it/s][A
Processing batches:  87%|████████▋ | 528/610 [01:46<00:11,  7.04it/s][A
Processing batches:  87%|████████▋ | 529/610 [01:46<00:16,  4.94it/s][A
Processing batches:  87%|████████▋ | 531/610 [01:46<00:14,  5.27it/s][A
Processing batches:  87%|████████▋ | 532/610 [01:47<00:15,  4.91it/s][A
Processing batches:  87%|████████▋ | 533/610 [01:47<00:18,  4.15it/s][A
Processing batches:  88%|████████▊ | 535/610 [01:47<00:15,  4.72it/s][A
Processing batches:  88%|████████▊ | 536/610 [01:48<00:17,  4.31it/s][A
Processing batches:  88%|████████▊ | 537/610 [01:48<00:15,  4.67it/s][A
Processing batches:  88%|████████▊ | 539/610 [01:48<00:10,  6.54it/s][A
Processing batches:  89%|████████▊ | 540/610 [01:48<00:10,  6.57it/s][A
Processing batches:  89%|████████▊ | 541/610 [01:48<00:13,  5.08it/s][A
Processing batches:  89%|████████▉ | 542/610 [01:49<00:12,  5.56it/s][A
Processing batches:  89%|████████▉ | 543/610 [01:49<00:12,  5.23it/s][A
Processing batches:  89%|████████▉ | 544/610 [01:49<00:13,  4.82it/s][A
Processing batches:  89%|████████▉ | 545/610 [01:49<00:17,  3.75it/s][A
Processing batches:  90%|████████▉ | 547/610 [01:50<00:13,  4.69it/s][A
Processing batches:  90%|████████▉ | 548/610 [01:50<00:14,  4.18it/s][A
Processing batches:  90%|█████████ | 549/610 [01:50<00:13,  4.44it/s][A
Processing batches:  90%|█████████ | 552/610 [01:50<00:08,  6.55it/s][A
Processing batches:  91%|█████████ | 553/610 [01:51<00:10,  5.40it/s][A
Processing batches:  91%|█████████ | 554/610 [01:51<00:09,  5.62it/s][A
Processing batches:  91%|█████████ | 555/610 [01:51<00:10,  5.47it/s][A
Processing batches:  91%|█████████ | 556/610 [01:51<00:10,  5.36it/s][A
Processing batches:  91%|█████████▏| 557/610 [01:52<00:13,  3.99it/s][A
Processing batches:  92%|█████████▏| 559/610 [01:52<00:10,  4.86it/s][A
Processing batches:  92%|█████████▏| 560/610 [01:52<00:12,  3.94it/s][A
Processing batches:  92%|█████████▏| 561/610 [01:53<00:10,  4.61it/s][A
Processing batches:  92%|█████████▏| 563/610 [01:53<00:07,  6.58it/s][A
Processing batches:  92%|█████████▏| 564/610 [01:53<00:07,  6.41it/s][A
Processing batches:  93%|█████████▎| 565/610 [01:53<00:08,  5.47it/s][A
Processing batches:  93%|█████████▎| 566/610 [01:53<00:07,  5.50it/s][A
Processing batches:  93%|█████████▎| 567/610 [01:54<00:08,  5.08it/s][A
Processing batches:  93%|█████████▎| 568/610 [01:54<00:08,  5.15it/s][A
Processing batches:  93%|█████████▎| 569/610 [01:54<00:10,  3.95it/s][A
Processing batches:  94%|█████████▎| 571/610 [01:54<00:08,  4.84it/s][A
Processing batches:  94%|█████████▍| 572/610 [01:55<00:10,  3.80it/s][A
Processing batches:  94%|█████████▍| 573/610 [01:55<00:08,  4.51it/s][A
Processing batches:  94%|█████████▍| 574/610 [01:55<00:07,  5.09it/s][A
Processing batches:  94%|█████████▍| 576/610 [01:55<00:04,  6.87it/s][A
Processing batches:  95%|█████████▍| 577/610 [01:55<00:05,  6.16it/s][A
Processing batches:  95%|█████████▍| 578/610 [01:56<00:05,  5.69it/s][A
Processing batches:  95%|█████████▍| 579/610 [01:56<00:05,  5.51it/s][A
Processing batches:  95%|█████████▌| 580/610 [01:56<00:06,  4.95it/s][A
Processing batches:  95%|█████████▌| 581/610 [01:57<00:07,  3.87it/s][A
Processing batches:  96%|█████████▌| 583/610 [01:57<00:05,  5.14it/s][A
Processing batches:  96%|█████████▌| 584/610 [01:57<00:06,  3.78it/s][A
Processing batches:  96%|█████████▌| 586/610 [01:57<00:04,  5.20it/s][A
Processing batches:  96%|█████████▋| 588/610 [01:58<00:05,  4.04it/s][A
Processing batches:  97%|█████████▋| 592/610 [01:59<00:03,  5.83it/s][A
Processing batches:  97%|█████████▋| 593/610 [01:59<00:03,  4.88it/s][A
Processing batches:  98%|█████████▊| 595/610 [01:59<00:02,  5.74it/s][A
Processing batches:  98%|█████████▊| 596/610 [02:00<00:03,  3.51it/s][A
Processing batches:  98%|█████████▊| 599/610 [02:00<00:02,  4.55it/s][A
Processing batches:  99%|█████████▊| 601/610 [02:01<00:02,  4.45it/s][A
Processing batches:  99%|█████████▉| 604/610 [02:01<00:01,  5.79it/s][A
Processing batches: 100%|█████████▉| 607/610 [02:01<00:00,  7.07it/s][A
Processing batches: 100%|█████████▉| 608/610 [02:01<00:00,  6.63it/s][AProcessing batches: 100%|██████████| 610/610 [02:02<00:00,  5.00it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:cell_eval._evaluator:Writing real DE results to: hepg2_real_de.csv
INFO:cell_eval._evaluator:Computing DE for pred data
INFO:pdex._single_cell:Precomputing masks for each target gene

Identifying target masks:   0%|          | 0/69 [00:00<?, ?it/s][AIdentifying target masks: 100%|██████████| 69/69 [00:00<00:00, 24486.59it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature

Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s][AIdentifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 5752770.17it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=1247520
INFO:pdex._single_cell:Creating generator of all batches: N=610
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches

Processing batches:   0%|          | 0/610 [00:00<?, ?it/s][A
Processing batches:   1%|▏         | 9/610 [00:00<00:36, 16.46it/s][A
Processing batches:   2%|▏         | 11/610 [00:02<03:22,  2.96it/s][A
Processing batches:   3%|▎         | 21/610 [00:03<01:26,  6.81it/s][A
Processing batches:   4%|▍         | 23/610 [00:05<02:57,  3.31it/s][A
Processing batches:   5%|▍         | 29/610 [00:05<01:49,  5.29it/s][A
Processing batches:   5%|▌         | 32/610 [00:05<01:30,  6.41it/s][A
Processing batches:   6%|▌         | 35/610 [00:08<03:02,  3.15it/s][A
Processing batches:   7%|▋         | 41/610 [00:08<01:51,  5.11it/s][A
Processing batches:   7%|▋         | 45/610 [00:08<01:29,  6.30it/s][A
Processing batches:   8%|▊         | 48/610 [00:11<02:50,  3.29it/s][A
Processing batches:   9%|▉         | 54/610 [00:11<01:46,  5.24it/s][A
Processing batches:   9%|▉         | 57/610 [00:11<01:28,  6.24it/s][A
Processing batches:  10%|▉         | 60/610 [00:13<02:52,  3.19it/s][A
Processing batches:  10%|█         | 63/610 [00:13<02:13,  4.09it/s][A
Processing batches:  11%|█         | 68/610 [00:14<01:30,  6.00it/s][A
Processing batches:  12%|█▏        | 71/610 [00:16<02:51,  3.14it/s][A
Processing batches:  12%|█▏        | 75/610 [00:16<02:01,  4.40it/s][A
Processing batches:  13%|█▎        | 78/610 [00:16<01:36,  5.53it/s][A
Processing batches:  13%|█▎        | 81/610 [00:16<01:15,  7.03it/s][A
Processing batches:  14%|█▍        | 84/610 [00:19<02:47,  3.14it/s][A
Processing batches:  14%|█▍        | 86/610 [00:19<02:20,  3.74it/s][A
Processing batches:  15%|█▍        | 90/610 [00:19<01:34,  5.48it/s][A
Processing batches:  15%|█▌        | 93/610 [00:19<01:13,  7.05it/s][A
Processing batches:  16%|█▌        | 96/610 [00:22<03:14,  2.65it/s][A
Processing batches:  17%|█▋        | 105/610 [00:22<01:29,  5.67it/s][A
Processing batches:  18%|█▊        | 109/610 [00:26<03:00,  2.78it/s][A
Processing batches:  19%|█▉        | 118/610 [00:27<02:01,  4.05it/s][A
Processing batches:  20%|█▉        | 121/610 [00:27<02:00,  4.07it/s][A
Processing batches:  20%|██        | 124/610 [00:27<01:38,  4.92it/s][A
Processing batches:  21%|██        | 126/610 [00:28<02:00,  4.03it/s][A
Processing batches:  21%|██▏       | 130/610 [00:29<01:57,  4.10it/s][A
Processing batches:  22%|██▏       | 133/610 [00:30<01:53,  4.20it/s][A
Processing batches:  22%|██▏       | 135/610 [00:30<01:37,  4.89it/s][A
Processing batches:  22%|██▏       | 137/610 [00:30<01:21,  5.82it/s][A
Processing batches:  23%|██▎       | 139/610 [00:31<01:49,  4.31it/s][A
Processing batches:  23%|██▎       | 142/610 [00:32<01:57,  3.97it/s][A
Processing batches:  24%|██▍       | 145/610 [00:33<01:54,  4.05it/s][A
Processing batches:  24%|██▍       | 147/610 [00:33<01:33,  4.95it/s][A
Processing batches:  24%|██▍       | 149/610 [00:33<01:16,  5.99it/s][A
Processing batches:  25%|██▍       | 151/610 [00:34<01:50,  4.17it/s][A
Processing batches:  25%|██▌       | 153/610 [00:34<01:26,  5.26it/s][A
Processing batches:  25%|██▌       | 155/610 [00:35<01:54,  3.98it/s][A
Processing batches:  26%|██▌       | 157/610 [00:35<02:07,  3.55it/s][A
Processing batches:  26%|██▌       | 160/610 [00:36<01:27,  5.15it/s][A
Processing batches:  27%|██▋       | 162/610 [00:36<01:46,  4.21it/s][A
Processing batches:  27%|██▋       | 163/610 [00:37<01:44,  4.27it/s][A
Processing batches:  27%|██▋       | 166/610 [00:37<01:47,  4.12it/s][A
Processing batches:  28%|██▊       | 168/610 [00:37<01:24,  5.23it/s][A
Processing batches:  28%|██▊       | 169/610 [00:38<02:01,  3.64it/s][A
Processing batches:  28%|██▊       | 170/610 [00:38<01:48,  4.06it/s][A
Processing batches:  28%|██▊       | 173/610 [00:38<01:09,  6.25it/s][A
Processing batches:  29%|██▊       | 175/610 [00:39<01:39,  4.35it/s][A
Processing batches:  29%|██▉       | 177/610 [00:39<01:18,  5.49it/s][A
Processing batches:  29%|██▉       | 178/610 [00:40<01:53,  3.80it/s][A
Processing batches:  29%|██▉       | 179/610 [00:40<01:41,  4.26it/s][A
Processing batches:  30%|██▉       | 181/610 [00:41<01:54,  3.76it/s][A
Processing batches:  30%|██▉       | 182/610 [00:41<01:43,  4.14it/s][A
Processing batches:  30%|███       | 185/610 [00:41<01:09,  6.12it/s][A
Processing batches:  30%|███       | 186/610 [00:42<01:44,  4.04it/s][A
Processing batches:  31%|███       | 187/610 [00:42<01:37,  4.34it/s][A
Processing batches:  31%|███       | 188/610 [00:42<01:36,  4.37it/s][A
Processing batches:  31%|███       | 189/610 [00:43<02:13,  3.15it/s][A
Processing batches:  31%|███▏      | 192/610 [00:43<01:13,  5.69it/s][A
Processing batches:  32%|███▏      | 194/610 [00:44<01:44,  3.99it/s][A
Processing batches:  32%|███▏      | 195/610 [00:44<01:45,  3.93it/s][A
Processing batches:  32%|███▏      | 198/610 [00:44<01:28,  4.63it/s][A
Processing batches:  33%|███▎      | 199/610 [00:45<01:25,  4.82it/s][A
Processing batches:  33%|███▎      | 200/610 [00:45<01:28,  4.65it/s][A
Processing batches:  33%|███▎      | 201/610 [00:45<01:29,  4.57it/s][A
Processing batches:  33%|███▎      | 202/610 [00:45<01:42,  3.98it/s][A
Processing batches:  33%|███▎      | 204/610 [00:46<01:10,  5.80it/s][A
Processing batches:  34%|███▎      | 205/610 [00:46<01:44,  3.88it/s][A
Processing batches:  34%|███▍      | 206/610 [00:46<01:45,  3.82it/s][A
Processing batches:  34%|███▍      | 207/610 [00:46<01:29,  4.49it/s][A
Processing batches:  34%|███▍      | 209/610 [00:47<01:04,  6.25it/s][A
Processing batches:  34%|███▍      | 210/610 [00:47<01:36,  4.15it/s][A
Processing batches:  35%|███▍      | 211/610 [00:47<01:29,  4.45it/s][A
Processing batches:  35%|███▍      | 212/610 [00:48<01:30,  4.39it/s][A
Processing batches:  35%|███▍      | 213/610 [00:48<01:30,  4.37it/s][A
Processing batches:  35%|███▌      | 214/610 [00:48<01:45,  3.75it/s][A
Processing batches:  36%|███▌      | 217/610 [00:49<01:29,  4.39it/s][A
Processing batches:  36%|███▌      | 218/610 [00:49<01:35,  4.09it/s][A
Processing batches:  36%|███▌      | 219/610 [00:49<01:26,  4.52it/s][A
Processing batches:  36%|███▌      | 220/610 [00:49<01:17,  5.05it/s][A
Processing batches:  36%|███▋      | 222/610 [00:50<01:28,  4.41it/s][A
Processing batches:  37%|███▋      | 223/610 [00:50<01:20,  4.78it/s][A
Processing batches:  37%|███▋      | 224/610 [00:50<01:24,  4.58it/s][A
Processing batches:  37%|███▋      | 225/610 [00:50<01:24,  4.55it/s][A
Processing batches:  37%|███▋      | 226/610 [00:51<01:34,  4.05it/s][A
Processing batches:  37%|███▋      | 228/610 [00:51<01:01,  6.20it/s][A
Processing batches:  38%|███▊      | 229/610 [00:51<01:31,  4.18it/s][A
Processing batches:  38%|███▊      | 230/610 [00:52<01:41,  3.76it/s][A
Processing batches:  38%|███▊      | 231/610 [00:52<01:31,  4.13it/s][A
Processing batches:  38%|███▊      | 232/610 [00:52<01:22,  4.57it/s][A
Processing batches:  38%|███▊      | 234/610 [00:52<01:21,  4.64it/s][A
Processing batches:  39%|███▊      | 235/610 [00:53<01:14,  5.01it/s][A
Processing batches:  39%|███▊      | 236/610 [00:53<01:44,  3.57it/s][A
Processing batches:  39%|███▉      | 238/610 [00:53<01:25,  4.33it/s][A
Processing batches:  39%|███▉      | 239/610 [00:54<02:02,  3.03it/s][A
Processing batches:  40%|███▉      | 242/610 [00:55<01:53,  3.25it/s][A
Processing batches:  40%|███▉      | 243/610 [00:55<02:03,  2.97it/s][A
Processing batches:  40%|████      | 245/610 [00:56<01:34,  3.88it/s][A
Processing batches:  41%|████      | 248/610 [00:56<00:59,  6.04it/s][A
Processing batches:  41%|████      | 250/610 [00:56<00:59,  6.10it/s][A
Processing batches:  41%|████      | 251/610 [00:56<00:57,  6.26it/s][A
Processing batches:  41%|████▏     | 252/610 [00:57<01:17,  4.63it/s][A
Processing batches:  41%|████▏     | 253/610 [00:57<01:39,  3.58it/s][A
Processing batches:  42%|████▏     | 254/610 [00:57<01:32,  3.85it/s][A
Processing batches:  42%|████▏     | 255/610 [00:58<01:42,  3.48it/s][A
Processing batches:  42%|████▏     | 256/610 [00:58<01:24,  4.18it/s][A
Processing batches:  42%|████▏     | 258/610 [00:58<01:11,  4.93it/s][A
Processing batches:  42%|████▏     | 259/610 [00:58<01:16,  4.58it/s][A
Processing batches:  43%|████▎     | 262/610 [00:59<00:55,  6.22it/s][A
Processing batches:  43%|████▎     | 263/610 [00:59<00:55,  6.22it/s][A
Processing batches:  43%|████▎     | 264/610 [00:59<01:16,  4.52it/s][A
Processing batches:  43%|████▎     | 265/610 [01:00<01:41,  3.41it/s][A
Processing batches:  44%|████▎     | 266/610 [01:00<01:29,  3.86it/s][A
Processing batches:  44%|████▍     | 267/610 [01:00<01:47,  3.20it/s][A
Processing batches:  44%|████▍     | 270/610 [01:01<01:11,  4.73it/s][A
Processing batches:  44%|████▍     | 271/610 [01:01<01:16,  4.41it/s][A
Processing batches:  45%|████▍     | 274/610 [01:01<00:53,  6.31it/s][A
Processing batches:  45%|████▌     | 275/610 [01:02<00:53,  6.21it/s][A
Processing batches:  45%|████▌     | 276/610 [01:02<01:13,  4.56it/s][A
Processing batches:  45%|████▌     | 277/610 [01:03<01:38,  3.37it/s][A
Processing batches:  46%|████▌     | 278/610 [01:03<01:25,  3.87it/s][A
Processing batches:  46%|████▌     | 279/610 [01:04<02:17,  2.41it/s][A
Processing batches:  46%|████▋     | 283/610 [01:04<01:06,  4.95it/s][A
Processing batches:  47%|████▋     | 286/610 [01:04<00:50,  6.46it/s][A
Processing batches:  47%|████▋     | 287/610 [01:04<00:50,  6.40it/s][A
Processing batches:  47%|████▋     | 288/610 [01:05<01:08,  4.68it/s][A
Processing batches:  47%|████▋     | 289/610 [01:05<01:34,  3.41it/s][A
Processing batches:  48%|████▊     | 290/610 [01:05<01:20,  3.98it/s][A
Processing batches:  48%|████▊     | 291/610 [01:06<01:36,  3.31it/s][A
Processing batches:  48%|████▊     | 292/610 [01:06<01:51,  2.86it/s][A
Processing batches:  48%|████▊     | 295/610 [01:06<00:58,  5.37it/s][A
Processing batches:  49%|████▊     | 297/610 [01:07<00:46,  6.75it/s][A
Processing batches:  49%|████▉     | 299/610 [01:07<00:46,  6.75it/s][A
Processing batches:  49%|████▉     | 301/610 [01:08<01:24,  3.65it/s][A
Processing batches:  50%|████▉     | 303/610 [01:08<01:21,  3.74it/s][A
Processing batches:  50%|████▉     | 304/610 [01:09<01:29,  3.40it/s][A
Processing batches:  50%|█████     | 306/610 [01:09<01:06,  4.60it/s][A
Processing batches:  50%|█████     | 308/610 [01:09<00:53,  5.70it/s][A
Processing batches:  51%|█████     | 309/610 [01:09<00:49,  6.03it/s][A
Processing batches:  51%|█████     | 311/610 [01:10<00:43,  6.84it/s][A
Processing batches:  51%|█████     | 312/610 [01:10<00:59,  4.99it/s][A
Processing batches:  51%|█████▏    | 313/610 [01:11<01:30,  3.29it/s][A
Processing batches:  52%|█████▏    | 315/610 [01:11<01:23,  3.54it/s][A
Processing batches:  52%|█████▏    | 316/610 [01:12<01:29,  3.28it/s][A
Processing batches:  52%|█████▏    | 317/610 [01:12<01:22,  3.57it/s][A
Processing batches:  52%|█████▏    | 320/610 [01:12<00:49,  5.85it/s][A
Processing batches:  53%|█████▎    | 321/610 [01:12<00:48,  5.97it/s][A
Processing batches:  53%|█████▎    | 323/610 [01:12<00:36,  7.91it/s][A
Processing batches:  53%|█████▎    | 325/610 [01:13<01:21,  3.50it/s][A
Processing batches:  54%|█████▎    | 327/610 [01:14<01:14,  3.78it/s][A
Processing batches:  54%|█████▍    | 328/610 [01:14<01:20,  3.50it/s][A
Processing batches:  54%|█████▍    | 329/610 [01:14<01:15,  3.71it/s][A
Processing batches:  54%|█████▍    | 332/610 [01:15<00:47,  5.85it/s][A
Processing batches:  55%|█████▍    | 333/610 [01:15<00:44,  6.27it/s][A
Processing batches:  55%|█████▍    | 335/610 [01:15<00:37,  7.39it/s][A
Processing batches:  55%|█████▌    | 336/610 [01:15<00:52,  5.19it/s][A
Processing batches:  55%|█████▌    | 337/610 [01:16<01:24,  3.22it/s][A
Processing batches:  56%|█████▌    | 339/610 [01:17<01:17,  3.52it/s][A
Processing batches:  56%|█████▌    | 340/610 [01:17<01:19,  3.39it/s][A
Processing batches:  56%|█████▌    | 341/610 [01:17<01:17,  3.48it/s][A
Processing batches:  56%|█████▌    | 343/610 [01:17<00:52,  5.10it/s][A
Processing batches:  57%|█████▋    | 345/610 [01:17<00:39,  6.66it/s][A
Processing batches:  57%|█████▋    | 346/610 [01:18<00:41,  6.29it/s][A
Processing batches:  57%|█████▋    | 348/610 [01:18<00:47,  5.53it/s][A
Processing batches:  57%|█████▋    | 349/610 [01:19<01:17,  3.37it/s][A
Processing batches:  58%|█████▊    | 351/610 [01:19<01:12,  3.59it/s][A
Processing batches:  58%|█████▊    | 352/610 [01:20<01:11,  3.62it/s][A
Processing batches:  58%|█████▊    | 353/610 [01:20<01:09,  3.71it/s][A
Processing batches:  58%|█████▊    | 354/610 [01:20<01:02,  4.08it/s][A
Processing batches:  59%|█████▊    | 357/610 [01:20<00:35,  7.21it/s][A
Processing batches:  59%|█████▉    | 359/610 [01:20<00:32,  7.66it/s][A
Processing batches:  59%|█████▉    | 361/610 [01:21<01:06,  3.74it/s][A
Processing batches:  60%|█████▉    | 363/610 [01:22<01:06,  3.73it/s][A
Processing batches:  60%|█████▉    | 364/610 [01:22<01:04,  3.81it/s][A
Processing batches:  60%|█████▉    | 365/610 [01:23<01:13,  3.35it/s][A
Processing batches:  60%|██████    | 368/610 [01:23<00:47,  5.10it/s][A
Processing batches:  61%|██████    | 371/610 [01:23<00:43,  5.49it/s][A
Processing batches:  61%|██████    | 373/610 [01:24<00:55,  4.29it/s][A
Processing batches:  61%|██████▏   | 374/610 [01:25<01:26,  2.73it/s][A
Processing batches:  62%|██████▏   | 377/610 [01:25<00:55,  4.21it/s][A
Processing batches:  62%|██████▏   | 378/610 [01:26<01:24,  2.73it/s][A
Processing batches:  62%|██████▏   | 381/610 [01:26<00:55,  4.13it/s][A
Processing batches:  63%|██████▎   | 383/610 [01:27<00:46,  4.88it/s][A
Processing batches:  63%|██████▎   | 386/610 [01:27<00:46,  4.86it/s][A
Processing batches:  63%|██████▎   | 387/610 [01:28<00:54,  4.07it/s][A
Processing batches:  64%|██████▍   | 389/610 [01:28<00:44,  4.99it/s][A
Processing batches:  64%|██████▍   | 392/610 [01:28<00:32,  6.66it/s][A
Processing batches:  64%|██████▍   | 393/610 [01:29<00:45,  4.79it/s][A
Processing batches:  65%|██████▍   | 394/610 [01:29<00:46,  4.61it/s][A
Processing batches:  65%|██████▍   | 395/610 [01:29<00:45,  4.72it/s][A
Processing batches:  65%|██████▍   | 396/610 [01:29<00:45,  4.74it/s][A
Processing batches:  65%|██████▌   | 398/610 [01:30<00:53,  3.95it/s][A
Processing batches:  65%|██████▌   | 399/610 [01:30<01:03,  3.32it/s][A
Processing batches:  66%|██████▌   | 400/610 [01:31<00:54,  3.88it/s][A
Processing batches:  66%|██████▌   | 403/610 [01:31<00:30,  6.77it/s][A
Processing batches:  66%|██████▋   | 405/610 [01:31<00:42,  4.82it/s][A
Processing batches:  67%|██████▋   | 406/610 [01:32<00:50,  4.05it/s][A
Processing batches:  67%|██████▋   | 407/610 [01:32<00:44,  4.54it/s][A
Processing batches:  67%|██████▋   | 408/610 [01:32<00:39,  5.07it/s][A
Processing batches:  67%|██████▋   | 409/610 [01:32<00:39,  5.09it/s][A
Processing batches:  67%|██████▋   | 410/610 [01:33<00:50,  3.92it/s][A
Processing batches:  67%|██████▋   | 411/610 [01:33<01:02,  3.19it/s][A
Processing batches:  68%|██████▊   | 412/610 [01:33<00:55,  3.58it/s][A
Processing batches:  68%|██████▊   | 416/610 [01:34<00:28,  6.82it/s][A
Processing batches:  68%|██████▊   | 417/610 [01:34<00:39,  4.89it/s][A
Processing batches:  69%|██████▊   | 418/610 [01:35<00:52,  3.68it/s][A
Processing batches:  69%|██████▉   | 420/610 [01:35<00:37,  5.13it/s][A
Processing batches:  69%|██████▉   | 421/610 [01:35<00:40,  4.70it/s][A
Processing batches:  69%|██████▉   | 422/610 [01:35<00:46,  4.05it/s][A
Processing batches:  69%|██████▉   | 423/610 [01:36<00:55,  3.35it/s][A
Processing batches:  70%|██████▉   | 424/610 [01:36<00:48,  3.81it/s][A
Processing batches:  70%|██████▉   | 425/610 [01:36<00:41,  4.49it/s][A
Processing batches:  70%|███████   | 428/610 [01:36<00:23,  7.64it/s][A
Processing batches:  70%|███████   | 430/610 [01:37<00:48,  3.72it/s][A
Processing batches:  71%|███████   | 433/610 [01:38<00:37,  4.72it/s][A
Processing batches:  71%|███████   | 434/610 [01:38<00:39,  4.43it/s][A
Processing batches:  71%|███████▏  | 435/610 [01:38<00:47,  3.69it/s][A
Processing batches:  71%|███████▏  | 436/610 [01:39<00:41,  4.15it/s][A
Processing batches:  72%|███████▏  | 438/610 [01:39<00:28,  5.94it/s][A
Processing batches:  72%|███████▏  | 440/610 [01:39<00:25,  6.77it/s][A
Processing batches:  72%|███████▏  | 441/610 [01:39<00:32,  5.22it/s][A
Processing batches:  72%|███████▏  | 442/610 [01:40<00:53,  3.12it/s][A
Processing batches:  73%|███████▎  | 445/610 [01:40<00:37,  4.38it/s][A
Processing batches:  73%|███████▎  | 446/610 [01:41<00:36,  4.48it/s][A
Processing batches:  73%|███████▎  | 447/610 [01:41<00:44,  3.65it/s][A
Processing batches:  73%|███████▎  | 448/610 [01:41<00:39,  4.10it/s][A
Processing batches:  74%|███████▎  | 449/610 [01:41<00:33,  4.76it/s][A
Processing batches:  74%|███████▍  | 451/610 [01:41<00:23,  6.74it/s][A
Processing batches:  74%|███████▍  | 453/610 [01:42<00:28,  5.57it/s][A
Processing batches:  74%|███████▍  | 454/610 [01:43<00:47,  3.28it/s][A
Processing batches:  75%|███████▍  | 457/610 [01:43<00:35,  4.29it/s][A
Processing batches:  75%|███████▌  | 458/610 [01:43<00:33,  4.48it/s][A
Processing batches:  75%|███████▌  | 459/610 [01:44<00:40,  3.76it/s][A
Processing batches:  75%|███████▌  | 460/610 [01:44<00:38,  3.91it/s][A
Processing batches:  76%|███████▌  | 461/610 [01:44<00:34,  4.26it/s][A
Processing batches:  76%|███████▌  | 465/610 [01:45<00:23,  6.14it/s][A
Processing batches:  76%|███████▋  | 466/610 [01:45<00:40,  3.57it/s][A
Processing batches:  77%|███████▋  | 469/610 [01:46<00:41,  3.40it/s][A
Processing batches:  77%|███████▋  | 472/610 [01:47<00:30,  4.53it/s][A
Processing batches:  78%|███████▊  | 474/610 [01:47<00:26,  5.14it/s][A
Processing batches:  78%|███████▊  | 477/610 [01:47<00:22,  5.97it/s][A
Processing batches:  78%|███████▊  | 478/610 [01:48<00:33,  3.89it/s][A
Processing batches:  79%|███████▊  | 480/610 [01:48<00:27,  4.80it/s][A
Processing batches:  79%|███████▉  | 481/610 [01:49<00:33,  3.81it/s][A
Processing batches:  79%|███████▉  | 482/610 [01:49<00:35,  3.59it/s][A
Processing batches:  79%|███████▉  | 484/610 [01:49<00:28,  4.42it/s][A
Processing batches:  80%|███████▉  | 486/610 [01:50<00:23,  5.32it/s][A
Processing batches:  80%|████████  | 488/610 [01:50<00:18,  6.72it/s][A
Processing batches:  80%|████████  | 489/610 [01:50<00:18,  6.50it/s][A
Processing batches:  80%|████████  | 490/610 [01:51<00:34,  3.44it/s][A
Processing batches:  80%|████████  | 491/610 [01:51<00:30,  3.95it/s][A
Processing batches:  81%|████████  | 493/610 [01:52<00:33,  3.46it/s][A
Processing batches:  81%|████████  | 494/610 [01:52<00:33,  3.47it/s][A
Processing batches:  81%|████████▏ | 496/610 [01:52<00:25,  4.49it/s][A
Processing batches:  82%|████████▏ | 498/610 [01:52<00:19,  5.72it/s][A
Processing batches:  82%|████████▏ | 499/610 [01:52<00:18,  6.16it/s][A
Processing batches:  82%|████████▏ | 500/610 [01:53<00:18,  5.96it/s][A
Processing batches:  82%|████████▏ | 502/610 [01:54<00:30,  3.50it/s][A
Processing batches:  83%|████████▎ | 504/610 [01:54<00:32,  3.27it/s][A
Processing batches:  83%|████████▎ | 505/610 [01:55<00:44,  2.38it/s][A
Processing batches:  84%|████████▍ | 511/610 [01:56<00:24,  4.01it/s][A
Processing batches:  84%|████████▍ | 512/610 [01:56<00:23,  4.24it/s][A
Processing batches:  84%|████████▍ | 515/610 [01:56<00:16,  5.89it/s][A
Processing batches:  85%|████████▍ | 516/610 [01:57<00:28,  3.33it/s][A
Processing batches:  85%|████████▌ | 519/610 [01:57<00:18,  5.04it/s][A
Processing batches:  85%|████████▌ | 521/610 [01:58<00:15,  5.72it/s][A
Processing batches:  86%|████████▌ | 523/610 [01:58<00:15,  5.56it/s][A
Processing batches:  86%|████████▌ | 524/610 [01:59<00:23,  3.68it/s][A
Processing batches:  86%|████████▌ | 525/610 [01:59<00:20,  4.10it/s][A
Processing batches:  87%|████████▋ | 528/610 [02:00<00:23,  3.42it/s][A
Processing batches:  87%|████████▋ | 530/610 [02:00<00:17,  4.46it/s][A
Processing batches:  87%|████████▋ | 532/610 [02:00<00:14,  5.45it/s][A
Processing batches:  88%|████████▊ | 534/610 [02:01<00:15,  5.00it/s][A
Processing batches:  88%|████████▊ | 536/610 [02:01<00:18,  4.02it/s][A
Processing batches:  88%|████████▊ | 538/610 [02:02<00:14,  5.05it/s][A
Processing batches:  89%|████████▊ | 540/610 [02:03<00:20,  3.41it/s][A
Processing batches:  89%|████████▉ | 542/610 [02:03<00:15,  4.33it/s][A
Processing batches:  89%|████████▉ | 545/610 [02:03<00:10,  6.02it/s][A
Processing batches:  90%|████████▉ | 547/610 [02:03<00:11,  5.48it/s][A
Processing batches:  90%|████████▉ | 548/610 [02:04<00:17,  3.53it/s][A
Processing batches:  90%|█████████ | 552/610 [02:05<00:15,  3.68it/s][A
Processing batches:  91%|█████████ | 554/610 [02:05<00:12,  4.56it/s][A
Processing batches:  91%|█████████ | 555/610 [02:06<00:11,  4.98it/s][A
Processing batches:  91%|█████████▏| 557/610 [02:06<00:08,  5.95it/s][A
Processing batches:  91%|█████████▏| 558/610 [02:07<00:14,  3.56it/s][A
Processing batches:  92%|█████████▏| 560/610 [02:07<00:12,  3.92it/s][A
Processing batches:  92%|█████████▏| 563/610 [02:07<00:07,  5.93it/s][A
Processing batches:  93%|█████████▎| 565/610 [02:08<00:11,  3.77it/s][A
Processing batches:  93%|█████████▎| 567/610 [02:08<00:09,  4.72it/s][A
Processing batches:  93%|█████████▎| 570/610 [02:09<00:07,  5.15it/s][A
Processing batches:  94%|█████████▎| 571/610 [02:09<00:09,  4.13it/s][A
Processing batches:  94%|█████████▍| 572/610 [02:10<00:10,  3.73it/s][A
Processing batches:  94%|█████████▍| 575/610 [02:10<00:05,  5.98it/s][A
Processing batches:  95%|█████████▍| 577/610 [02:11<00:08,  3.76it/s][A
Processing batches:  95%|█████████▍| 579/610 [02:11<00:06,  4.92it/s][A
Processing batches:  95%|█████████▌| 581/610 [02:11<00:05,  5.73it/s][A
Processing batches:  96%|█████████▌| 583/610 [02:12<00:06,  4.04it/s][A
Processing batches:  96%|█████████▌| 584/610 [02:12<00:06,  3.76it/s][A
Processing batches:  96%|█████████▌| 586/610 [02:12<00:04,  5.05it/s][A
Processing batches:  96%|█████████▋| 588/610 [02:13<00:06,  3.41it/s][A
Processing batches:  97%|█████████▋| 590/610 [02:14<00:04,  4.55it/s][A
Processing batches:  97%|█████████▋| 592/610 [02:14<00:03,  5.86it/s][A
Processing batches:  97%|█████████▋| 594/610 [02:14<00:03,  5.32it/s][A
Processing batches:  98%|█████████▊| 595/610 [02:15<00:03,  3.96it/s][A
Processing batches:  98%|█████████▊| 596/610 [02:15<00:03,  3.69it/s][A
Processing batches:  98%|█████████▊| 598/610 [02:15<00:02,  5.04it/s][A
Processing batches:  98%|█████████▊| 600/610 [02:16<00:02,  3.67it/s][A
Processing batches:  99%|█████████▊| 601/610 [02:16<00:02,  4.08it/s][A
Processing batches:  99%|█████████▉| 604/610 [02:16<00:00,  6.63it/s][A
Processing batches:  99%|█████████▉| 606/610 [02:16<00:00,  6.86it/s][A
Processing batches: 100%|█████████▉| 608/610 [02:17<00:00,  5.26it/s][AProcessing batches: 100%|██████████| 610/610 [02:17<00:00,  4.43it/s]
INFO:pdex._single_cell:Flattening results
INFO:pdex._single_cell:Closing shared memory pool
INFO:cell_eval._evaluator:Writing pred DE results to: hepg2_pred_de.csv
INFO:cell_eval._pipeline._runner:Computing metric 'overlap_at_N'
INFO:cell_eval._pipeline._runner:Computing metric 'mae'
INFO:cell_eval._types._anndata:Building pseudobulk embeddings for real anndata on: .X
INFO:cell_eval._types._anndata:Building pseudobulk embeddings for predicted anndata on: .X

Iterating over perturbations...:   0%|          | 0/68 [00:00<?, ?it/s][AIterating over perturbations...: 100%|██████████| 68/68 [00:00<00:00, 3461.95it/s]
INFO:cell_eval._pipeline._runner:Computing metric 'discrimination_score_l1'

Iterating over perturbations...:   0%|          | 0/68 [00:00<?, ?it/s][AIterating over perturbations...: 100%|██████████| 68/68 [00:00<00:00, 22202.45it/s]

Iterating over perturbations...:   0%|          | 0/68 [00:00<?, ?it/s][AIterating over perturbations...: 100%|██████████| 68/68 [00:00<00:00, 21905.74it/s]
INFO:cell_eval._evaluator:Writing perturbation level metrics to competition/sm_trainer_test/eval_temp_eval_checkpoint.ckpt/hepg2_results.csv
INFO:cell_eval._evaluator:Writing aggregate metrics to competition/sm_trainer_test/eval_temp_eval_checkpoint.ckpt/hepg2_agg_results.csv
INFO:state.tx.callbacks.cell_eval_callback:Collected evaluation results for step 2 (eval #2)
INFO:state.tx.callbacks.cell_eval_callback:Creating evaluation plots (eval #2)
INFO:state.tx.callbacks.cell_eval_callback:Available agg_results columns: ['statistic', 'overlap_at_N', 'mae', 'discrimination_score_l1', 'eval_step', 'global_step', 'epoch']
INFO:state.tx.callbacks.cell_eval_callback:Saved metrics plot with 3 available metrics: competition/sm_trainer_test/evaluation_plots/available_metrics_step_2.png
INFO:state.tx.callbacks.cell_eval_callback:Saved detailed analysis plot: competition/sm_trainer_test/evaluation_plots/detailed_analysis_step_2.png
INFO:state.tx.callbacks.cell_eval_callback:Available results columns: ['perturbation', 'overlap_at_N', 'mae', 'discrimination_score_l1', 'eval_step', 'global_step', 'epoch']
ERROR:state.tx.callbacks.cell_eval_callback:Error creating evaluation plots: 1
Traceback (most recent call last):
  File "/home/buchi/vcc/state/.venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 1

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/buchi/vcc/state/src/state/tx/callbacks/cell_eval_callback.py", line 216, in _create_evaluation_plots
    self._plot_perturbation_metrics_robust(combined_results, trainer.global_step)
  File "/home/buchi/vcc/state/src/state/tx/callbacks/cell_eval_callback.py", line 431, in _plot_perturbation_metrics_robust
    top_perts = latest_eval.nsmallest(15, metric)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/buchi/vcc/state/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7763, in nsmallest
    return selectn.SelectNFrame(self, n=n, keep=keep, columns=columns).nsmallest()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/buchi/vcc/state/.venv/lib/python3.11/site-packages/pandas/core/methods/selectn.py", line 61, in nsmallest
    return self.compute("nsmallest")
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/buchi/vcc/state/.venv/lib/python3.11/site-packages/pandas/core/methods/selectn.py", line 199, in compute
    dtype = frame[column].dtype
            ~~~~~^^^^^^^^
  File "/home/buchi/vcc/state/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 4107, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/buchi/vcc/state/.venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3819, in get_loc
    raise KeyError(key) from err
KeyError: 1
Buchi after run_tx_predict in _call_run_tx_predict
Buchi results: <class 'polars.dataframe.frame.DataFrame'>
Buchi results_with_step:    perturbation  overlap_at_N       mae  discrimination_score_l1
0         ARPC2           0.0  0.271538                 0.941176
1       ATP6V0B           0.0  0.263097                 0.235294
2       ATP6V0C           0.0  0.259533                 0.161765
3         C1QBP           0.0  0.268517                 0.294118
4          CAST           0.0  0.277373                 0.544118
..          ...           ...       ...                      ...
63        UBE3C           0.0  0.268203                 0.485294
64        UQCRB           0.0  0.267325                 0.279412
65        UQCRQ           0.0  0.266839                 0.205882
66         USF2           0.0  0.270863                 0.794118
67          WAC           0.0  0.272419                 0.735294

[68 rows x 4 columns]
Buchi agg_results: <class 'polars.dataframe.frame.DataFrame'>
Buchi _create_evaluation_plots combined_agg_results:      statistic  overlap_at_N        mae  ...  eval_step  global_step  epoch
0        count     68.000000  68.000000  ...          0            1      0
1   null_count      0.000000   0.000000  ...          0            1      0
2         mean      0.000674   0.267880  ...          0            1      0
3          std      0.003060   0.007158  ...          0            1      0
4          min      0.000000   0.254052  ...          0            1      0
5          25%      0.000000   0.264006  ...          0            1      0
6          50%      0.000000   0.267224  ...          0            1      0
7          75%      0.000000   0.271138  ...          0            1      0
8          max      0.022222   0.295371  ...          0            1      0
9        count     68.000000  68.000000  ...          1            2      0
10  null_count      0.000000   0.000000  ...          1            2      0
11        mean      0.000263   0.269280  ...          1            2      0
12         std      0.001535   0.006547  ...          1            2      0
13         min      0.000000   0.258622  ...          1            2      0
14         25%      0.000000   0.266291  ...          1            2      0
15         50%      0.000000   0.268203  ...          1            2      0
16         75%      0.000000   0.271753  ...          1            2      0
17         max      0.010000   0.300496  ...          1            2      0

[18 rows x 7 columns]
Buchi _plot_aggregated_metrics_over_time
Buchi _plot_aggregated_metrics_over_time combined_agg_results:      statistic  overlap_at_N        mae  ...  eval_step  global_step  epoch
0        count     68.000000  68.000000  ...          0            1      0
1   null_count      0.000000   0.000000  ...          0            1      0
2         mean      0.000674   0.267880  ...          0            1      0
3          std      0.003060   0.007158  ...          0            1      0
4          min      0.000000   0.254052  ...          0            1      0
5          25%      0.000000   0.264006  ...          0            1      0
6          50%      0.000000   0.267224  ...          0            1      0
7          75%      0.000000   0.271138  ...          0            1      0
8          max      0.022222   0.295371  ...          0            1      0
9        count     68.000000  68.000000  ...          1            2      0
10  null_count      0.000000   0.000000  ...          1            2      0
11        mean      0.000263   0.269280  ...          1            2      0
12         std      0.001535   0.006547  ...          1            2      0
13         min      0.000000   0.258622  ...          1            2      0
14         25%      0.000000   0.266291  ...          1            2      0
15         50%      0.000000   0.268203  ...          1            2      0
16         75%      0.000000   0.271753  ...          1            2      0
17         max      0.010000   0.300496  ...          1            2      0

[18 rows x 7 columns]
Buchi _plot_current_metrics_analysis combined_agg_results:      statistic  overlap_at_N        mae  ...  eval_step  global_step  epoch
0        count     68.000000  68.000000  ...          0            1      0
1   null_count      0.000000   0.000000  ...          0            1      0
2         mean      0.000674   0.267880  ...          0            1      0
3          std      0.003060   0.007158  ...          0            1      0
4          min      0.000000   0.254052  ...          0            1      0
5          25%      0.000000   0.264006  ...          0            1      0
6          50%      0.000000   0.267224  ...          0            1      0
7          75%      0.000000   0.271138  ...          0            1      0
8          max      0.022222   0.295371  ...          0            1      0
9        count     68.000000  68.000000  ...          1            2      0
10  null_count      0.000000   0.000000  ...          1            2      0
11        mean      0.000263   0.269280  ...          1            2      0
12         std      0.001535   0.006547  ...          1            2      0
13         min      0.000000   0.258622  ...          1            2      0
14         25%      0.000000   0.266291  ...          1            2      0
15         50%      0.000000   0.268203  ...          1            2      0
16         75%      0.000000   0.271753  ...          1            2      0
17         max      0.010000   0.300496  ...          1            2      0

[18 rows x 7 columns]
Buchi _plot_perturbation_metrics_robust combined_results:     perturbation  overlap_at_N       mae  ...  eval_step  global_step  epoch
0          ARPC2      0.000000  0.270885  ...          0            1      0
1        ATP6V0B      0.000000  0.260555  ...          0            1      0
2        ATP6V0C      0.002232  0.256109  ...          0            1      0
3          C1QBP      0.000000  0.267044  ...          0            1      0
4           CAST      0.000000  0.280679  ...          0            1      0
..           ...           ...       ...  ...        ...          ...    ...
131        UBE3C      0.000000  0.268203  ...          1            2      0
132        UQCRB      0.000000  0.267325  ...          1            2      0
133        UQCRQ      0.000000  0.266839  ...          1            2      0
134         USF2      0.000000  0.270863  ...          1            2      0
135          WAC      0.000000  0.272419  ...          1            2      0

[136 rows x 7 columns]
Epoch 0:   4%|▍         | 2/52 [10:50<4:31:12,  0.00it/s, v_num=a9z4]Epoch 0:   4%|▍         | 2/52 [10:50<4:31:12,  0.00it/s, v_num=a9z4]INFO:state.tx.callbacks.cell_eval_callback:Running dynamic evaluation at step 3
INFO:state._cli._tx._predict:Loaded config from competition/sm_trainer_test/config.yaml
INFO:cell_load.data_modules.perturbation_dataloader:Loaded data module configuration from competition/sm_trainer_test/data_module.torch
WARNING:cell_load.config:Dataset path does not exist: ./competition_support_set/{competition_train,k562_gwps,rpe1,jurkat,k562,hepg2}.h5
INFO:cell_load.config:Configuration validation passed
INFO:cell_load.data_modules.perturbation_dataloader:Initializing DataModule: batch_size=16, workers=1, random_seed=42
INFO:cell_load.data_modules.perturbation_dataloader:Set 2 missing perturbations to zero vectors.
INFO:cell_load.data_modules.perturbation_dataloader:Loaded custom perturbation featurizations for 19792 perturbations.
INFO:cell_load.data_modules.perturbation_dataloader:Processing dataset replogle_h1:
INFO:cell_load.data_modules.perturbation_dataloader:  - Training dataset: True
INFO:cell_load.data_modules.perturbation_dataloader:  - Zeroshot cell types: ['hepg2']
INFO:cell_load.data_modules.perturbation_dataloader:  - Fewshot cell types: []
./competition_support_set/{competition_train,k562_gwps,rpe1,jurkat,k562,hepg2}.h5

Processing replogle_h1:   0%|          | 0/6 [00:00<?, ?it/s][A                                                                     
                                                             [AProcessed competition_train: 221273 train, 0 val, 0 test
Epoch 0:   4%|▍         | 2/52 [11:04<4:36:43,  0.00it/s, v_num=a9z4]
Processing replogle_h1:   0%|          | 0/6 [00:00<?, ?it/s][A
Processing replogle_h1:  17%|█▋        | 1/6 [00:00<00:00,  8.64it/s][AWARNING:cell_load.dataset._perturbation:No cell barcode information found in competition_support_set/k562_gwps.h5. Generating generic barcodes.
                                                                     
                                                                     [AProcessed k562_gwps: 111605 train, 0 val, 0 test
Epoch 0:   4%|▍         | 2/52 [11:04<4:36:45,  0.00it/s, v_num=a9z4]
Processing replogle_h1:  17%|█▋        | 1/6 [00:00<00:00,  8.64it/s][AWARNING:cell_load.dataset._perturbation:No cell barcode information found in competition_support_set/rpe1.h5. Generating generic barcodes.
                                                                     
                                                                     [AProcessed rpe1: 22317 train, 0 val, 0 test
Epoch 0:   4%|▍         | 2/52 [11:04<4:36:45,  0.00it/s, v_num=a9z4]
Processing replogle_h1:  17%|█▋        | 1/6 [00:00<00:00,  8.64it/s][AWARNING:cell_load.dataset._perturbation:No cell barcode information found in competition_support_set/jurkat.h5. Generating generic barcodes.
                                                                     
                                                                     [AProcessed jurkat: 21412 train, 0 val, 0 test
Epoch 0:   4%|▍         | 2/52 [11:04<4:36:45,  0.00it/s, v_num=a9z4]
Processing replogle_h1:  17%|█▋        | 1/6 [00:00<00:00,  8.64it/s][AWARNING:cell_load.dataset._perturbation:No cell barcode information found in competition_support_set/k562.h5. Generating generic barcodes.
                                                                     
                                                                     [AProcessed k562: 18465 train, 0 val, 0 test
Epoch 0:   4%|▍         | 2/52 [11:04<4:36:45,  0.00it/s, v_num=a9z4]
Processing replogle_h1:  17%|█▋        | 1/6 [00:00<00:00,  8.64it/s][AWARNING:cell_load.dataset._perturbation:No cell barcode information found in competition_support_set/hepg2.h5. Generating generic barcodes.
                                                                     
                                                                     [AProcessed hepg2: 0 train, 0 val, 9386 test
Epoch 0:   4%|▍         | 2/52 [11:04<4:36:45,  0.00it/s, v_num=a9z4]
Processing replogle_h1:  17%|█▋        | 1/6 [00:00<00:00,  8.64it/s][AProcessing replogle_h1: 100%|██████████| 6/6 [00:00<00:00, 30.37it/s]
INFO:cell_load.data_modules.perturbation_dataloader:

INFO:cell_load.data_modules.perturbation_dataloader:Done! Train / Val / Test splits: 5 / 0 / 1
INFO:state._cli._tx._predict:Loaded data module from competition/sm_trainer_test/data_module.torch
Seed set to 42
INFO:state._cli._tx._predict:Loading model from competition/sm_trainer_test/checkpoints/temp_eval_checkpoint.ckpt
INFO:state._cli._tx._predict:Model loaded successfully.
INFO:cell_load.data_modules.samplers:Creating perturbation batch sampler with metadata caching (using codes)...
INFO:cell_load.data_modules.samplers:Total # cells 9386. Cell set size mean / std before resampling: 78.22 / 47.32.
INFO:cell_load.data_modules.samplers:Creating meta-batches with cell_sentence_len=128...
INFO:cell_load.data_modules.samplers:Of all batches, 120 were full and 0 were partial.
INFO:cell_load.data_modules.samplers:Sampler created with 120 batches in 0.01 seconds.
INFO:state._cli._tx._predict:Generating predictions on test set using manual loop...
StateTransitionPerturbationModel(
  (loss_fn): SamplesLoss()
  (pert_encoder): Sequential(
    (0): Linear(in_features=5120, out_features=672, bias=True)
    (1): GELU(approximate='none')
    (2): Dropout(p=0.1, inplace=False)
    (3): Linear(in_features=672, out_features=672, bias=True)
    (4): GELU(approximate='none')
    (5): Dropout(p=0.1, inplace=False)
    (6): Linear(in_features=672, out_features=672, bias=True)
    (7): GELU(approximate='none')
    (8): Dropout(p=0.1, inplace=False)
    (9): Linear(in_features=672, out_features=672, bias=True)
  )
  (basal_encoder): Linear(in_features=18080, out_features=672, bias=True)
  (transformer_backbone): LlamaBidirectionalModel(
    (embed_tokens): Embedding(32000, 672, padding_idx=0)
    (layers): ModuleList(
      (0-3): 4 x LlamaDecoderLayer(
        (self_attn): LlamaAttention(
          (q_proj): Linear(in_features=672, out_features=672, bias=False)
          (k_proj): Linear(in_features=672, out_features=672, bias=False)
          (v_proj): Linear(in_features=672, out_features=672, bias=False)
          (o_proj): Linear(in_features=672, out_features=672, bias=False)
        )
        (mlp): LlamaMLP(
          (gate_proj): Linear(in_features=672, out_features=2688, bias=False)
          (up_proj): Linear(in_features=672, out_features=2688, bias=False)
          (down_proj): Linear(in_features=2688, out_features=672, bias=False)
          (act_fn): SiLU()
        )
        (input_layernorm): LlamaRMSNorm((672,), eps=1e-06)
        (post_attention_layernorm): LlamaRMSNorm((672,), eps=1e-06)
      )
    )
    (norm): LlamaRMSNorm((672,), eps=1e-06)
    (rotary_emb): NoRoPE()
  )
  (project_out): Sequential(
    (0): Linear(in_features=672, out_features=672, bias=True)
    (1): GELU(approximate='none')
    (2): Dropout(p=0.1, inplace=False)
    (3): Linear(in_features=672, out_features=672, bias=True)
    (4): GELU(approximate='none')
    (5): Dropout(p=0.1, inplace=False)
    (6): Linear(in_features=672, out_features=672, bias=True)
    (7): GELU(approximate='none')
    (8): Dropout(p=0.1, inplace=False)
    (9): Linear(in_features=672, out_features=18080, bias=True)
  )
  (final_down_then_up): Sequential(
    (0): Linear(in_features=18080, out_features=2260, bias=True)
    (1): GELU(approximate='none')
    (2): Linear(in_features=2260, out_features=18080, bias=True)
  )
  (relu): ReLU()
)

Predicting:   0%|          | 0/120 [00:00<?, ?batch/s][AINFO:cell_load.data_modules.samplers:Of all batches, 120 were full and 0 were partial.

Predicting:   1%|          | 1/120 [00:00<01:09,  1.71batch/s][A
Predicting:   2%|▏         | 2/120 [00:00<00:36,  3.21batch/s][A
Predicting:   3%|▎         | 4/120 [00:01<00:27,  4.15batch/s][A
Predicting:   4%|▍         | 5/120 [00:01<00:30,  3.77batch/s][A
Predicting:   5%|▌         | 6/120 [00:01<00:24,  4.61batch/s][A
Predicting:   6%|▌         | 7/120 [00:01<00:25,  4.50batch/s][A
Predicting:   7%|▋         | 8/120 [00:01<00:21,  5.32batch/s][A
Predicting:   8%|▊         | 9/120 [00:02<00:22,  5.03batch/s][A
Predicting:   8%|▊         | 10/120 [00:02<00:19,  5.72batch/s][A
Predicting:   9%|▉         | 11/120 [00:02<00:22,  4.74batch/s][A
Predicting:  10%|█         | 12/120 [00:02<00:26,  4.10batch/s][A
Predicting:  11%|█         | 13/120 [00:03<00:28,  3.81batch/s][A
Predicting:  12%|█▏        | 14/120 [00:03<00:29,  3.58batch/s][A
Predicting:  12%|█▎        | 15/120 [00:03<00:26,  3.99batch/s][A
Predicting:  13%|█▎        | 16/120 [00:03<00:28,  3.70batch/s][A
Predicting:  14%|█▍        | 17/120 [00:04<00:26,  3.89batch/s][A
Predicting:  15%|█▌        | 18/120 [00:04<00:27,  3.66batch/s][A
Predicting:  16%|█▌        | 19/120 [00:04<00:28,  3.53batch/s][A
Predicting:  17%|█▋        | 20/120 [00:05<00:28,  3.46batch/s][A
Predicting:  18%|█▊        | 21/120 [00:05<00:24,  3.98batch/s][A
Predicting:  18%|█▊        | 22/120 [00:05<00:37,  2.62batch/s][A
Predicting:  20%|██        | 24/120 [00:06<00:24,  3.86batch/s][A
Predicting:  22%|██▏       | 26/120 [00:06<00:18,  5.06batch/s][A
Predicting:  22%|██▎       | 27/120 [00:06<00:17,  5.39batch/s][A
Predicting:  23%|██▎       | 28/120 [00:06<00:17,  5.17batch/s][A
Predicting:  24%|██▍       | 29/120 [00:07<00:20,  4.50batch/s][A
Predicting:  25%|██▌       | 30/120 [00:07<00:17,  5.02batch/s][A
Predicting:  26%|██▌       | 31/120 [00:07<00:18,  4.70batch/s][A
Predicting:  28%|██▊       | 33/120 [00:07<00:17,  4.87batch/s][A
Predicting:  28%|██▊       | 34/120 [00:08<00:16,  5.12batch/s][A
Predicting:  29%|██▉       | 35/120 [00:08<00:19,  4.47batch/s][A
Predicting:  30%|███       | 36/120 [00:08<00:20,  4.03batch/s][A
Predicting:  31%|███       | 37/120 [00:08<00:21,  3.95batch/s][A
Predicting:  32%|███▏      | 38/120 [00:09<00:22,  3.73batch/s][A
Predicting:  32%|███▎      | 39/120 [00:09<00:18,  4.42batch/s][A
Predicting:  33%|███▎      | 40/120 [00:09<00:15,  5.09batch/s][A
Predicting:  34%|███▍      | 41/120 [00:09<00:17,  4.46batch/s][A
Predicting:  35%|███▌      | 42/120 [00:10<00:19,  3.97batch/s][A
Predicting:  36%|███▌      | 43/120 [00:10<00:18,  4.18batch/s][A
Predicting:  37%|███▋      | 44/120 [00:10<00:19,  3.91batch/s][A
Predicting:  38%|███▊      | 45/120 [00:10<00:20,  3.65batch/s][A
Predicting:  38%|███▊      | 46/120 [00:10<00:17,  4.34batch/s][A
Predicting:  40%|████      | 48/120 [00:11<00:11,  6.02batch/s][A
Predicting:  41%|████      | 49/120 [00:11<00:11,  5.99batch/s][A
Predicting:  42%|████▏     | 50/120 [00:11<00:11,  6.26batch/s][A
Predicting:  42%|████▎     | 51/120 [00:11<00:10,  6.67batch/s][A
Predicting:  43%|████▎     | 52/120 [00:11<00:13,  5.02batch/s][A
Predicting:  44%|████▍     | 53/120 [00:12<00:13,  4.93batch/s][A
Predicting:  45%|████▌     | 54/120 [00:12<00:15,  4.15batch/s][A
Predicting:  46%|████▌     | 55/120 [00:12<00:14,  4.42batch/s][A
Predicting:  47%|████▋     | 56/120 [00:13<00:16,  3.92batch/s][A
Predicting:  48%|████▊     | 57/120 [00:13<00:17,  3.55batch/s][A
Predicting:  48%|████▊     | 58/120 [00:13<00:22,  2.77batch/s][A
Predicting:  49%|████▉     | 59/120 [00:14<00:18,  3.38batch/s][A
Predicting:  50%|█████     | 60/120 [00:14<00:15,  3.97batch/s][A
Predicting:  51%|█████     | 61/120 [00:14<00:12,  4.67batch/s][A
Predicting:  52%|█████▏    | 62/120 [00:14<00:14,  4.09batch/s][A
Predicting:  52%|█████▎    | 63/120 [00:14<00:11,  4.82batch/s][A
Predicting:  53%|█████▎    | 64/120 [00:14<00:10,  5.46batch/s][A
Predicting:  54%|█████▍    | 65/120 [00:15<00:12,  4.49batch/s][A
Predicting:  55%|█████▌    | 66/120 [00:15<00:13,  3.99batch/s][A
Predicting:  56%|█████▌    | 67/120 [00:15<00:14,  3.66batch/s][A
Predicting:  57%|█████▋    | 68/120 [00:15<00:11,  4.35batch/s][A
Predicting:  57%|█████▊    | 69/120 [00:16<00:12,  4.02batch/s][A
Predicting:  58%|█████▊    | 70/120 [00:16<00:10,  4.81batch/s][A
Predicting:  59%|█████▉    | 71/120 [00:16<00:10,  4.83batch/s][A
Predicting:  61%|██████    | 73/120 [00:16<00:09,  5.03batch/s][A
Predicting:  62%|██████▏   | 74/120 [00:17<00:10,  4.38batch/s][A
Predicting:  62%|██████▎   | 75/120 [00:17<00:11,  4.00batch/s][A
Predicting:  63%|██████▎   | 76/120 [00:17<00:09,  4.46batch/s][A
Predicting:  64%|██████▍   | 77/120 [00:18<00:10,  4.00batch/s][A
Predicting:  65%|██████▌   | 78/120 [00:18<00:11,  3.70batch/s][A
Predicting:  66%|██████▌   | 79/120 [00:18<00:11,  3.58batch/s][A
Predicting:  67%|██████▋   | 80/120 [00:18<00:09,  4.36batch/s][A
Predicting:  68%|██████▊   | 81/120 [00:18<00:08,  4.86batch/s][A
Predicting:  68%|██████▊   | 82/120 [00:19<00:06,  5.45batch/s][A
Predicting:  69%|██████▉   | 83/120 [00:19<00:08,  4.55batch/s][A
Predicting:  70%|███████   | 84/120 [00:19<00:09,  4.00batch/s][A
Predicting:  71%|███████   | 85/120 [00:19<00:07,  4.66batch/s][A
Predicting:  72%|███████▏  | 86/120 [00:19<00:06,  5.02batch/s][A
Predicting:  72%|███████▎  | 87/120 [00:20<00:07,  4.32batch/s][A
Predicting:  73%|███████▎  | 88/120 [00:20<00:06,  4.76batch/s][A
Predicting:  74%|███████▍  | 89/120 [00:20<00:05,  5.51batch/s][A
Predicting:  75%|███████▌  | 90/120 [00:20<00:06,  4.59batch/s][A
Predicting:  76%|███████▌  | 91/120 [00:20<00:05,  5.38batch/s][A
Predicting:  77%|███████▋  | 92/120 [00:21<00:08,  3.40batch/s][A
Predicting:  78%|███████▊  | 93/120 [00:21<00:07,  3.84batch/s][A
Predicting:  79%|███████▉  | 95/120 [00:22<00:05,  4.50batch/s][A
Predicting:  80%|████████  | 96/120 [00:22<00:06,  3.98batch/s][A
Predicting:  81%|████████  | 97/120 [00:22<00:06,  3.75batch/s][A
Predicting:  82%|████████▏ | 98/120 [00:23<00:06,  3.57batch/s][A
Predicting:  82%|████████▎ | 99/120 [00:23<00:06,  3.39batch/s][A
Predicting:  83%|████████▎ | 100/120 [00:23<00:05,  3.46batch/s][A
Predicting:  84%|████████▍ | 101/120 [00:23<00:05,  3.36batch/s][A
Predicting:  85%|████████▌ | 102/120 [00:24<00:05,  3.30batch/s][A
Predicting:  86%|████████▌ | 103/120 [00:24<00:04,  3.90batch/s][A
Predicting:  87%|████████▋ | 104/120 [00:24<00:03,  4.31batch/s][A
Predicting:  88%|████████▊ | 105/120 [00:24<00:03,  3.98batch/s][A
Predicting:  88%|████████▊ | 106/120 [00:25<00:03,  4.43batch/s][A
Predicting:  89%|████████▉ | 107/120 [00:25<00:02,  4.70batch/s][A
Predicting:  90%|█████████ | 108/120 [00:25<00:02,  4.70batch/s][A
Predicting:  91%|█████████ | 109/120 [00:25<00:02,  4.11batch/s][A
Predicting:  92%|█████████▏| 110/120 [00:26<00:02,  3.81batch/s][A
Predicting:  92%|█████████▎| 111/120 [00:26<00:02,  4.26batch/s][A
Predicting:  93%|█████████▎| 112/120 [00:26<00:01,  4.90batch/s][A
Predicting:  94%|█████████▍| 113/120 [00:26<00:01,  4.76batch/s][A
Predicting:  95%|█████████▌| 114/120 [00:26<00:01,  5.08batch/s][A
Predicting:  96%|█████████▌| 115/120 [00:26<00:00,  5.57batch/s][A
Predicting:  97%|█████████▋| 116/120 [00:27<00:00,  6.02batch/s][A
Predicting:  98%|█████████▊| 118/120 [00:27<00:00,  7.55batch/s][A
Predicting:  99%|█████████▉| 119/120 [00:27<00:00,  7.90batch/s][A
Predicting: 100%|██████████| 120/120 [00:27<00:00,  6.08batch/s][APredicting: 100%|██████████| 120/120 [00:27<00:00,  4.32batch/s]
INFO:state._cli._tx._predict:Creating anndatas from predictions from manual loop...
... storing 'target_gene' as categorical
... storing 'cell_type' as categorical
... storing 'batch_var' as categorical
... storing 'ctrl_cell_barcode' as categorical
... storing 'target_gene' as categorical
... storing 'cell_type' as categorical
... storing 'batch_var' as categorical
... storing 'ctrl_cell_barcode' as categorical
INFO:state._cli._tx._predict:Saved adata_pred to competition/sm_trainer_test/eval_temp_eval_checkpoint.ckpt/adata_pred.h5ad
INFO:state._cli._tx._predict:Saved adata_real to competition/sm_trainer_test/eval_temp_eval_checkpoint.ckpt/adata_real.h5ad
INFO:state._cli._tx._predict:Computing metrics using cell-eval...
WARNING:cell_eval._evaluator:Output directory competition/sm_trainer_test/eval_temp_eval_checkpoint.ckpt already exists, potential overwrite occurring
INFO:cell_eval._evaluator:Input is found to be log-normalized already - skipping transformation.
INFO:cell_eval._evaluator:Input is found to be log-normalized already - skipping transformation.
INFO:cell_eval._evaluator:Computing DE for real data
INFO:pdex._single_cell:Precomputing masks for each target gene

Identifying target masks:   0%|          | 0/69 [00:00<?, ?it/s][AIdentifying target masks: 100%|██████████| 69/69 [00:00<00:00, 31778.52it/s]
INFO:pdex._single_cell:Precomputing variable indices for each feature

Identifying variable indices:   0%|          | 0/18080 [00:00<?, ?it/s][AIdentifying variable indices: 100%|██████████| 18080/18080 [00:00<00:00, 5572679.04it/s]
INFO:pdex._single_cell:Creating shared memory memory matrix for parallel computing
INFO:pdex._single_cell:Creating generator of all combinations: N=1247520
INFO:pdex._single_cell:Creating generator of all batches: N=610
INFO:pdex._single_cell:Initializing parallel processing pool
INFO:pdex._single_cell:Processing batches

Processing batches:   0%|          | 0/610 [00:00<?, ?it/s][A
Processing batches:   1%|▏         | 9/610 [00:00<00:32, 18.43it/s][A
Processing batches:   2%|▏         | 11/610 [00:02<02:55,  3.41it/s][A
Processing batches:   3%|▎         | 21/610 [00:02<01:18,  7.49it/s][A
Processing batches:   4%|▍         | 23/610 [00:04<02:31,  3.86it/s][A
Processing batches:   4%|▍         | 24/610 [00:05<02:23,  4.09it/s][A
Processing batches:   4%|▍         | 25/610 [00:05<02:44,  3.55it/s][A
Processing batches:   6%|▌         | 34/610 [00:07<02:05,  4.60it/s][A
Processing batches:   6%|▌         | 37/610 [00:07<01:42,  5.61it/s][A
Processing batches:   7%|▋         | 40/610 [00:07<01:47,  5.32it/s][A
Processing batches:   7%|▋         | 42/610 [00:08<01:32,  6.13it/s][A
Processing batches:   8%|▊         | 46/610 [00:09<02:11,  4.30it/s][A
Processing batches:   8%|▊         | 48/610 [00:09<01:50,  5.08it/s][A
Processing batches:   8%|▊         | 50/610 [00:09<01:47,  5.20it/s][A
Processing batches:   9%|▊         | 52/610 [00:10<02:23,  3.89it/s][A
Processing batches:   9%|▉         | 55/610 [00:11<01:45,  5.24it/s][A
Processing batches:  10%|▉         | 58/610 [00:11<01:57,  4.68it/s][A
Processing batches:  10%|▉         | 60/610 [00:11<01:39,  5.54it/s][A
Processing batches:  10%|█         | 62/610 [00:13<02:25,  3.76it/s][A
Processing batches:  11%|█         | 68/610 [00:13<01:35,  5.66it/s][A
Processing batches:  11%|█▏        | 69/610 [00:13<01:43,  5.21it/s][A
Processing batches:  11%|█▏        | 70/610 [00:14<01:48,  4.98it/s][A
Processing batches:  12%|█▏        | 72/610 [00:14<01:32,  5.81it/s][A
Processing batches:  12%|█▏        | 73/610 [00:14<01:26,  6.21it/s][A
Processing batches:  12%|█▏        | 74/610 [00:15<02:14,  3.98it/s][A
Processing batches:  13%|█▎        | 77/610 [00:15<01:24,  6.30it/s][A
Processing batches:  13%|█▎        | 79/610 [00:15<01:19,  6.70it/s][A
Processing batches:  13%|█▎        | 80/610 [00:15<01:48,  4.87it/s][A
Processing batches:  13%|█▎        | 81/610 [00:16<02:07,  4.14it/s][A
Processing batches:  13%|█▎        | 82/610 [00:16<01:57,  4.48it/s][A
Processing batches:  14%|█▍        | 84/610 [00:16<01:38,  5.32it/s][A
Processing batches:  14%|█▍        | 86/610 [00:17<02:08,  4.07it/s][A
Processing batches:  15%|█▍        | 89/610 [00:17<01:21,  6.38it/s][A
Processing batches:  15%|█▍        | 91/610 [00:17<01:23,  6.20it/s][A
Processing batches:  15%|█▌        | 92/610 [00:18<01:41,  5.12it/s][A
Processing batches:  15%|█▌        | 93/610 [00:18<02:13,  3.88it/s][A
Processing batches:  16%|█▌        | 95/610 [00:18<01:41,  5.07it/s][A
Processing batches:  16%|█▌        | 96/610 [00:19<01:39,  5.16it/s][A
Processing batches:  16%|█▌        | 98/610 [00:20<02:24,  3.53it/s][A
Processing batches:  16%|█▌        | 99/610 [00:20<02:09,  3.96it/s][A
Processing batches:  17%|█▋        | 102/610 [00:20<01:31,  5.53it/s][A
Processing batches:  17%|█▋        | 104/610 [00:20<01:39,  5.06it/s][A
Processing batches:  17%|█▋        | 105/610 [00:21<02:08,  3.92it/s][A
Processing batches:  18%|█▊        | 108/610 [00:21<01:20,  6.23it/s][A
Processing batches:  18%|█▊        | 110/610 [00:22<01:56,  4.29it/s][A
Processing batches:  18%|█▊        | 111/610 [00:22<01:48,  4.59it/s][A
Processing batches:  19%|█▊        | 114/610 [00:22<01:27,  5.64it/s][A
Processing batches:  19%|█▉        | 116/610 [00:23<01:29,  5.49it/s][A
Processing batches:  19%|█▉        | 117/610 [00:23<01:53,  4.33it/s][A
Processing batches:  20%|█▉        | 119/610 [00:23<01:24,  5.79it/s][A
Processing batches:  20%|█▉        | 121/610 [00:24<01:16,  6.38it/s][A
Processing batches:  20%|██        | 122/610 [00:24<02:04,  3.91it/s][A
Processing batches:  20%|██        | 124/610 [00:25<02:03,  3.94it/s][A
Processing batches:  21%|██        | 128/610 [00:25<01:20,  6.02it/s][A
Processing batches:  21%|██        | 129/610 [00:26<01:42,  4.68it/s][A
Processing batches:  21%|██▏       | 131/610 [00:26<01:26,  5.55it/s][A
Processing batches:  22%|██▏       | 133/610 [00:26<01:16,  6.25it/s][A
Processing batches:  22%|██▏       | 134/610 [00:27<01:55,  4.10it/s][A
Processing batches:  22%|██▏       | 137/610 [00:27<01:45,  4.49it/s][A
Processing batches:  23%|██▎       | 140/610 [00:27<01:19,  5.90it/s][A
Processing batches:  23%|██▎       | 141/610 [00:28<01:39,  4.72it/s][A
Processing batches:  23%|██▎       | 143/610 [00:28<01:27,  5.33it/s][A
Processing batches:  24%|██▍       | 145/610 [00:28<01:16,  6.05it/s][A
Processing batches:  24%|██▍       | 146/610 [00:29<01:48,  4.27it/s][A
Processing batches:  24%|██▍       | 148/610 [00:29<01:22,  5.61it/s][A
Processing batches:  24%|██▍       | 149/610 [00:30<01:50,  4.16it/s][A
Processing batches:  25%|██▍       | 152/610 [00:30<01:20,  5.71it/s][A
Processing batches:  25%|██▌       | 153/610 [00:30<01:35,  4.78it/s][A
Processing batches:  25%|██▌       | 155/610 [00:31<01:25,  5.29it/s][A
Processing batches:  26%|██▌       | 157/610 [00:31<01:19,  5.72it/s][A
Processing batches:  26%|██▌       | 158/610 [00:31<01:46,  4.22it/s][A
Processing batches:  26%|██▌       | 160/610 [00:32<01:21,  5.52it/s][A
Processing batches:  26%|██▋       | 161/610 [00:32<01:45,  4.27it/s][A
Processing batches:  27%|██▋       | 164/610 [00:32<01:17,  5.73it/s][A
Processing batches:  27%|██▋       | 165/610 [00:33<01:33,  4.74it/s][A
Processing batches:  27%|██▋       | 166/610 [00:33<01:23,  5.30it/s][A
Processing batches:  27%|██▋       | 167/610 [00:33<01:23,  5.29it/s][A
Processing batches:  28%|██▊       | 169/610 [00:33<01:18,  5.60it/s][A
Processing batches:  28%|██▊       | 170/610 [00:34<01:47,  4.10it/s][A
Processing batches:  28%|██▊       | 171/610 [00:34<01:33,  4.70it/s][A
Processing batches:  28%|██▊       | 173/610 [00:34<01:36,  4.51it/s][A
Processing batches:  29%|██▊       | 174/610 [00:35<01:31,  4.75it/s][A
Processing batches:  29%|██▉       | 176/610 [00:35<01:14,  5.82it/s][A
Processing batches:  29%|██▉       | 177/610 [00:35<01:25,  5.07it/s][A
Processing batches:  29%|██▉       | 179/610 [00:35<01:14,  5.79it/s][A
Processing batches:  30%|██▉       | 180/610 [00:35<01:13,  5.88it/s][A
Processing batches:  30%|██▉       | 181/610 [00:36<01:11,  6.03it/s][A
Processing batches:  30%|██▉       | 182/610 [00:36<01:46,  4.03it/s][A
Processing batches:  30%|███       | 183/610 [00:36<01:33,  4.56it/s][A
Processing batches:  30%|███       | 185/610 [00:37<01:33,  4.56it/s][A
Processing batches:  30%|███       | 186/610 [00:37<01:31,  4.65it/s][A
Processing batches:  31%|███       | 188/610 [00:37<01:13,  5.73it/s][A
Processing batches:  31%|███       | 189/610 [00:38<02:15,  3.10it/s][A
Processing batches:  32%|███▏      | 193/610 [00:39<01:34,  4.41it/s][A
Processing batches:  32%|███▏      | 194/610 [00:39<01:52,  3.69it/s][A
Processing batches:  32%|███▏      | 195/610 [00:39<01:41,  4.10it/s][A
Processing batches:  32%|███▏      | 196/610 [00:39<01:29,  4.63it/s][A
Processing batches:  32%|███▏      | 197/610 [00:40<01:45,  3.90it/s][A
Processing batches:  32%|███▏      | 198/610 [00:41<03:20,  2.05it/s][A
Processing batches:  33%|███▎      | 202/610 [00:41<01:32,  4.43it/s][A
Processing batches:  34%|███▎      | 205/610 [00:41<01:07,  5.99it/s][A
Processing batches:  34%|███▍      | 207/610 [00:42<01:17,  5.22it/s][A
Processing batches:  34%|███▍      | 209/610 [00:42<01:32,  4.36it/s][A
Processing batches:  34%|███▍      | 210/610 [00:43<01:52,  3.54it/s][A
Processing batches:  35%|███▍      | 211/610 [00:43<01:46,  3.76it/s][A
Processing batches:  35%|███▍      | 213/610 [00:43<01:21,  4.88it/s][A
Processing batches:  35%|███▌      | 216/610 [00:44<00:56,  7.02it/s][A
Processing batches:  36%|███▌      | 217/610 [00:44<00:53,  7.31it/s][A
Processing batches:  36%|███▌      | 218/610 [00:44<01:10,  5.54it/s][A
Processing batches:  36%|███▌      | 219/610 [00:44<01:14,  5.26it/s][A
Processing batches:  36%|███▌      | 221/610 [00:45<01:29,  4.35it/s][A
Processing batches:  36%|███▋      | 222/610 [00:45<01:57,  3.31it/s][A
Processing batches:  37%|███▋      | 223/610 [00:46<01:49,  3.53it/s][A
Processing batches:  37%|███▋      | 225/610 [00:46<01:16,  5.00it/s][A
Processing batches:  37%|███▋      | 228/610 [00:46<00:55,  6.91it/s][A
Processing batches:  38%|███▊      | 230/610 [00:47<01:28,  4.30it/s][A
Processing batches:  38%|███▊      | 233/610 [00:47<01:09,  5.44it/s][A
Processing batches:  38%|███▊      | 234/610 [00:48<01:31,  4.10it/s][A
Processing batches:  39%|███▊      | 235/610 [00:48<01:36,  3.90it/s][A
Processing batches:  39%|███▉      | 238/610 [00:48<00:59,  6.23it/s][A
Processing batches:  39%|███▉      | 240/610 [00:48<00:56,  6.54it/s][A
Processing batches:  40%|███▉      | 242/610 [00:49<01:00,  6.08it/s][A
Processing batches:  40%|███▉      | 243/610 [00:49<01:23,  4.39it/s][A
Processing batches:  40%|████      | 245/610 [00:50<01:15,  4.83it/s][A
Processing batches:  40%|████      | 246/610 [00:50<01:34,  3.84it/s][A
Processing batches:  40%|████      | 247/610 [00:50<01:35,  3.81it/s][A
Processing batches:  41%|████      | 249/610 [00:51<01:11,  5.06it/s][A
Processing batches:  41%|████▏     | 252/610 [00:51<00:50,  7.07it/s][A
Processing batches:  42%|████▏     | 254/610 [00:51<01:05,  5.41it/s][A
Processing batches:  42%|████▏     | 255/610 [00:52<01:13,  4.86it/s][A
Processing batches:  42%|████▏     | 257/610 [00:52<01:12,  4.84it/s][A
Processing batches:  42%|████▏     | 258/610 [00:53<01:34,  3.74it/s][A
Processing batches:  42%|████▏     | 259/610 [00:53<01:32,  3.80it/s][A
Processing batches:  43%|████▎     | 261/610 [00:53<01:09,  5.01it/s][A
Processing batches:  43%|████▎     | 263/610 [00:53<00:51,  6.75it/s][A
Processing batches:  43%|████▎     | 265/610 [00:53<00:45,  7.50it/s][A
Processing batches:  44%|████▎     | 266/610 [00:54<01:08,  5.01it/s][A
Processing batches:  44%|████▍     | 267/610 [00:54<01:13,  4.65it/s][A
Processing batches:  44%|████▍     | 269/610 [00:55<01:25,  3.99it/s][A
Processing batches:  44%|████▍     | 270/610 [00:55<01:28,  3.85it/s][A
Processing batches:  44%|████▍     | 271/610 [00:55<01:33,  3.62it/s][A
Processing batches:  45%|████▍     | 274/610 [00:56<01:01,  5.45it/s][A
Processing batches:  45%|████▌     | 275/610 [00:56<00:57,  5.85it/s][A
Processing batches:  45%|████▌     | 277/610 [00:56<00:48,  6.92it/s][A
Processing batches:  46%|████▌     | 278/610 [00:56<01:01,  5.41it/s][A
Processing batches:  46%|████▌     | 279/610 [00:57<01:04,  5.15it/s][A
Processing batches:  46%|████▌     | 280/610 [00:57<00:58,  5.63it/s][A
Processing batches:  46%|████▌     | 281/610 [00:57<01:32,  3.57it/s][A
Processing batches:  46%|████▌     | 282/610 [00:57<01:24,  3.87it/s][A
Processing batches:  46%|████▋     | 283/610 [00:58<01:35,  3.44it/s][A
Processing batches:  47%|████▋     | 286/610 [00:58<01:03,  5.12it/s][A
Processing batches:  47%|████▋     | 288/610 [00:58<00:48,  6.70it/s][A
Processing batches:  47%|████▋     | 289/610 [00:59<00:52,  6.10it/s][A
Processing batches:  48%|████▊     | 290/610 [00:59<01:01,  5.21it/s][A
Processing batches:  48%|████▊     | 291/610 [00:59<00:56,  5.62it/s][A
Processing batches:  48%|████▊     | 292/610 [00:59<00:55,  5.69it/s][A
Processing batches:  48%|████▊     | 293/610 [01:00<01:35,  3.33it/s][A
Processing batches:  48%|████▊     | 295/610 [01:00<01:29,  3.54it/s][A
Processing batches:  49%|████▉     | 298/610 [01:01<01:04,  4.85it/s][A
Processing batches:  49%|████▉     | 301/610 [01:01<00:53,  5.83it/s][A
Processing batches:  50%|████▉     | 302/610 [01:01<00:58,  5.23it/s][A
Processing batches:  50%|████▉     | 304/610 [01:02<00:54,  5.63it/s][A
Processing batches:  50%|█████     | 305/610 [01:02<01:29,  3.39it/s][A
Processing batches:  50%|█████     | 307/610 [01:03<01:22,  3.65it/s][A
Processing batches:  51%|█████     | 310/610 [01:03<00:57,  5.26it/s][A
Processing batches:  51%|█████     | 311/610 [01:03<01:04,  4.66it/s][A
Processing batches:  51%|█████▏    | 313/610 [01:04<00:55,  5.33it/s][A
Processing batches:  52%|█████▏    | 315/610 [01:04<00:47,  6.19it/s][A
Processing batches:  52%|█████▏    | 316/610 [01:04<00:48,  6.09it/s][A
Processing batches:  52%|█████▏    | 317/610 [01:05<01:19,  3.67it/s][A
Processing batches:  52%|█████▏    | 318/610 [01:05<01:17,  3.79it/s][A
Processing batches:  52%|█████▏    | 319/610 [01:05<01:23,  3.48it/s][A
Processing batches:  53%|█████▎    | 322/610 [01:06<00:57,  5.04it/s][A
Processing batches:  53%|█████▎    | 323/610 [01:07<01:51,  2.57it/s][A
Processing batches:  54%|█████▍    | 329/610 [01:07<00:54,  5.19it/s][A
Processing batches:  54%|█████▍    | 330/610 [01:08<01:12,  3.88it/s][A
Processing batches:  55%|█████▍    | 334/610 [01:08<00:46,  5.89it/s][A
Processing batches:  55%|█████▍    | 335/610 [01:09<00:57,  4.79it/s][A